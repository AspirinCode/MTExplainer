Changed directory to /home/dpk25/MolecularTransformer2/scripts/toy_model/sear_small/convergence.

JobID: 27629471
======
Time: Wed 19 Aug 22:56:22 BST 2020
Running on master node: gpu-e-40
Current directory: /home/dpk25/MolecularTransformer2/scripts/toy_model/sear_small/convergence

Nodes allocated:
================
gpu-e-40

numtasks=1, numnodes=1, mpi_tasks_per_node=1 (OMP_NUM_THREADS=1)

Executing command:
==================
./train.sh 

[2020-08-19 22:56:29,499 INFO]  * src vocab size = 20
[2020-08-19 22:56:29,499 INFO]  * tgt vocab size = 20
[2020-08-19 22:56:29,499 INFO] Building model...
[2020-08-19 22:56:36,160 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=256, out_features=20, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-08-19 22:56:36,162 INFO] encoder: 5265920
[2020-08-19 22:56:36,162 INFO] decoder: 6320660
[2020-08-19 22:56:36,162 INFO] * number of parameters: 11586580
[2020-08-19 22:56:36,166 INFO] Starting training on GPU: [0]
[2020-08-19 22:56:36,166 INFO] Start training loop and validate every 10000 steps...
[2020-08-19 22:56:36,166 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 22:56:36,282 INFO] number of examples: 9920
[2020-08-19 22:56:51,423 INFO] Step 100/20000; acc:  53.04; ppl:  3.44; xent: 1.24; lr: 0.00014; 2578/2091 tok/s;     15 sec
[2020-08-19 22:57:06,166 INFO] Step 200/20000; acc:  73.27; ppl:  1.84; xent: 0.61; lr: 0.00028; 2669/2172 tok/s;     30 sec
[2020-08-19 22:57:20,817 INFO] Step 300/20000; acc:  78.26; ppl:  1.61; xent: 0.48; lr: 0.00042; 2662/2156 tok/s;     45 sec
[2020-08-19 22:57:22,593 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_312.pt
[2020-08-19 22:57:35,967 INFO] Step 400/20000; acc:  81.52; ppl:  1.51; xent: 0.41; lr: 0.00056; 2585/2098 tok/s;     60 sec
[2020-08-19 22:57:50,652 INFO] Step 500/20000; acc:  82.83; ppl:  1.46; xent: 0.38; lr: 0.00070; 2681/2178 tok/s;     74 sec
[2020-08-19 22:58:05,307 INFO] Step 600/20000; acc:  84.35; ppl:  1.41; xent: 0.34; lr: 0.00084; 2661/2165 tok/s;     89 sec
[2020-08-19 22:58:08,814 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_624.pt
[2020-08-19 22:58:20,476 INFO] Step 700/20000; acc:  85.43; ppl:  1.38; xent: 0.32; lr: 0.00098; 2589/2102 tok/s;    104 sec
[2020-08-19 22:58:35,071 INFO] Step 800/20000; acc:  85.27; ppl:  1.37; xent: 0.32; lr: 0.00112; 2710/2200 tok/s;    119 sec
[2020-08-19 22:58:49,722 INFO] Step 900/20000; acc:  85.89; ppl:  1.36; xent: 0.31; lr: 0.00126; 2684/2174 tok/s;    134 sec
[2020-08-19 22:58:55,018 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_936.pt
[2020-08-19 22:59:05,439 INFO] Step 1000/20000; acc:  85.75; ppl:  1.37; xent: 0.31; lr: 0.00140; 2513/2039 tok/s;    149 sec
[2020-08-19 22:59:05,584 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 22:59:05,670 INFO] number of examples: 9920
[2020-08-19 22:59:20,153 INFO] Step 1100/20000; acc:  86.34; ppl:  1.34; xent: 0.29; lr: 0.00154; 2675/2170 tok/s;    164 sec
[2020-08-19 22:59:34,859 INFO] Step 1200/20000; acc:  86.14; ppl:  1.35; xent: 0.30; lr: 0.00168; 2676/2176 tok/s;    179 sec
[2020-08-19 22:59:41,932 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_1248.pt
[2020-08-19 22:59:49,785 INFO] Step 1300/20000; acc:  85.92; ppl:  1.36; xent: 0.30; lr: 0.00182; 2615/2119 tok/s;    194 sec
[2020-08-19 23:00:04,424 INFO] Step 1400/20000; acc:  85.58; ppl:  1.36; xent: 0.31; lr: 0.00196; 2673/2170 tok/s;    208 sec
[2020-08-19 23:00:19,139 INFO] Step 1500/20000; acc:  85.96; ppl:  1.36; xent: 0.30; lr: 0.00210; 2676/2174 tok/s;    223 sec
[2020-08-19 23:00:27,954 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_1560.pt
[2020-08-19 23:00:34,036 INFO] Step 1600/20000; acc:  85.32; ppl:  1.37; xent: 0.32; lr: 0.00224; 2616/2129 tok/s;    238 sec
[2020-08-19 23:00:48,571 INFO] Step 1700/20000; acc:  85.54; ppl:  1.36; xent: 0.31; lr: 0.00238; 2706/2197 tok/s;    252 sec
[2020-08-19 23:01:03,237 INFO] Step 1800/20000; acc:  84.07; ppl:  1.41; xent: 0.35; lr: 0.00252; 2692/2185 tok/s;    267 sec
[2020-08-19 23:01:13,810 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_1872.pt
[2020-08-19 23:01:18,908 INFO] Step 1900/20000; acc:  84.21; ppl:  1.41; xent: 0.34; lr: 0.00266; 2511/2035 tok/s;    283 sec
[2020-08-19 23:01:33,544 INFO] Step 2000/20000; acc:  83.15; ppl:  1.44; xent: 0.37; lr: 0.00279; 2699/2189 tok/s;    297 sec
[2020-08-19 23:01:33,840 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:01:33,880 INFO] number of examples: 9920
[2020-08-19 23:01:48,256 INFO] Step 2100/20000; acc:  82.79; ppl:  1.45; xent: 0.37; lr: 0.00273; 2672/2168 tok/s;    312 sec
[2020-08-19 23:02:00,451 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_2184.pt
[2020-08-19 23:02:03,122 INFO] Step 2200/20000; acc:  83.90; ppl:  1.42; xent: 0.35; lr: 0.00266; 2649/2155 tok/s;    327 sec
[2020-08-19 23:02:17,583 INFO] Step 2300/20000; acc:  83.90; ppl:  1.41; xent: 0.34; lr: 0.00261; 2698/2186 tok/s;    341 sec
[2020-08-19 23:02:32,072 INFO] Step 2400/20000; acc:  84.23; ppl:  1.40; xent: 0.34; lr: 0.00255; 2700/2191 tok/s;    356 sec
[2020-08-19 23:02:46,014 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_2496.pt
[2020-08-19 23:02:46,923 INFO] Step 2500/20000; acc:  84.34; ppl:  1.39; xent: 0.33; lr: 0.00250; 2649/2153 tok/s;    371 sec
[2020-08-19 23:03:01,441 INFO] Step 2600/20000; acc:  84.44; ppl:  1.39; xent: 0.33; lr: 0.00245; 2686/2186 tok/s;    385 sec
[2020-08-19 23:03:15,969 INFO] Step 2700/20000; acc:  85.19; ppl:  1.36; xent: 0.31; lr: 0.00241; 2709/2199 tok/s;    400 sec
[2020-08-19 23:03:30,464 INFO] Step 2800/20000; acc:  85.88; ppl:  1.35; xent: 0.30; lr: 0.00236; 2720/2208 tok/s;    414 sec
[2020-08-19 23:03:31,600 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_2808.pt
[2020-08-19 23:03:45,189 INFO] Step 2900/20000; acc:  85.09; ppl:  1.38; xent: 0.32; lr: 0.00232; 2677/2170 tok/s;    429 sec
[2020-08-19 23:03:59,664 INFO] Step 3000/20000; acc:  85.20; ppl:  1.36; xent: 0.31; lr: 0.00228; 2732/2216 tok/s;    443 sec
[2020-08-19 23:04:00,106 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:04:00,146 INFO] number of examples: 9920
[2020-08-19 23:04:14,344 INFO] Step 3100/20000; acc:  85.73; ppl:  1.35; xent: 0.30; lr: 0.00224; 2676/2172 tok/s;    458 sec
[2020-08-19 23:04:17,271 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_3120.pt
[2020-08-19 23:04:29,163 INFO] Step 3200/20000; acc:  85.21; ppl:  1.38; xent: 0.32; lr: 0.00221; 2657/2161 tok/s;    473 sec
[2020-08-19 23:04:43,669 INFO] Step 3300/20000; acc:  84.81; ppl:  1.38; xent: 0.32; lr: 0.00218; 2690/2179 tok/s;    488 sec
[2020-08-19 23:04:58,171 INFO] Step 3400/20000; acc:  86.26; ppl:  1.33; xent: 0.29; lr: 0.00214; 2694/2186 tok/s;    502 sec
[2020-08-19 23:05:02,852 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_3432.pt
[2020-08-19 23:05:13,011 INFO] Step 3500/20000; acc:  87.03; ppl:  1.31; xent: 0.27; lr: 0.00211; 2650/2154 tok/s;    517 sec
[2020-08-19 23:05:27,508 INFO] Step 3600/20000; acc:  86.42; ppl:  1.33; xent: 0.29; lr: 0.00208; 2697/2196 tok/s;    531 sec
[2020-08-19 23:05:42,010 INFO] Step 3700/20000; acc:  85.74; ppl:  1.34; xent: 0.29; lr: 0.00205; 2713/2202 tok/s;    546 sec
[2020-08-19 23:05:48,433 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_3744.pt
[2020-08-19 23:05:56,873 INFO] Step 3800/20000; acc:  86.51; ppl:  1.32; xent: 0.28; lr: 0.00203; 2650/2151 tok/s;    561 sec
[2020-08-19 23:06:11,329 INFO] Step 3900/20000; acc:  85.95; ppl:  1.34; xent: 0.29; lr: 0.00200; 2728/2211 tok/s;    575 sec
[2020-08-19 23:06:25,793 INFO] Step 4000/20000; acc:  86.60; ppl:  1.31; xent: 0.27; lr: 0.00198; 2738/2221 tok/s;    590 sec
[2020-08-19 23:06:26,374 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:06:26,415 INFO] number of examples: 9920
[2020-08-19 23:06:33,993 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_4056.pt
[2020-08-19 23:06:40,813 INFO] Step 4100/20000; acc:  87.00; ppl:  1.31; xent: 0.27; lr: 0.00195; 2613/2121 tok/s;    605 sec
[2020-08-19 23:06:55,299 INFO] Step 4200/20000; acc:  86.24; ppl:  1.33; xent: 0.29; lr: 0.00193; 2719/2211 tok/s;    619 sec
[2020-08-19 23:07:09,835 INFO] Step 4300/20000; acc:  85.38; ppl:  1.37; xent: 0.31; lr: 0.00191; 2687/2177 tok/s;    634 sec
[2020-08-19 23:07:19,664 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_4368.pt
[2020-08-19 23:07:24,684 INFO] Step 4400/20000; acc:  86.91; ppl:  1.31; xent: 0.27; lr: 0.00188; 2632/2133 tok/s;    649 sec
[2020-08-19 23:07:39,166 INFO] Step 4500/20000; acc:  86.25; ppl:  1.32; xent: 0.28; lr: 0.00186; 2716/2208 tok/s;    663 sec
[2020-08-19 23:07:54,252 INFO] Step 4600/20000; acc:  86.82; ppl:  1.31; xent: 0.27; lr: 0.00184; 2710/2208 tok/s;    678 sec
[2020-08-19 23:08:05,828 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_4680.pt
[2020-08-19 23:08:09,050 INFO] Step 4700/20000; acc:  87.06; ppl:  1.30; xent: 0.26; lr: 0.00182; 2657/2155 tok/s;    693 sec
[2020-08-19 23:08:23,519 INFO] Step 4800/20000; acc:  87.45; ppl:  1.29; xent: 0.26; lr: 0.00180; 2719/2208 tok/s;    707 sec
[2020-08-19 23:08:38,029 INFO] Step 4900/20000; acc:  87.38; ppl:  1.29; xent: 0.26; lr: 0.00179; 2721/2205 tok/s;    722 sec
[2020-08-19 23:08:51,327 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_4992.pt
[2020-08-19 23:08:52,781 INFO] Step 5000/20000; acc:  87.76; ppl:  1.29; xent: 0.25; lr: 0.00177; 2684/2177 tok/s;    737 sec
[2020-08-19 23:08:53,508 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:08:53,549 INFO] number of examples: 9920
[2020-08-19 23:09:07,345 INFO] Step 5100/20000; acc:  87.53; ppl:  1.29; xent: 0.26; lr: 0.00175; 2692/2184 tok/s;    751 sec
[2020-08-19 23:09:21,896 INFO] Step 5200/20000; acc:  87.68; ppl:  1.29; xent: 0.26; lr: 0.00173; 2713/2205 tok/s;    766 sec
[2020-08-19 23:09:36,342 INFO] Step 5300/20000; acc:  86.45; ppl:  1.33; xent: 0.29; lr: 0.00172; 2698/2188 tok/s;    780 sec
[2020-08-19 23:09:36,919 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_5304.pt
[2020-08-19 23:09:51,222 INFO] Step 5400/20000; acc:  86.69; ppl:  1.32; xent: 0.28; lr: 0.00170; 2627/2129 tok/s;    795 sec
[2020-08-19 23:10:05,732 INFO] Step 5500/20000; acc:  86.54; ppl:  1.33; xent: 0.28; lr: 0.00169; 2709/2201 tok/s;    810 sec
[2020-08-19 23:10:20,252 INFO] Step 5600/20000; acc:  86.93; ppl:  1.31; xent: 0.27; lr: 0.00167; 2694/2195 tok/s;    824 sec
[2020-08-19 23:10:22,568 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_5616.pt
[2020-08-19 23:10:35,027 INFO] Step 5700/20000; acc:  86.83; ppl:  1.31; xent: 0.27; lr: 0.00166; 2661/2158 tok/s;    839 sec
[2020-08-19 23:10:49,489 INFO] Step 5800/20000; acc:  86.99; ppl:  1.30; xent: 0.27; lr: 0.00164; 2720/2208 tok/s;    853 sec
[2020-08-19 23:11:03,947 INFO] Step 5900/20000; acc:  87.73; ppl:  1.28; xent: 0.25; lr: 0.00163; 2732/2216 tok/s;    868 sec
[2020-08-19 23:11:08,077 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_5928.pt
[2020-08-19 23:11:19,008 INFO] Step 6000/20000; acc:  87.88; ppl:  1.29; xent: 0.25; lr: 0.00161; 2650/2151 tok/s;    883 sec
[2020-08-19 23:11:19,876 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:11:19,949 INFO] number of examples: 9920
[2020-08-19 23:11:33,590 INFO] Step 6100/20000; acc:  87.89; ppl:  1.28; xent: 0.25; lr: 0.00160; 2687/2179 tok/s;    897 sec
[2020-08-19 23:11:48,059 INFO] Step 6200/20000; acc:  87.66; ppl:  1.29; xent: 0.25; lr: 0.00159; 2726/2216 tok/s;    912 sec
[2020-08-19 23:11:53,850 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_6240.pt
[2020-08-19 23:12:03,647 INFO] Step 6300/20000; acc:  87.71; ppl:  1.29; xent: 0.26; lr: 0.00157; 2499/2028 tok/s;    927 sec
[2020-08-19 23:12:18,138 INFO] Step 6400/20000; acc:  88.21; ppl:  1.27; xent: 0.24; lr: 0.00156; 2696/2184 tok/s;    942 sec
[2020-08-19 23:12:32,641 INFO] Step 6500/20000; acc:  88.14; ppl:  1.27; xent: 0.24; lr: 0.00155; 2714/2204 tok/s;    956 sec
[2020-08-19 23:12:40,145 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_6552.pt
[2020-08-19 23:12:47,532 INFO] Step 6600/20000; acc:  88.48; ppl:  1.26; xent: 0.23; lr: 0.00154; 2623/2138 tok/s;    971 sec
[2020-08-19 23:13:01,957 INFO] Step 6700/20000; acc:  87.69; ppl:  1.29; xent: 0.25; lr: 0.00153; 2724/2209 tok/s;    986 sec
[2020-08-19 23:13:16,352 INFO] Step 6800/20000; acc:  86.96; ppl:  1.31; xent: 0.27; lr: 0.00152; 2733/2218 tok/s;   1000 sec
[2020-08-19 23:13:25,508 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_6864.pt
[2020-08-19 23:13:31,074 INFO] Step 6900/20000; acc:  87.86; ppl:  1.28; xent: 0.25; lr: 0.00150; 2682/2176 tok/s;   1015 sec
[2020-08-19 23:13:45,408 INFO] Step 7000/20000; acc:  87.20; ppl:  1.31; xent: 0.27; lr: 0.00149; 2771/2250 tok/s;   1029 sec
[2020-08-19 23:13:46,406 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:13:46,481 INFO] number of examples: 9920
[2020-08-19 23:13:59,885 INFO] Step 7100/20000; acc:  88.04; ppl:  1.28; xent: 0.24; lr: 0.00148; 2700/2190 tok/s;   1044 sec
[2020-08-19 23:14:11,030 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_7176.pt
[2020-08-19 23:14:14,982 INFO] Step 7200/20000; acc:  87.74; ppl:  1.28; xent: 0.25; lr: 0.00147; 2618/2126 tok/s;   1059 sec
[2020-08-19 23:14:29,628 INFO] Step 7300/20000; acc:  88.34; ppl:  1.27; xent: 0.24; lr: 0.00146; 2660/2159 tok/s;   1073 sec
[2020-08-19 23:14:44,267 INFO] Step 7400/20000; acc:  86.84; ppl:  1.31; xent: 0.27; lr: 0.00145; 2669/2163 tok/s;   1088 sec
[2020-08-19 23:14:57,221 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_7488.pt
[2020-08-19 23:15:03,002 INFO] Step 7500/20000; acc:  86.21; ppl:  1.32; xent: 0.28; lr: 0.00144; 2101/1706 tok/s;   1107 sec
[2020-08-19 23:15:17,695 INFO] Step 7600/20000; acc:  86.90; ppl:  1.31; xent: 0.27; lr: 0.00143; 2661/2168 tok/s;   1122 sec
[2020-08-19 23:15:32,379 INFO] Step 7700/20000; acc:  87.03; ppl:  1.31; xent: 0.27; lr: 0.00142; 2672/2167 tok/s;   1136 sec
[2020-08-19 23:15:47,074 INFO] Step 7800/20000; acc:  87.63; ppl:  1.29; xent: 0.25; lr: 0.00142; 2677/2173 tok/s;   1151 sec
[2020-08-19 23:15:47,076 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_7800.pt
[2020-08-19 23:16:01,985 INFO] Step 7900/20000; acc:  87.57; ppl:  1.29; xent: 0.25; lr: 0.00141; 2648/2148 tok/s;   1166 sec
[2020-08-19 23:16:16,647 INFO] Step 8000/20000; acc:  88.31; ppl:  1.27; xent: 0.24; lr: 0.00140; 2709/2199 tok/s;   1180 sec
[2020-08-19 23:16:17,821 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:16:17,906 INFO] number of examples: 9920
[2020-08-19 23:16:31,419 INFO] Step 8100/20000; acc:  88.32; ppl:  1.26; xent: 0.23; lr: 0.00139; 2648/2147 tok/s;   1195 sec
[2020-08-19 23:16:33,169 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_8112.pt
[2020-08-19 23:16:46,346 INFO] Step 8200/20000; acc:  88.58; ppl:  1.26; xent: 0.23; lr: 0.00138; 2645/2147 tok/s;   1210 sec
[2020-08-19 23:17:01,054 INFO] Step 8300/20000; acc:  89.11; ppl:  1.25; xent: 0.22; lr: 0.00137; 2650/2154 tok/s;   1225 sec
[2020-08-19 23:17:15,731 INFO] Step 8400/20000; acc:  88.65; ppl:  1.25; xent: 0.23; lr: 0.00136; 2660/2155 tok/s;   1240 sec
[2020-08-19 23:17:19,260 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_8424.pt
[2020-08-19 23:17:30,777 INFO] Step 8500/20000; acc:  88.20; ppl:  1.27; xent: 0.24; lr: 0.00136; 2621/2128 tok/s;   1255 sec
[2020-08-19 23:17:45,416 INFO] Step 8600/20000; acc:  88.03; ppl:  1.27; xent: 0.24; lr: 0.00135; 2670/2175 tok/s;   1269 sec
[2020-08-19 23:18:00,102 INFO] Step 8700/20000; acc:  88.82; ppl:  1.25; xent: 0.22; lr: 0.00134; 2667/2164 tok/s;   1284 sec
[2020-08-19 23:18:05,372 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_8736.pt
[2020-08-19 23:18:15,060 INFO] Step 8800/20000; acc:  88.38; ppl:  1.26; xent: 0.23; lr: 0.00133; 2634/2137 tok/s;   1299 sec
[2020-08-19 23:18:29,689 INFO] Step 8900/20000; acc:  88.14; ppl:  1.27; xent: 0.24; lr: 0.00132; 2698/2189 tok/s;   1314 sec
[2020-08-19 23:18:44,356 INFO] Step 9000/20000; acc:  88.80; ppl:  1.25; xent: 0.23; lr: 0.00132; 2712/2202 tok/s;   1328 sec
[2020-08-19 23:18:45,675 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:18:45,757 INFO] number of examples: 9920
[2020-08-19 23:18:51,551 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_9048.pt
[2020-08-19 23:18:59,465 INFO] Step 9100/20000; acc:  88.44; ppl:  1.26; xent: 0.23; lr: 0.00131; 2588/2099 tok/s;   1343 sec
[2020-08-19 23:19:14,126 INFO] Step 9200/20000; acc:  88.92; ppl:  1.25; xent: 0.22; lr: 0.00130; 2692/2184 tok/s;   1358 sec
[2020-08-19 23:19:28,791 INFO] Step 9300/20000; acc:  89.16; ppl:  1.24; xent: 0.21; lr: 0.00130; 2659/2161 tok/s;   1373 sec
[2020-08-19 23:19:37,604 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_9360.pt
[2020-08-19 23:19:43,775 INFO] Step 9400/20000; acc:  88.70; ppl:  1.25; xent: 0.23; lr: 0.00129; 2609/2115 tok/s;   1388 sec
[2020-08-19 23:19:58,473 INFO] Step 9500/20000; acc:  88.46; ppl:  1.26; xent: 0.23; lr: 0.00128; 2678/2174 tok/s;   1402 sec
[2020-08-19 23:20:13,181 INFO] Step 9600/20000; acc:  89.22; ppl:  1.24; xent: 0.22; lr: 0.00128; 2659/2165 tok/s;   1417 sec
[2020-08-19 23:20:23,752 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_9672.pt
[2020-08-19 23:20:28,234 INFO] Step 9700/20000; acc:  89.33; ppl:  1.23; xent: 0.21; lr: 0.00127; 2599/2109 tok/s;   1432 sec
[2020-08-19 23:20:42,865 INFO] Step 9800/20000; acc:  88.82; ppl:  1.25; xent: 0.23; lr: 0.00126; 2694/2186 tok/s;   1447 sec
[2020-08-19 23:20:57,499 INFO] Step 9900/20000; acc:  88.65; ppl:  1.25; xent: 0.22; lr: 0.00126; 2700/2191 tok/s;   1461 sec
[2020-08-19 23:21:09,807 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_9984.pt
[2020-08-19 23:21:12,550 INFO] Step 10000/20000; acc:  88.24; ppl:  1.28; xent: 0.24; lr: 0.00125; 2638/2143 tok/s;   1476 sec
[2020-08-19 23:21:12,551 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-19 23:21:12,591 INFO] number of examples: 620
[2020-08-19 23:21:13,622 INFO] Validation perplexity: 1.33293
[2020-08-19 23:21:13,622 INFO] Validation accuracy: 89.3343
[2020-08-19 23:21:15,092 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:21:15,174 INFO] number of examples: 9920
[2020-08-19 23:21:28,454 INFO] Step 10100/20000; acc:  88.40; ppl:  1.26; xent: 0.23; lr: 0.00124; 2459/1993 tok/s;   1492 sec
[2020-08-19 23:21:43,115 INFO] Step 10200/20000; acc:  88.93; ppl:  1.25; xent: 0.22; lr: 0.00124; 2691/2183 tok/s;   1507 sec
[2020-08-19 23:21:57,199 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_10296.pt
[2020-08-19 23:21:58,156 INFO] Step 10300/20000; acc:  89.40; ppl:  1.23; xent: 0.21; lr: 0.00123; 2591/2108 tok/s;   1522 sec
[2020-08-19 23:22:12,793 INFO] Step 10400/20000; acc:  89.20; ppl:  1.24; xent: 0.21; lr: 0.00123; 2672/2164 tok/s;   1537 sec
[2020-08-19 23:22:27,466 INFO] Step 10500/20000; acc:  89.20; ppl:  1.23; xent: 0.21; lr: 0.00122; 2682/2178 tok/s;   1551 sec
[2020-08-19 23:22:42,241 INFO] Step 10600/20000; acc:  89.29; ppl:  1.24; xent: 0.22; lr: 0.00121; 2647/2155 tok/s;   1566 sec
[2020-08-19 23:22:43,434 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_10608.pt
[2020-08-19 23:22:57,360 INFO] Step 10700/20000; acc:  89.25; ppl:  1.23; xent: 0.21; lr: 0.00121; 2591/2103 tok/s;   1581 sec
[2020-08-19 23:23:12,059 INFO] Step 10800/20000; acc:  89.20; ppl:  1.24; xent: 0.22; lr: 0.00120; 2683/2175 tok/s;   1596 sec
[2020-08-19 23:23:26,717 INFO] Step 10900/20000; acc:  89.39; ppl:  1.23; xent: 0.21; lr: 0.00120; 2692/2186 tok/s;   1611 sec
[2020-08-19 23:23:29,666 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_10920.pt
[2020-08-19 23:23:41,667 INFO] Step 11000/20000; acc:  89.59; ppl:  1.23; xent: 0.21; lr: 0.00119; 2654/2156 tok/s;   1626 sec
[2020-08-19 23:23:43,278 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:23:43,361 INFO] number of examples: 9920
[2020-08-19 23:23:56,520 INFO] Step 11100/20000; acc:  89.31; ppl:  1.24; xent: 0.21; lr: 0.00119; 2637/2137 tok/s;   1640 sec
[2020-08-19 23:24:11,114 INFO] Step 11200/20000; acc:  88.85; ppl:  1.25; xent: 0.23; lr: 0.00118; 2703/2193 tok/s;   1655 sec
[2020-08-19 23:24:15,818 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_11232.pt
[2020-08-19 23:24:26,151 INFO] Step 11300/20000; acc:  89.85; ppl:  1.22; xent: 0.20; lr: 0.00118; 2589/2105 tok/s;   1670 sec
[2020-08-19 23:24:40,856 INFO] Step 11400/20000; acc:  89.54; ppl:  1.23; xent: 0.20; lr: 0.00117; 2661/2156 tok/s;   1685 sec
[2020-08-19 23:24:55,505 INFO] Step 11500/20000; acc:  89.48; ppl:  1.23; xent: 0.21; lr: 0.00117; 2688/2184 tok/s;   1699 sec
[2020-08-19 23:25:01,940 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_11544.pt
[2020-08-19 23:25:10,500 INFO] Step 11600/20000; acc:  89.70; ppl:  1.23; xent: 0.21; lr: 0.00116; 2602/2117 tok/s;   1714 sec
[2020-08-19 23:25:25,156 INFO] Step 11700/20000; acc:  89.48; ppl:  1.23; xent: 0.21; lr: 0.00116; 2677/2173 tok/s;   1729 sec
[2020-08-19 23:25:39,886 INFO] Step 11800/20000; acc:  89.72; ppl:  1.23; xent: 0.20; lr: 0.00115; 2675/2168 tok/s;   1744 sec
[2020-08-19 23:25:48,079 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_11856.pt
[2020-08-19 23:25:54,955 INFO] Step 11900/20000; acc:  89.51; ppl:  1.23; xent: 0.21; lr: 0.00115; 2619/2127 tok/s;   1759 sec
[2020-08-19 23:26:09,647 INFO] Step 12000/20000; acc:  89.43; ppl:  1.24; xent: 0.21; lr: 0.00114; 2701/2194 tok/s;   1773 sec
[2020-08-19 23:26:11,395 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:26:11,481 INFO] number of examples: 9920
[2020-08-19 23:26:24,500 INFO] Step 12100/20000; acc:  89.13; ppl:  1.24; xent: 0.22; lr: 0.00114; 2638/2138 tok/s;   1788 sec
[2020-08-19 23:26:34,427 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_12168.pt
[2020-08-19 23:26:39,395 INFO] Step 12200/20000; acc:  89.47; ppl:  1.24; xent: 0.21; lr: 0.00113; 2648/2149 tok/s;   1803 sec
[2020-08-19 23:26:54,077 INFO] Step 12300/20000; acc:  89.86; ppl:  1.23; xent: 0.20; lr: 0.00113; 2650/2154 tok/s;   1818 sec
[2020-08-19 23:27:08,489 INFO] Step 12400/20000; acc:  89.69; ppl:  1.22; xent: 0.20; lr: 0.00112; 2718/2202 tok/s;   1832 sec
[2020-08-19 23:27:20,201 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_12480.pt
[2020-08-19 23:27:23,534 INFO] Step 12500/20000; acc:  89.64; ppl:  1.23; xent: 0.20; lr: 0.00112; 2615/2125 tok/s;   1847 sec
[2020-08-19 23:27:38,187 INFO] Step 12600/20000; acc:  89.92; ppl:  1.22; xent: 0.20; lr: 0.00111; 2665/2168 tok/s;   1862 sec
[2020-08-19 23:27:52,831 INFO] Step 12700/20000; acc:  89.90; ppl:  1.22; xent: 0.20; lr: 0.00111; 2680/2176 tok/s;   1877 sec
[2020-08-19 23:28:06,341 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_12792.pt
[2020-08-19 23:28:07,833 INFO] Step 12800/20000; acc:  89.74; ppl:  1.22; xent: 0.20; lr: 0.00110; 2626/2128 tok/s;   1892 sec
[2020-08-19 23:28:22,497 INFO] Step 12900/20000; acc:  89.96; ppl:  1.21; xent: 0.19; lr: 0.00110; 2689/2183 tok/s;   1906 sec
[2020-08-19 23:28:37,170 INFO] Step 13000/20000; acc:  90.23; ppl:  1.22; xent: 0.20; lr: 0.00110; 2707/2200 tok/s;   1921 sec
[2020-08-19 23:28:39,068 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:28:39,154 INFO] number of examples: 9920
[2020-08-19 23:28:52,015 INFO] Step 13100/20000; acc:  89.89; ppl:  1.22; xent: 0.20; lr: 0.00109; 2640/2140 tok/s;   1936 sec
[2020-08-19 23:28:52,607 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_13104.pt
[2020-08-19 23:29:07,032 INFO] Step 13200/20000; acc:  89.85; ppl:  1.22; xent: 0.20; lr: 0.00109; 2625/2130 tok/s;   1951 sec
[2020-08-19 23:29:21,693 INFO] Step 13300/20000; acc:  90.05; ppl:  1.22; xent: 0.19; lr: 0.00108; 2655/2157 tok/s;   1966 sec
[2020-08-19 23:29:36,371 INFO] Step 13400/20000; acc:  89.69; ppl:  1.23; xent: 0.20; lr: 0.00108; 2669/2163 tok/s;   1980 sec
[2020-08-19 23:29:38,722 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_13416.pt
[2020-08-19 23:29:51,382 INFO] Step 13500/20000; acc:  89.36; ppl:  1.24; xent: 0.21; lr: 0.00108; 2620/2129 tok/s;   1995 sec
[2020-08-19 23:30:06,075 INFO] Step 13600/20000; acc:  89.71; ppl:  1.22; xent: 0.20; lr: 0.00107; 2653/2158 tok/s;   2010 sec
[2020-08-19 23:30:20,775 INFO] Step 13700/20000; acc:  90.09; ppl:  1.22; xent: 0.20; lr: 0.00107; 2675/2173 tok/s;   2025 sec
[2020-08-19 23:30:24,853 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_13728.pt
[2020-08-19 23:30:35,742 INFO] Step 13800/20000; acc:  89.61; ppl:  1.23; xent: 0.21; lr: 0.00106; 2629/2131 tok/s;   2040 sec
[2020-08-19 23:30:50,382 INFO] Step 13900/20000; acc:  89.70; ppl:  1.23; xent: 0.21; lr: 0.00106; 2696/2188 tok/s;   2054 sec
[2020-08-19 23:31:05,050 INFO] Step 14000/20000; acc:  89.91; ppl:  1.23; xent: 0.21; lr: 0.00106; 2707/2200 tok/s;   2069 sec
[2020-08-19 23:31:07,112 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:31:07,199 INFO] number of examples: 9920
[2020-08-19 23:31:11,109 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_14040.pt
[2020-08-19 23:31:20,181 INFO] Step 14100/20000; acc:  89.84; ppl:  1.22; xent: 0.20; lr: 0.00105; 2588/2099 tok/s;   2084 sec
[2020-08-19 23:31:34,866 INFO] Step 14200/20000; acc:  90.08; ppl:  1.22; xent: 0.20; lr: 0.00105; 2684/2177 tok/s;   2099 sec
[2020-08-19 23:31:49,602 INFO] Step 14300/20000; acc:  90.23; ppl:  1.22; xent: 0.20; lr: 0.00105; 2657/2159 tok/s;   2113 sec
[2020-08-19 23:31:57,241 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_14352.pt
[2020-08-19 23:32:04,690 INFO] Step 14400/20000; acc:  89.81; ppl:  1.22; xent: 0.20; lr: 0.00104; 2597/2105 tok/s;   2129 sec
[2020-08-19 23:32:19,401 INFO] Step 14500/20000; acc:  89.74; ppl:  1.22; xent: 0.20; lr: 0.00104; 2674/2173 tok/s;   2143 sec
[2020-08-19 23:32:34,091 INFO] Step 14600/20000; acc:  90.09; ppl:  1.22; xent: 0.20; lr: 0.00103; 2651/2155 tok/s;   2158 sec
[2020-08-19 23:32:43,464 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_14664.pt
[2020-08-19 23:32:49,113 INFO] Step 14700/20000; acc:  90.20; ppl:  1.21; xent: 0.19; lr: 0.00103; 2623/2130 tok/s;   2173 sec
[2020-08-19 23:33:03,741 INFO] Step 14800/20000; acc:  90.13; ppl:  1.22; xent: 0.20; lr: 0.00103; 2686/2178 tok/s;   2188 sec
[2020-08-19 23:33:18,399 INFO] Step 14900/20000; acc:  90.11; ppl:  1.21; xent: 0.19; lr: 0.00102; 2694/2187 tok/s;   2202 sec
[2020-08-19 23:33:29,563 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_14976.pt
[2020-08-19 23:33:33,539 INFO] Step 15000/20000; acc:  90.17; ppl:  1.21; xent: 0.19; lr: 0.00102; 2622/2131 tok/s;   2217 sec
[2020-08-19 23:33:35,738 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:33:35,825 INFO] number of examples: 9920
[2020-08-19 23:33:48,369 INFO] Step 15100/20000; acc:  90.03; ppl:  1.22; xent: 0.20; lr: 0.00102; 2639/2140 tok/s;   2232 sec
[2020-08-19 23:34:03,039 INFO] Step 15200/20000; acc:  90.26; ppl:  1.21; xent: 0.19; lr: 0.00101; 2688/2180 tok/s;   2247 sec
[2020-08-19 23:34:15,944 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_15288.pt
[2020-08-19 23:34:18,027 INFO] Step 15300/20000; acc:  90.41; ppl:  1.21; xent: 0.19; lr: 0.00101; 2598/2112 tok/s;   2262 sec
[2020-08-19 23:34:32,687 INFO] Step 15400/20000; acc:  90.34; ppl:  1.21; xent: 0.19; lr: 0.00101; 2674/2167 tok/s;   2277 sec
[2020-08-19 23:34:47,397 INFO] Step 15500/20000; acc:  90.25; ppl:  1.21; xent: 0.19; lr: 0.00100; 2675/2173 tok/s;   2291 sec
[2020-08-19 23:35:02,051 INFO] Step 15600/20000; acc:  90.32; ppl:  1.21; xent: 0.19; lr: 0.00100; 2657/2160 tok/s;   2306 sec
[2020-08-19 23:35:02,053 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_15600.pt
[2020-08-19 23:35:17,010 INFO] Step 15700/20000; acc:  90.04; ppl:  1.22; xent: 0.20; lr: 0.00100; 2635/2140 tok/s;   2321 sec
[2020-08-19 23:35:31,654 INFO] Step 15800/20000; acc:  90.18; ppl:  1.21; xent: 0.19; lr: 0.00099; 2685/2178 tok/s;   2335 sec
[2020-08-19 23:35:46,301 INFO] Step 15900/20000; acc:  90.41; ppl:  1.20; xent: 0.19; lr: 0.00099; 2692/2183 tok/s;   2350 sec
[2020-08-19 23:35:48,064 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_15912.pt
[2020-08-19 23:36:01,387 INFO] Step 16000/20000; acc:  90.28; ppl:  1.21; xent: 0.19; lr: 0.00099; 2634/2142 tok/s;   2365 sec
[2020-08-19 23:36:03,749 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:36:03,837 INFO] number of examples: 9920
[2020-08-19 23:36:16,624 INFO] Step 16100/20000; acc:  90.24; ppl:  1.21; xent: 0.19; lr: 0.00099; 2569/2083 tok/s;   2380 sec
[2020-08-19 23:36:31,665 INFO] Step 16200/20000; acc:  90.34; ppl:  1.21; xent: 0.19; lr: 0.00098; 2681/2173 tok/s;   2395 sec
[2020-08-19 23:36:35,207 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_16224.pt
[2020-08-19 23:36:46,659 INFO] Step 16300/20000; acc:  90.41; ppl:  1.21; xent: 0.19; lr: 0.00098; 2597/2112 tok/s;   2410 sec
[2020-08-19 23:37:01,362 INFO] Step 16400/20000; acc:  90.31; ppl:  1.21; xent: 0.19; lr: 0.00098; 2667/2160 tok/s;   2425 sec
[2020-08-19 23:37:16,074 INFO] Step 16500/20000; acc:  90.00; ppl:  1.22; xent: 0.20; lr: 0.00097; 2673/2172 tok/s;   2440 sec
[2020-08-19 23:37:21,367 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_16536.pt
[2020-08-19 23:37:31,074 INFO] Step 16600/20000; acc:  90.03; ppl:  1.22; xent: 0.20; lr: 0.00097; 2601/2114 tok/s;   2455 sec
[2020-08-19 23:37:45,828 INFO] Step 16700/20000; acc:  90.40; ppl:  1.21; xent: 0.19; lr: 0.00097; 2670/2167 tok/s;   2470 sec
[2020-08-19 23:38:00,530 INFO] Step 16800/20000; acc:  90.42; ppl:  1.21; xent: 0.19; lr: 0.00096; 2675/2171 tok/s;   2484 sec
[2020-08-19 23:38:07,555 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_16848.pt
[2020-08-19 23:38:15,485 INFO] Step 16900/20000; acc:  90.38; ppl:  1.21; xent: 0.19; lr: 0.00096; 2637/2139 tok/s;   2499 sec
[2020-08-19 23:38:30,115 INFO] Step 17000/20000; acc:  90.67; ppl:  1.20; xent: 0.18; lr: 0.00096; 2715/2208 tok/s;   2514 sec
[2020-08-19 23:38:32,608 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:38:32,700 INFO] number of examples: 9920
[2020-08-19 23:38:44,952 INFO] Step 17100/20000; acc:  90.56; ppl:  1.20; xent: 0.18; lr: 0.00096; 2636/2140 tok/s;   2529 sec
[2020-08-19 23:38:53,783 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_17160.pt
[2020-08-19 23:38:59,943 INFO] Step 17200/20000; acc:  90.42; ppl:  1.21; xent: 0.19; lr: 0.00095; 2630/2130 tok/s;   2544 sec
[2020-08-19 23:39:14,606 INFO] Step 17300/20000; acc:  90.71; ppl:  1.20; xent: 0.18; lr: 0.00095; 2654/2159 tok/s;   2558 sec
[2020-08-19 23:39:29,221 INFO] Step 17400/20000; acc:  90.56; ppl:  1.20; xent: 0.19; lr: 0.00095; 2685/2173 tok/s;   2573 sec
[2020-08-19 23:39:39,790 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_17472.pt
[2020-08-19 23:39:44,285 INFO] Step 17500/20000; acc:  90.71; ppl:  1.20; xent: 0.18; lr: 0.00094; 2611/2123 tok/s;   2588 sec
[2020-08-19 23:39:58,918 INFO] Step 17600/20000; acc:  90.64; ppl:  1.20; xent: 0.18; lr: 0.00094; 2667/2167 tok/s;   2603 sec
[2020-08-19 23:40:13,664 INFO] Step 17700/20000; acc:  90.77; ppl:  1.20; xent: 0.18; lr: 0.00094; 2667/2166 tok/s;   2617 sec
[2020-08-19 23:40:25,993 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_17784.pt
[2020-08-19 23:40:28,662 INFO] Step 17800/20000; acc:  90.67; ppl:  1.20; xent: 0.18; lr: 0.00094; 2624/2129 tok/s;   2632 sec
[2020-08-19 23:40:43,339 INFO] Step 17900/20000; acc:  90.71; ppl:  1.20; xent: 0.18; lr: 0.00093; 2686/2179 tok/s;   2647 sec
[2020-08-19 23:40:58,012 INFO] Step 18000/20000; acc:  90.81; ppl:  1.20; xent: 0.19; lr: 0.00093; 2703/2199 tok/s;   2662 sec
[2020-08-19 23:41:00,631 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:41:00,727 INFO] number of examples: 9920
[2020-08-19 23:41:12,192 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_18096.pt
[2020-08-19 23:41:13,129 INFO] Step 18100/20000; acc:  90.29; ppl:  1.21; xent: 0.19; lr: 0.00093; 2590/2101 tok/s;   2677 sec
[2020-08-19 23:41:27,791 INFO] Step 18200/20000; acc:  90.71; ppl:  1.20; xent: 0.18; lr: 0.00093; 2689/2179 tok/s;   2692 sec
[2020-08-19 23:41:42,468 INFO] Step 18300/20000; acc:  91.08; ppl:  1.19; xent: 0.17; lr: 0.00092; 2651/2156 tok/s;   2706 sec
[2020-08-19 23:41:57,105 INFO] Step 18400/20000; acc:  90.61; ppl:  1.20; xent: 0.18; lr: 0.00092; 2682/2170 tok/s;   2721 sec
[2020-08-19 23:41:58,293 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_18408.pt
[2020-08-19 23:42:12,118 INFO] Step 18500/20000; acc:  90.74; ppl:  1.20; xent: 0.18; lr: 0.00092; 2622/2132 tok/s;   2736 sec
[2020-08-19 23:42:26,824 INFO] Step 18600/20000; acc:  90.78; ppl:  1.20; xent: 0.18; lr: 0.00092; 2650/2155 tok/s;   2751 sec
[2020-08-19 23:42:41,557 INFO] Step 18700/20000; acc:  90.75; ppl:  1.20; xent: 0.18; lr: 0.00091; 2670/2169 tok/s;   2765 sec
[2020-08-19 23:42:44,488 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_18720.pt
[2020-08-19 23:42:56,527 INFO] Step 18800/20000; acc:  90.56; ppl:  1.21; xent: 0.19; lr: 0.00091; 2629/2131 tok/s;   2780 sec
[2020-08-19 23:43:11,228 INFO] Step 18900/20000; acc:  90.82; ppl:  1.20; xent: 0.18; lr: 0.00091; 2680/2174 tok/s;   2795 sec
[2020-08-19 23:43:25,892 INFO] Step 19000/20000; acc:  91.14; ppl:  1.19; xent: 0.18; lr: 0.00091; 2708/2203 tok/s;   2810 sec
[2020-08-19 23:43:28,696 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:43:28,740 INFO] number of examples: 9920
[2020-08-19 23:43:30,777 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_19032.pt
[2020-08-19 23:43:41,034 INFO] Step 19100/20000; acc:  90.75; ppl:  1.20; xent: 0.18; lr: 0.00090; 2589/2100 tok/s;   2825 sec
[2020-08-19 23:43:55,698 INFO] Step 19200/20000; acc:  90.71; ppl:  1.20; xent: 0.18; lr: 0.00090; 2688/2180 tok/s;   2840 sec
[2020-08-19 23:44:10,386 INFO] Step 19300/20000; acc:  90.92; ppl:  1.19; xent: 0.18; lr: 0.00090; 2649/2154 tok/s;   2854 sec
[2020-08-19 23:44:16,830 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_19344.pt
[2020-08-19 23:44:25,353 INFO] Step 19400/20000; acc:  90.63; ppl:  1.20; xent: 0.18; lr: 0.00090; 2623/2122 tok/s;   2869 sec
[2020-08-19 23:44:40,101 INFO] Step 19500/20000; acc:  90.82; ppl:  1.20; xent: 0.18; lr: 0.00090; 2671/2171 tok/s;   2884 sec
[2020-08-19 23:44:54,817 INFO] Step 19600/20000; acc:  90.46; ppl:  1.21; xent: 0.19; lr: 0.00089; 2646/2153 tok/s;   2899 sec
[2020-08-19 23:45:03,013 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_19656.pt
[2020-08-19 23:45:09,896 INFO] Step 19700/20000; acc:  90.87; ppl:  1.19; xent: 0.18; lr: 0.00089; 2611/2121 tok/s;   2914 sec
[2020-08-19 23:45:24,543 INFO] Step 19800/20000; acc:  90.61; ppl:  1.20; xent: 0.19; lr: 0.00089; 2683/2175 tok/s;   2928 sec
[2020-08-19 23:45:39,240 INFO] Step 19900/20000; acc:  90.99; ppl:  1.19; xent: 0.18; lr: 0.00089; 2684/2178 tok/s;   2943 sec
[2020-08-19 23:45:49,186 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_19968.pt
[2020-08-19 23:45:54,593 INFO] Step 20000/20000; acc:  91.18; ppl:  1.19; xent: 0.17; lr: 0.00088; 2588/2104 tok/s;   2958 sec
[2020-08-19 23:45:54,594 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-19 23:45:54,597 INFO] number of examples: 620
[2020-08-19 23:45:55,617 INFO] Validation perplexity: 1.19703
[2020-08-19 23:45:55,617 INFO] Validation accuracy: 93.6359
[2020-08-19 23:45:55,619 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv1/toy_model_step_20000.pt
[2020-08-19 23:45:57,011 INFO]  * src vocab size = 20
[2020-08-19 23:45:57,011 INFO]  * tgt vocab size = 20
[2020-08-19 23:45:57,011 INFO] Building model...
[2020-08-19 23:45:59,138 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=256, out_features=20, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-08-19 23:45:59,140 INFO] encoder: 5265920
[2020-08-19 23:45:59,140 INFO] decoder: 6320660
[2020-08-19 23:45:59,140 INFO] * number of parameters: 11586580
[2020-08-19 23:45:59,152 INFO] Starting training on GPU: [0]
[2020-08-19 23:45:59,152 INFO] Start training loop and validate every 10000 steps...
[2020-08-19 23:45:59,152 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:45:59,228 INFO] number of examples: 9920
[2020-08-19 23:46:15,021 INFO] Step 100/20000; acc:  52.82; ppl:  3.43; xent: 1.23; lr: 0.00014; 2469/2000 tok/s;     16 sec
[2020-08-19 23:46:30,566 INFO] Step 200/20000; acc:  72.80; ppl:  1.86; xent: 0.62; lr: 0.00028; 2544/2074 tok/s;     31 sec
[2020-08-19 23:46:46,073 INFO] Step 300/20000; acc:  78.40; ppl:  1.61; xent: 0.48; lr: 0.00042; 2530/2047 tok/s;     47 sec
[2020-08-19 23:46:47,927 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_312.pt
[2020-08-19 23:47:01,869 INFO] Step 400/20000; acc:  81.48; ppl:  1.52; xent: 0.42; lr: 0.00056; 2478/2008 tok/s;     63 sec
[2020-08-19 23:47:17,482 INFO] Step 500/20000; acc:  83.33; ppl:  1.45; xent: 0.37; lr: 0.00070; 2531/2054 tok/s;     78 sec
[2020-08-19 23:47:33,060 INFO] Step 600/20000; acc:  84.49; ppl:  1.41; xent: 0.34; lr: 0.00084; 2490/2018 tok/s;     94 sec
[2020-08-19 23:47:36,781 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_624.pt
[2020-08-19 23:47:48,906 INFO] Step 700/20000; acc:  84.71; ppl:  1.39; xent: 0.33; lr: 0.00098; 2478/2014 tok/s;    110 sec
[2020-08-19 23:48:04,583 INFO] Step 800/20000; acc:  85.23; ppl:  1.39; xent: 0.33; lr: 0.00112; 2505/2038 tok/s;    125 sec
[2020-08-19 23:48:20,204 INFO] Step 900/20000; acc:  85.96; ppl:  1.36; xent: 0.31; lr: 0.00126; 2526/2050 tok/s;    141 sec
[2020-08-19 23:48:25,809 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_936.pt
[2020-08-19 23:48:36,164 INFO] Step 1000/20000; acc:  86.40; ppl:  1.35; xent: 0.30; lr: 0.00140; 2474/2013 tok/s;    157 sec
[2020-08-19 23:48:36,315 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:48:36,404 INFO] number of examples: 9920
[2020-08-19 23:48:51,885 INFO] Step 1100/20000; acc:  86.27; ppl:  1.35; xent: 0.30; lr: 0.00154; 2492/2019 tok/s;    173 sec
[2020-08-19 23:49:07,405 INFO] Step 1200/20000; acc:  86.31; ppl:  1.35; xent: 0.30; lr: 0.00168; 2549/2078 tok/s;    188 sec
[2020-08-19 23:49:14,901 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_1248.pt
[2020-08-19 23:49:23,226 INFO] Step 1300/20000; acc:  86.05; ppl:  1.35; xent: 0.30; lr: 0.00182; 2485/2011 tok/s;    204 sec
[2020-08-19 23:49:38,749 INFO] Step 1400/20000; acc:  86.35; ppl:  1.34; xent: 0.29; lr: 0.00196; 2519/2044 tok/s;    220 sec
[2020-08-19 23:49:54,221 INFO] Step 1500/20000; acc:  86.47; ppl:  1.33; xent: 0.29; lr: 0.00210; 2556/2073 tok/s;    235 sec
[2020-08-19 23:50:03,524 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_1560.pt
[2020-08-19 23:50:10,046 INFO] Step 1600/20000; acc:  84.62; ppl:  1.40; xent: 0.33; lr: 0.00224; 2443/1980 tok/s;    251 sec
[2020-08-19 23:50:25,492 INFO] Step 1700/20000; acc:  84.63; ppl:  1.39; xent: 0.33; lr: 0.00238; 2545/2068 tok/s;    266 sec
[2020-08-19 23:50:40,893 INFO] Step 1800/20000; acc:  83.96; ppl:  1.40; xent: 0.34; lr: 0.00252; 2548/2072 tok/s;    282 sec
[2020-08-19 23:50:51,903 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_1872.pt
[2020-08-19 23:50:56,506 INFO] Step 1900/20000; acc:  84.38; ppl:  1.40; xent: 0.34; lr: 0.00266; 2526/2051 tok/s;    297 sec
[2020-08-19 23:51:11,785 INFO] Step 2000/20000; acc:  83.41; ppl:  1.43; xent: 0.36; lr: 0.00279; 2589/2105 tok/s;    313 sec
[2020-08-19 23:51:12,089 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:51:12,130 INFO] number of examples: 9920
[2020-08-19 23:51:27,248 INFO] Step 2100/20000; acc:  81.86; ppl:  1.49; xent: 0.40; lr: 0.00273; 2532/2052 tok/s;    328 sec
[2020-08-19 23:51:40,077 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_2184.pt
[2020-08-19 23:51:42,850 INFO] Step 2200/20000; acc:  82.04; ppl:  1.47; xent: 0.38; lr: 0.00266; 2534/2066 tok/s;    344 sec
[2020-08-19 23:51:58,130 INFO] Step 2300/20000; acc:  84.04; ppl:  1.40; xent: 0.34; lr: 0.00261; 2574/2083 tok/s;    359 sec
[2020-08-19 23:52:13,422 INFO] Step 2400/20000; acc:  84.68; ppl:  1.38; xent: 0.32; lr: 0.00255; 2561/2076 tok/s;    374 sec
[2020-08-19 23:52:28,071 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_2496.pt
[2020-08-19 23:52:29,025 INFO] Step 2500/20000; acc:  84.48; ppl:  1.38; xent: 0.32; lr: 0.00250; 2530/2052 tok/s;    390 sec
[2020-08-19 23:52:44,382 INFO] Step 2600/20000; acc:  83.77; ppl:  1.42; xent: 0.35; lr: 0.00245; 2517/2040 tok/s;    405 sec
[2020-08-19 23:52:59,685 INFO] Step 2700/20000; acc:  84.55; ppl:  1.38; xent: 0.32; lr: 0.00241; 2568/2087 tok/s;    421 sec
[2020-08-19 23:53:14,958 INFO] Step 2800/20000; acc:  85.07; ppl:  1.36; xent: 0.31; lr: 0.00236; 2573/2094 tok/s;    436 sec
[2020-08-19 23:53:16,189 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_2808.pt
[2020-08-19 23:53:30,504 INFO] Step 2900/20000; acc:  85.68; ppl:  1.34; xent: 0.29; lr: 0.00232; 2534/2055 tok/s;    451 sec
[2020-08-19 23:53:45,736 INFO] Step 3000/20000; acc:  85.55; ppl:  1.36; xent: 0.30; lr: 0.00228; 2599/2114 tok/s;    467 sec
[2020-08-19 23:53:46,186 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:53:46,228 INFO] number of examples: 9920
[2020-08-19 23:54:01,156 INFO] Step 3100/20000; acc:  85.70; ppl:  1.33; xent: 0.29; lr: 0.00224; 2538/2057 tok/s;    482 sec
[2020-08-19 23:54:04,196 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_3120.pt
[2020-08-19 23:54:16,689 INFO] Step 3200/20000; acc:  85.90; ppl:  1.34; xent: 0.29; lr: 0.00221; 2543/2072 tok/s;    498 sec
[2020-08-19 23:54:31,936 INFO] Step 3300/20000; acc:  84.91; ppl:  1.37; xent: 0.31; lr: 0.00218; 2582/2089 tok/s;    513 sec
[2020-08-19 23:54:47,208 INFO] Step 3400/20000; acc:  84.54; ppl:  1.38; xent: 0.32; lr: 0.00214; 2566/2082 tok/s;    528 sec
[2020-08-19 23:54:52,105 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_3432.pt
[2020-08-19 23:55:02,871 INFO] Step 3500/20000; acc:  85.26; ppl:  1.35; xent: 0.30; lr: 0.00211; 2523/2045 tok/s;    544 sec
[2020-08-19 23:55:18,184 INFO] Step 3600/20000; acc:  85.00; ppl:  1.37; xent: 0.31; lr: 0.00208; 2527/2048 tok/s;    559 sec
[2020-08-19 23:55:33,452 INFO] Step 3700/20000; acc:  84.83; ppl:  1.37; xent: 0.32; lr: 0.00205; 2572/2091 tok/s;    574 sec
[2020-08-19 23:55:40,630 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_3744.pt
[2020-08-19 23:55:49,959 INFO] Step 3800/20000; acc:  85.54; ppl:  1.35; xent: 0.30; lr: 0.00203; 2449/1992 tok/s;    591 sec
[2020-08-19 23:56:05,250 INFO] Step 3900/20000; acc:  85.10; ppl:  1.36; xent: 0.31; lr: 0.00200; 2577/2091 tok/s;    606 sec
[2020-08-19 23:56:20,496 INFO] Step 4000/20000; acc:  85.26; ppl:  1.36; xent: 0.31; lr: 0.00198; 2597/2112 tok/s;    621 sec
[2020-08-19 23:56:21,101 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:56:21,143 INFO] number of examples: 9920
[2020-08-19 23:56:29,156 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_4056.pt
[2020-08-19 23:56:36,188 INFO] Step 4100/20000; acc:  85.53; ppl:  1.35; xent: 0.30; lr: 0.00195; 2496/2023 tok/s;    637 sec
[2020-08-19 23:56:51,530 INFO] Step 4200/20000; acc:  85.49; ppl:  1.35; xent: 0.30; lr: 0.00193; 2571/2095 tok/s;    652 sec
[2020-08-19 23:57:06,805 INFO] Step 4300/20000; acc:  86.31; ppl:  1.32; xent: 0.28; lr: 0.00191; 2578/2087 tok/s;    668 sec
[2020-08-19 23:57:17,207 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_4368.pt
[2020-08-19 23:57:22,453 INFO] Step 4400/20000; acc:  86.89; ppl:  1.30; xent: 0.27; lr: 0.00188; 2503/2030 tok/s;    683 sec
[2020-08-19 23:57:37,748 INFO] Step 4500/20000; acc:  86.81; ppl:  1.31; xent: 0.27; lr: 0.00186; 2582/2093 tok/s;    699 sec
[2020-08-19 23:57:53,045 INFO] Step 4600/20000; acc:  85.47; ppl:  1.35; xent: 0.30; lr: 0.00184; 2527/2048 tok/s;    714 sec
[2020-08-19 23:58:05,263 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_4680.pt
[2020-08-19 23:58:08,573 INFO] Step 4700/20000; acc:  85.29; ppl:  1.36; xent: 0.31; lr: 0.00182; 2528/2056 tok/s;    729 sec
[2020-08-19 23:58:23,919 INFO] Step 4800/20000; acc:  85.78; ppl:  1.34; xent: 0.29; lr: 0.00180; 2558/2080 tok/s;    745 sec
[2020-08-19 23:58:39,183 INFO] Step 4900/20000; acc:  86.28; ppl:  1.32; xent: 0.28; lr: 0.00179; 2588/2101 tok/s;    760 sec
[2020-08-19 23:58:53,201 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_4992.pt
[2020-08-19 23:58:54,752 INFO] Step 5000/20000; acc:  86.20; ppl:  1.33; xent: 0.29; lr: 0.00177; 2540/2065 tok/s;    776 sec
[2020-08-19 23:58:55,507 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-19 23:58:55,550 INFO] number of examples: 9920
[2020-08-19 23:59:10,145 INFO] Step 5100/20000; acc:  82.28; ppl:  1.47; xent: 0.38; lr: 0.00175; 2544/2061 tok/s;    791 sec
[2020-08-19 23:59:25,450 INFO] Step 5200/20000; acc:  83.28; ppl:  1.42; xent: 0.35; lr: 0.00173; 2579/2102 tok/s;    806 sec
[2020-08-19 23:59:40,703 INFO] Step 5300/20000; acc:  85.24; ppl:  1.35; xent: 0.30; lr: 0.00172; 2581/2090 tok/s;    822 sec
[2020-08-19 23:59:41,318 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_5304.pt
[2020-08-19 23:59:56,260 INFO] Step 5400/20000; acc:  85.60; ppl:  1.35; xent: 0.30; lr: 0.00170; 2516/2041 tok/s;    837 sec
[2020-08-20 00:00:11,551 INFO] Step 5500/20000; acc:  79.09; ppl:  1.58; xent: 0.46; lr: 0.00169; 2582/2093 tok/s;    852 sec
[2020-08-20 00:00:26,844 INFO] Step 5600/20000; acc:  83.57; ppl:  1.41; xent: 0.35; lr: 0.00167; 2532/2051 tok/s;    868 sec
[2020-08-20 00:00:29,291 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_5616.pt
[2020-08-20 00:00:42,520 INFO] Step 5700/20000; acc:  83.09; ppl:  1.43; xent: 0.36; lr: 0.00166; 2505/2037 tok/s;    883 sec
[2020-08-20 00:00:57,822 INFO] Step 5800/20000; acc:  85.48; ppl:  1.34; xent: 0.30; lr: 0.00164; 2562/2083 tok/s;    899 sec
[2020-08-20 00:01:13,079 INFO] Step 5900/20000; acc:  86.26; ppl:  1.32; xent: 0.28; lr: 0.00163; 2588/2100 tok/s;    914 sec
[2020-08-20 00:01:17,382 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_5928.pt
[2020-08-20 00:01:28,737 INFO] Step 6000/20000; acc:  86.81; ppl:  1.31; xent: 0.27; lr: 0.00161; 2530/2057 tok/s;    930 sec
[2020-08-20 00:01:29,656 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:01:29,732 INFO] number of examples: 9920
[2020-08-20 00:01:44,163 INFO] Step 6100/20000; acc:  85.55; ppl:  1.34; xent: 0.30; lr: 0.00160; 2536/2056 tok/s;    945 sec
[2020-08-20 00:01:59,391 INFO] Step 6200/20000; acc:  82.06; ppl:  1.47; xent: 0.38; lr: 0.00159; 2591/2113 tok/s;    960 sec
[2020-08-20 00:02:05,415 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_6240.pt
[2020-08-20 00:02:14,835 INFO] Step 6300/20000; acc:  84.11; ppl:  1.38; xent: 0.33; lr: 0.00157; 2552/2066 tok/s;    976 sec
[2020-08-20 00:02:29,960 INFO] Step 6400/20000; acc:  83.73; ppl:  1.41; xent: 0.34; lr: 0.00156; 2585/2097 tok/s;    991 sec
[2020-08-20 00:02:45,051 INFO] Step 6500/20000; acc:  85.53; ppl:  1.34; xent: 0.30; lr: 0.00155; 2617/2122 tok/s;   1006 sec
[2020-08-20 00:02:52,890 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_6552.pt
[2020-08-20 00:03:00,493 INFO] Step 6600/20000; acc:  86.12; ppl:  1.32; xent: 0.28; lr: 0.00154; 2504/2029 tok/s;   1021 sec
[2020-08-20 00:03:15,597 INFO] Step 6700/20000; acc:  86.31; ppl:  1.32; xent: 0.28; lr: 0.00153; 2603/2116 tok/s;   1036 sec
[2020-08-20 00:03:30,714 INFO] Step 6800/20000; acc:  86.33; ppl:  1.31; xent: 0.27; lr: 0.00152; 2592/2108 tok/s;   1052 sec
[2020-08-20 00:03:40,366 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_6864.pt
[2020-08-20 00:03:46,240 INFO] Step 6900/20000; acc:  86.76; ppl:  1.31; xent: 0.27; lr: 0.00150; 2544/2063 tok/s;   1067 sec
[2020-08-20 00:04:01,375 INFO] Step 7000/20000; acc:  87.02; ppl:  1.30; xent: 0.26; lr: 0.00149; 2616/2127 tok/s;   1082 sec
[2020-08-20 00:04:02,435 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:04:02,550 INFO] number of examples: 9920
[2020-08-20 00:04:16,690 INFO] Step 7100/20000; acc:  87.46; ppl:  1.28; xent: 0.25; lr: 0.00148; 2558/2074 tok/s;   1098 sec
[2020-08-20 00:04:28,164 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_7176.pt
[2020-08-20 00:04:32,153 INFO] Step 7200/20000; acc:  86.97; ppl:  1.30; xent: 0.26; lr: 0.00147; 2550/2077 tok/s;   1113 sec
[2020-08-20 00:04:47,293 INFO] Step 7300/20000; acc:  87.04; ppl:  1.29; xent: 0.26; lr: 0.00146; 2603/2107 tok/s;   1128 sec
[2020-08-20 00:05:02,414 INFO] Step 7400/20000; acc:  87.04; ppl:  1.29; xent: 0.26; lr: 0.00145; 2589/2099 tok/s;   1143 sec
[2020-08-20 00:05:15,733 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_7488.pt
[2020-08-20 00:05:18,088 INFO] Step 7500/20000; acc:  85.72; ppl:  1.34; xent: 0.30; lr: 0.00144; 2517/2042 tok/s;   1159 sec
[2020-08-20 00:05:33,175 INFO] Step 7600/20000; acc:  80.50; ppl:  1.52; xent: 0.42; lr: 0.00143; 2562/2076 tok/s;   1174 sec
[2020-08-20 00:05:48,314 INFO] Step 7700/20000; acc:  83.46; ppl:  1.40; xent: 0.34; lr: 0.00142; 2600/2113 tok/s;   1189 sec
[2020-08-20 00:06:03,365 INFO] Step 7800/20000; acc:  84.55; ppl:  1.37; xent: 0.31; lr: 0.00142; 2601/2114 tok/s;   1204 sec
[2020-08-20 00:06:03,367 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_7800.pt
[2020-08-20 00:06:18,729 INFO] Step 7900/20000; acc:  86.09; ppl:  1.33; xent: 0.29; lr: 0.00141; 2569/2084 tok/s;   1220 sec
[2020-08-20 00:06:33,816 INFO] Step 8000/20000; acc:  85.97; ppl:  1.33; xent: 0.28; lr: 0.00140; 2626/2135 tok/s;   1235 sec
[2020-08-20 00:06:35,027 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:06:35,105 INFO] number of examples: 9920
[2020-08-20 00:06:49,041 INFO] Step 8100/20000; acc:  86.60; ppl:  1.30; xent: 0.27; lr: 0.00139; 2571/2086 tok/s;   1250 sec
[2020-08-20 00:06:50,870 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_8112.pt
[2020-08-20 00:07:04,459 INFO] Step 8200/20000; acc:  86.54; ppl:  1.31; xent: 0.27; lr: 0.00138; 2559/2085 tok/s;   1265 sec
[2020-08-20 00:07:19,575 INFO] Step 8300/20000; acc:  86.71; ppl:  1.30; xent: 0.26; lr: 0.00137; 2608/2111 tok/s;   1280 sec
[2020-08-20 00:07:34,661 INFO] Step 8400/20000; acc:  87.23; ppl:  1.29; xent: 0.26; lr: 0.00136; 2597/2106 tok/s;   1296 sec
[2020-08-20 00:07:38,264 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_8424.pt
[2020-08-20 00:07:50,040 INFO] Step 8500/20000; acc:  87.15; ppl:  1.29; xent: 0.25; lr: 0.00136; 2566/2081 tok/s;   1311 sec
[2020-08-20 00:08:05,141 INFO] Step 8600/20000; acc:  87.29; ppl:  1.29; xent: 0.25; lr: 0.00135; 2562/2075 tok/s;   1326 sec
[2020-08-20 00:08:20,334 INFO] Step 8700/20000; acc:  87.06; ppl:  1.29; xent: 0.25; lr: 0.00134; 2610/2122 tok/s;   1341 sec
[2020-08-20 00:08:25,800 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_8736.pt
[2020-08-20 00:08:35,835 INFO] Step 8800/20000; acc:  86.26; ppl:  1.32; xent: 0.28; lr: 0.00133; 2524/2053 tok/s;   1357 sec
[2020-08-20 00:08:50,948 INFO] Step 8900/20000; acc:  86.20; ppl:  1.33; xent: 0.29; lr: 0.00132; 2611/2117 tok/s;   1372 sec
[2020-08-20 00:09:06,050 INFO] Step 9000/20000; acc:  86.64; ppl:  1.31; xent: 0.27; lr: 0.00132; 2621/2132 tok/s;   1387 sec
[2020-08-20 00:09:07,402 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:09:07,484 INFO] number of examples: 9920
[2020-08-20 00:09:13,487 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_9048.pt
[2020-08-20 00:09:21,657 INFO] Step 9100/20000; acc:  87.41; ppl:  1.28; xent: 0.25; lr: 0.00131; 2512/2038 tok/s;   1403 sec
[2020-08-20 00:09:36,740 INFO] Step 9200/20000; acc:  87.43; ppl:  1.28; xent: 0.25; lr: 0.00130; 2614/2129 tok/s;   1418 sec
[2020-08-20 00:09:51,782 INFO] Step 9300/20000; acc:  87.37; ppl:  1.28; xent: 0.25; lr: 0.00130; 2619/2121 tok/s;   1433 sec
[2020-08-20 00:10:00,860 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_9360.pt
[2020-08-20 00:10:07,207 INFO] Step 9400/20000; acc:  87.42; ppl:  1.28; xent: 0.25; lr: 0.00129; 2541/2060 tok/s;   1448 sec
[2020-08-20 00:10:22,327 INFO] Step 9500/20000; acc:  87.66; ppl:  1.27; xent: 0.24; lr: 0.00128; 2610/2117 tok/s;   1463 sec
[2020-08-20 00:10:37,454 INFO] Step 9600/20000; acc:  87.48; ppl:  1.28; xent: 0.25; lr: 0.00128; 2557/2072 tok/s;   1478 sec
[2020-08-20 00:10:48,371 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_9672.pt
[2020-08-20 00:10:52,863 INFO] Step 9700/20000; acc:  87.25; ppl:  1.28; xent: 0.25; lr: 0.00127; 2552/2075 tok/s;   1494 sec
[2020-08-20 00:11:07,964 INFO] Step 9800/20000; acc:  87.44; ppl:  1.28; xent: 0.25; lr: 0.00126; 2592/2109 tok/s;   1509 sec
[2020-08-20 00:11:23,014 INFO] Step 9900/20000; acc:  87.71; ppl:  1.27; xent: 0.24; lr: 0.00126; 2622/2126 tok/s;   1524 sec
[2020-08-20 00:11:35,764 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_9984.pt
[2020-08-20 00:11:38,482 INFO] Step 10000/20000; acc:  88.24; ppl:  1.27; xent: 0.24; lr: 0.00125; 2561/2083 tok/s;   1539 sec
[2020-08-20 00:11:38,483 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 00:11:38,512 INFO] number of examples: 620
[2020-08-20 00:11:39,540 INFO] Validation perplexity: 1.30715
[2020-08-20 00:11:39,540 INFO] Validation accuracy: 89.3444
[2020-08-20 00:11:41,050 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:11:41,130 INFO] number of examples: 9920
[2020-08-20 00:11:54,756 INFO] Step 10100/20000; acc:  87.83; ppl:  1.27; xent: 0.24; lr: 0.00124; 2407/1953 tok/s;   1556 sec
[2020-08-20 00:12:09,861 INFO] Step 10200/20000; acc:  87.33; ppl:  1.28; xent: 0.25; lr: 0.00124; 2612/2128 tok/s;   1571 sec
[2020-08-20 00:12:24,332 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_10296.pt
[2020-08-20 00:12:25,342 INFO] Step 10300/20000; acc:  87.76; ppl:  1.27; xent: 0.24; lr: 0.00123; 2544/2059 tok/s;   1586 sec
[2020-08-20 00:12:40,388 INFO] Step 10400/20000; acc:  87.36; ppl:  1.29; xent: 0.25; lr: 0.00123; 2605/2112 tok/s;   1601 sec
[2020-08-20 00:12:55,549 INFO] Step 10500/20000; acc:  87.77; ppl:  1.27; xent: 0.24; lr: 0.00122; 2607/2114 tok/s;   1616 sec
[2020-08-20 00:13:10,700 INFO] Step 10600/20000; acc:  87.34; ppl:  1.29; xent: 0.25; lr: 0.00121; 2550/2066 tok/s;   1632 sec
[2020-08-20 00:13:11,925 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_10608.pt
[2020-08-20 00:13:26,096 INFO] Step 10700/20000; acc:  87.25; ppl:  1.28; xent: 0.25; lr: 0.00121; 2553/2076 tok/s;   1647 sec
[2020-08-20 00:13:41,230 INFO] Step 10800/20000; acc:  87.24; ppl:  1.27; xent: 0.24; lr: 0.00120; 2587/2104 tok/s;   1662 sec
[2020-08-20 00:13:56,287 INFO] Step 10900/20000; acc:  87.82; ppl:  1.27; xent: 0.24; lr: 0.00120; 2621/2125 tok/s;   1677 sec
[2020-08-20 00:13:59,308 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_10920.pt
[2020-08-20 00:14:11,834 INFO] Step 11000/20000; acc:  87.71; ppl:  1.28; xent: 0.24; lr: 0.00119; 2550/2073 tok/s;   1693 sec
[2020-08-20 00:14:13,497 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:14:13,581 INFO] number of examples: 9920
[2020-08-20 00:14:27,113 INFO] Step 11100/20000; acc:  87.88; ppl:  1.26; xent: 0.23; lr: 0.00119; 2559/2076 tok/s;   1708 sec
[2020-08-20 00:14:42,282 INFO] Step 11200/20000; acc:  87.48; ppl:  1.28; xent: 0.25; lr: 0.00118; 2599/2117 tok/s;   1723 sec
[2020-08-20 00:14:47,118 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_11232.pt
[2020-08-20 00:14:57,807 INFO] Step 11300/20000; acc:  87.75; ppl:  1.27; xent: 0.24; lr: 0.00118; 2541/2057 tok/s;   1739 sec
[2020-08-20 00:15:12,907 INFO] Step 11400/20000; acc:  87.23; ppl:  1.29; xent: 0.26; lr: 0.00117; 2595/2106 tok/s;   1754 sec
[2020-08-20 00:15:28,002 INFO] Step 11500/20000; acc:  88.09; ppl:  1.26; xent: 0.23; lr: 0.00117; 2617/2121 tok/s;   1769 sec
[2020-08-20 00:15:34,705 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_11544.pt
[2020-08-20 00:15:43,617 INFO] Step 11600/20000; acc:  88.01; ppl:  1.26; xent: 0.23; lr: 0.00116; 2476/2007 tok/s;   1784 sec
[2020-08-20 00:15:58,743 INFO] Step 11700/20000; acc:  87.59; ppl:  1.27; xent: 0.24; lr: 0.00116; 2600/2113 tok/s;   1800 sec
[2020-08-20 00:16:13,893 INFO] Step 11800/20000; acc:  87.86; ppl:  1.27; xent: 0.24; lr: 0.00115; 2583/2101 tok/s;   1815 sec
[2020-08-20 00:16:22,326 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_11856.pt
[2020-08-20 00:16:29,367 INFO] Step 11900/20000; acc:  87.91; ppl:  1.27; xent: 0.24; lr: 0.00115; 2547/2065 tok/s;   1830 sec
[2020-08-20 00:16:44,497 INFO] Step 12000/20000; acc:  88.19; ppl:  1.27; xent: 0.24; lr: 0.00114; 2621/2131 tok/s;   1845 sec
[2020-08-20 00:16:46,308 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:16:46,392 INFO] number of examples: 9920
[2020-08-20 00:16:59,773 INFO] Step 12100/20000; acc:  88.06; ppl:  1.26; xent: 0.23; lr: 0.00114; 2558/2076 tok/s;   1861 sec
[2020-08-20 00:17:10,039 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_12168.pt
[2020-08-20 00:17:15,174 INFO] Step 12200/20000; acc:  88.38; ppl:  1.26; xent: 0.23; lr: 0.00113; 2564/2088 tok/s;   1876 sec
[2020-08-20 00:17:30,256 INFO] Step 12300/20000; acc:  88.35; ppl:  1.26; xent: 0.23; lr: 0.00113; 2613/2116 tok/s;   1891 sec
[2020-08-20 00:17:45,314 INFO] Step 12400/20000; acc:  88.12; ppl:  1.27; xent: 0.24; lr: 0.00112; 2601/2109 tok/s;   1906 sec
[2020-08-20 00:17:57,435 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_12480.pt
[2020-08-20 00:18:00,788 INFO] Step 12500/20000; acc:  88.51; ppl:  1.26; xent: 0.23; lr: 0.00112; 2565/2080 tok/s;   1922 sec
[2020-08-20 00:18:15,866 INFO] Step 12600/20000; acc:  88.22; ppl:  1.26; xent: 0.23; lr: 0.00111; 2565/2079 tok/s;   1937 sec
[2020-08-20 00:18:30,980 INFO] Step 12700/20000; acc:  88.09; ppl:  1.26; xent: 0.23; lr: 0.00111; 2600/2113 tok/s;   1952 sec
[2020-08-20 00:18:44,855 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_12792.pt
[2020-08-20 00:18:46,308 INFO] Step 12800/20000; acc:  88.38; ppl:  1.26; xent: 0.23; lr: 0.00110; 2554/2078 tok/s;   1967 sec
[2020-08-20 00:19:01,383 INFO] Step 12900/20000; acc:  88.26; ppl:  1.26; xent: 0.23; lr: 0.00110; 2615/2118 tok/s;   1982 sec
[2020-08-20 00:19:16,495 INFO] Step 13000/20000; acc:  88.49; ppl:  1.25; xent: 0.23; lr: 0.00110; 2624/2135 tok/s;   1997 sec
[2020-08-20 00:19:18,451 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:19:18,535 INFO] number of examples: 9920
[2020-08-20 00:19:31,739 INFO] Step 13100/20000; acc:  88.40; ppl:  1.25; xent: 0.23; lr: 0.00109; 2564/2081 tok/s;   2013 sec
[2020-08-20 00:19:32,342 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_13104.pt
[2020-08-20 00:19:47,129 INFO] Step 13200/20000; acc:  87.65; ppl:  1.28; xent: 0.25; lr: 0.00109; 2563/2086 tok/s;   2028 sec
[2020-08-20 00:20:02,198 INFO] Step 13300/20000; acc:  88.28; ppl:  1.26; xent: 0.23; lr: 0.00108; 2617/2119 tok/s;   2043 sec
[2020-08-20 00:20:17,297 INFO] Step 13400/20000; acc:  88.32; ppl:  1.26; xent: 0.23; lr: 0.00108; 2595/2104 tok/s;   2058 sec
[2020-08-20 00:20:19,714 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_13416.pt
[2020-08-20 00:20:33,620 INFO] Step 13500/20000; acc:  88.66; ppl:  1.25; xent: 0.22; lr: 0.00108; 2423/1965 tok/s;   2074 sec
[2020-08-20 00:20:48,727 INFO] Step 13600/20000; acc:  88.48; ppl:  1.25; xent: 0.23; lr: 0.00107; 2555/2071 tok/s;   2090 sec
[2020-08-20 00:21:03,807 INFO] Step 13700/20000; acc:  88.69; ppl:  1.25; xent: 0.22; lr: 0.00107; 2612/2122 tok/s;   2105 sec
[2020-08-20 00:21:08,057 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_13728.pt
[2020-08-20 00:21:19,251 INFO] Step 13800/20000; acc:  88.30; ppl:  1.26; xent: 0.23; lr: 0.00106; 2531/2059 tok/s;   2120 sec
[2020-08-20 00:21:34,320 INFO] Step 13900/20000; acc:  88.18; ppl:  1.26; xent: 0.23; lr: 0.00106; 2615/2118 tok/s;   2135 sec
[2020-08-20 00:21:49,395 INFO] Step 14000/20000; acc:  88.09; ppl:  1.27; xent: 0.24; lr: 0.00106; 2633/2143 tok/s;   2150 sec
[2020-08-20 00:21:51,508 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:21:51,598 INFO] number of examples: 9920
[2020-08-20 00:21:55,581 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_14040.pt
[2020-08-20 00:22:04,980 INFO] Step 14100/20000; acc:  88.43; ppl:  1.26; xent: 0.23; lr: 0.00105; 2505/2032 tok/s;   2166 sec
[2020-08-20 00:22:20,088 INFO] Step 14200/20000; acc:  87.28; ppl:  1.29; xent: 0.25; lr: 0.00105; 2613/2128 tok/s;   2181 sec
[2020-08-20 00:22:35,164 INFO] Step 14300/20000; acc:  87.98; ppl:  1.27; xent: 0.24; lr: 0.00105; 2615/2118 tok/s;   2196 sec
[2020-08-20 00:22:43,017 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_14352.pt
[2020-08-20 00:22:50,591 INFO] Step 14400/20000; acc:  88.54; ppl:  1.26; xent: 0.23; lr: 0.00104; 2542/2061 tok/s;   2211 sec
[2020-08-20 00:23:05,700 INFO] Step 14500/20000; acc:  88.01; ppl:  1.27; xent: 0.24; lr: 0.00104; 2620/2124 tok/s;   2227 sec
[2020-08-20 00:23:20,868 INFO] Step 14600/20000; acc:  88.80; ppl:  1.25; xent: 0.22; lr: 0.00103; 2541/2060 tok/s;   2242 sec
[2020-08-20 00:23:30,530 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_14664.pt
[2020-08-20 00:23:36,252 INFO] Step 14700/20000; acc:  88.79; ppl:  1.25; xent: 0.22; lr: 0.00103; 2562/2083 tok/s;   2257 sec
[2020-08-20 00:23:51,423 INFO] Step 14800/20000; acc:  88.73; ppl:  1.25; xent: 0.22; lr: 0.00103; 2576/2096 tok/s;   2272 sec
[2020-08-20 00:24:06,550 INFO] Step 14900/20000; acc:  88.83; ppl:  1.25; xent: 0.22; lr: 0.00102; 2607/2112 tok/s;   2287 sec
[2020-08-20 00:24:18,056 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_14976.pt
[2020-08-20 00:24:22,239 INFO] Step 15000/20000; acc:  88.84; ppl:  1.25; xent: 0.22; lr: 0.00102; 2525/2055 tok/s;   2303 sec
[2020-08-20 00:24:24,516 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:24:24,607 INFO] number of examples: 9920
[2020-08-20 00:24:37,543 INFO] Step 15100/20000; acc:  89.00; ppl:  1.24; xent: 0.21; lr: 0.00102; 2554/2072 tok/s;   2318 sec
[2020-08-20 00:24:52,689 INFO] Step 15200/20000; acc:  88.60; ppl:  1.25; xent: 0.22; lr: 0.00101; 2610/2124 tok/s;   2334 sec
[2020-08-20 00:25:05,970 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_15288.pt
[2020-08-20 00:25:10,045 INFO] Step 15300/20000; acc:  88.76; ppl:  1.25; xent: 0.22; lr: 0.00101; 2272/1841 tok/s;   2351 sec
[2020-08-20 00:25:25,199 INFO] Step 15400/20000; acc:  88.82; ppl:  1.24; xent: 0.22; lr: 0.00101; 2589/2100 tok/s;   2366 sec
[2020-08-20 00:25:40,273 INFO] Step 15500/20000; acc:  88.73; ppl:  1.25; xent: 0.22; lr: 0.00100; 2627/2130 tok/s;   2381 sec
[2020-08-20 00:25:55,329 INFO] Step 15600/20000; acc:  88.78; ppl:  1.25; xent: 0.22; lr: 0.00100; 2559/2075 tok/s;   2396 sec
[2020-08-20 00:25:55,331 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_15600.pt
[2020-08-20 00:26:10,754 INFO] Step 15700/20000; acc:  88.41; ppl:  1.26; xent: 0.23; lr: 0.00100; 2557/2080 tok/s;   2412 sec
[2020-08-20 00:26:25,883 INFO] Step 15800/20000; acc:  88.30; ppl:  1.25; xent: 0.23; lr: 0.00099; 2579/2098 tok/s;   2427 sec
[2020-08-20 00:26:40,958 INFO] Step 15900/20000; acc:  88.10; ppl:  1.27; xent: 0.24; lr: 0.00099; 2616/2119 tok/s;   2442 sec
[2020-08-20 00:26:42,763 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_15912.pt
[2020-08-20 00:26:56,367 INFO] Step 16000/20000; acc:  88.38; ppl:  1.26; xent: 0.23; lr: 0.00099; 2571/2092 tok/s;   2457 sec
[2020-08-20 00:26:58,780 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:26:58,869 INFO] number of examples: 9920
[2020-08-20 00:27:11,660 INFO] Step 16100/20000; acc:  88.74; ppl:  1.24; xent: 0.22; lr: 0.00099; 2555/2073 tok/s;   2473 sec
[2020-08-20 00:27:26,727 INFO] Step 16200/20000; acc:  88.32; ppl:  1.25; xent: 0.22; lr: 0.00098; 2620/2133 tok/s;   2488 sec
[2020-08-20 00:27:30,350 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_16224.pt
[2020-08-20 00:27:42,119 INFO] Step 16300/20000; acc:  88.53; ppl:  1.24; xent: 0.22; lr: 0.00098; 2564/2077 tok/s;   2503 sec
[2020-08-20 00:27:57,180 INFO] Step 16400/20000; acc:  88.46; ppl:  1.25; xent: 0.22; lr: 0.00098; 2602/2109 tok/s;   2518 sec
[2020-08-20 00:28:12,300 INFO] Step 16500/20000; acc:  88.86; ppl:  1.24; xent: 0.22; lr: 0.00097; 2618/2122 tok/s;   2533 sec
[2020-08-20 00:28:17,770 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_16536.pt
[2020-08-20 00:28:27,794 INFO] Step 16600/20000; acc:  88.93; ppl:  1.24; xent: 0.21; lr: 0.00097; 2492/2020 tok/s;   2549 sec
[2020-08-20 00:28:42,933 INFO] Step 16700/20000; acc:  88.76; ppl:  1.24; xent: 0.22; lr: 0.00097; 2605/2119 tok/s;   2564 sec
[2020-08-20 00:28:58,021 INFO] Step 16800/20000; acc:  88.42; ppl:  1.26; xent: 0.23; lr: 0.00096; 2585/2103 tok/s;   2579 sec
[2020-08-20 00:29:05,264 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_16848.pt
[2020-08-20 00:29:13,793 INFO] Step 16900/20000; acc:  88.90; ppl:  1.25; xent: 0.22; lr: 0.00096; 2501/2026 tok/s;   2595 sec
[2020-08-20 00:29:28,913 INFO] Step 17000/20000; acc:  88.53; ppl:  1.25; xent: 0.23; lr: 0.00096; 2616/2129 tok/s;   2610 sec
[2020-08-20 00:29:31,500 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:29:31,593 INFO] number of examples: 9920
[2020-08-20 00:29:44,207 INFO] Step 17100/20000; acc:  89.04; ppl:  1.24; xent: 0.21; lr: 0.00096; 2558/2077 tok/s;   2625 sec
[2020-08-20 00:29:53,249 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_17160.pt
[2020-08-20 00:29:59,791 INFO] Step 17200/20000; acc:  88.49; ppl:  1.26; xent: 0.23; lr: 0.00095; 2529/2059 tok/s;   2641 sec
[2020-08-20 00:30:14,864 INFO] Step 17300/20000; acc:  88.73; ppl:  1.24; xent: 0.22; lr: 0.00095; 2623/2125 tok/s;   2656 sec
[2020-08-20 00:30:29,979 INFO] Step 17400/20000; acc:  88.74; ppl:  1.24; xent: 0.22; lr: 0.00095; 2588/2098 tok/s;   2671 sec
[2020-08-20 00:30:40,856 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_17472.pt
[2020-08-20 00:30:54,511 INFO] Step 17500/20000; acc:  89.00; ppl:  1.24; xent: 0.22; lr: 0.00094; 1615/1309 tok/s;   2695 sec
[2020-08-20 00:31:09,636 INFO] Step 17600/20000; acc:  89.17; ppl:  1.24; xent: 0.21; lr: 0.00094; 2555/2071 tok/s;   2710 sec
[2020-08-20 00:31:24,755 INFO] Step 17700/20000; acc:  89.12; ppl:  1.24; xent: 0.21; lr: 0.00094; 2604/2117 tok/s;   2726 sec
[2020-08-20 00:31:37,445 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_17784.pt
[2020-08-20 00:31:40,188 INFO] Step 17800/20000; acc:  88.93; ppl:  1.24; xent: 0.21; lr: 0.00094; 2529/2058 tok/s;   2741 sec
[2020-08-20 00:31:55,313 INFO] Step 17900/20000; acc:  89.19; ppl:  1.24; xent: 0.21; lr: 0.00093; 2609/2114 tok/s;   2756 sec
[2020-08-20 00:32:10,446 INFO] Step 18000/20000; acc:  88.76; ppl:  1.24; xent: 0.22; lr: 0.00093; 2614/2127 tok/s;   2771 sec
[2020-08-20 00:32:13,162 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:32:13,254 INFO] number of examples: 9920
[2020-08-20 00:32:25,147 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_18096.pt
[2020-08-20 00:32:26,127 INFO] Step 18100/20000; acc:  89.30; ppl:  1.23; xent: 0.21; lr: 0.00093; 2495/2026 tok/s;   2787 sec
[2020-08-20 00:32:41,261 INFO] Step 18200/20000; acc:  86.47; ppl:  1.32; xent: 0.28; lr: 0.00093; 2603/2119 tok/s;   2802 sec
[2020-08-20 00:32:56,271 INFO] Step 18300/20000; acc:  87.78; ppl:  1.28; xent: 0.25; lr: 0.00092; 2635/2134 tok/s;   2817 sec
[2020-08-20 00:33:11,353 INFO] Step 18400/20000; acc:  88.51; ppl:  1.25; xent: 0.23; lr: 0.00092; 2592/2102 tok/s;   2832 sec
[2020-08-20 00:33:12,563 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_18408.pt
[2020-08-20 00:33:26,820 INFO] Step 18500/20000; acc:  88.90; ppl:  1.24; xent: 0.22; lr: 0.00092; 2561/2075 tok/s;   2848 sec
[2020-08-20 00:33:41,978 INFO] Step 18600/20000; acc:  88.71; ppl:  1.25; xent: 0.22; lr: 0.00092; 2551/2069 tok/s;   2863 sec
[2020-08-20 00:33:57,064 INFO] Step 18700/20000; acc:  88.17; ppl:  1.27; xent: 0.24; lr: 0.00091; 2611/2122 tok/s;   2878 sec
[2020-08-20 00:34:00,093 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_18720.pt
[2020-08-20 00:34:12,483 INFO] Step 18800/20000; acc:  88.71; ppl:  1.25; xent: 0.22; lr: 0.00091; 2532/2060 tok/s;   2893 sec
[2020-08-20 00:34:27,641 INFO] Step 18900/20000; acc:  88.99; ppl:  1.25; xent: 0.22; lr: 0.00091; 2604/2110 tok/s;   2908 sec
[2020-08-20 00:34:42,758 INFO] Step 19000/20000; acc:  89.13; ppl:  1.24; xent: 0.22; lr: 0.00091; 2612/2127 tok/s;   2924 sec
[2020-08-20 00:34:45,618 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:34:45,661 INFO] number of examples: 9920
[2020-08-20 00:34:47,751 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_19032.pt
[2020-08-20 00:34:58,377 INFO] Step 19100/20000; acc:  89.20; ppl:  1.23; xent: 0.21; lr: 0.00090; 2510/2037 tok/s;   2939 sec
[2020-08-20 00:35:13,471 INFO] Step 19200/20000; acc:  88.89; ppl:  1.25; xent: 0.22; lr: 0.00090; 2605/2120 tok/s;   2954 sec
[2020-08-20 00:35:28,520 INFO] Step 19300/20000; acc:  88.71; ppl:  1.24; xent: 0.22; lr: 0.00090; 2631/2132 tok/s;   2969 sec
[2020-08-20 00:35:35,141 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_19344.pt
[2020-08-20 00:35:43,976 INFO] Step 19400/20000; acc:  89.02; ppl:  1.24; xent: 0.21; lr: 0.00090; 2529/2050 tok/s;   2985 sec
[2020-08-20 00:35:59,074 INFO] Step 19500/20000; acc:  89.30; ppl:  1.23; xent: 0.21; lr: 0.00090; 2627/2129 tok/s;   3000 sec
[2020-08-20 00:36:14,107 INFO] Step 19600/20000; acc:  89.25; ppl:  1.23; xent: 0.21; lr: 0.00089; 2570/2085 tok/s;   3015 sec
[2020-08-20 00:36:22,749 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_19656.pt
[2020-08-20 00:36:29,727 INFO] Step 19700/20000; acc:  89.18; ppl:  1.24; xent: 0.21; lr: 0.00089; 2555/2076 tok/s;   3031 sec
[2020-08-20 00:36:44,862 INFO] Step 19800/20000; acc:  89.20; ppl:  1.23; xent: 0.21; lr: 0.00089; 2580/2098 tok/s;   3046 sec
[2020-08-20 00:36:59,957 INFO] Step 19900/20000; acc:  89.39; ppl:  1.23; xent: 0.21; lr: 0.00089; 2615/2118 tok/s;   3061 sec
[2020-08-20 00:37:10,228 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_19968.pt
[2020-08-20 00:37:15,364 INFO] Step 20000/20000; acc:  88.90; ppl:  1.24; xent: 0.22; lr: 0.00088; 2563/2088 tok/s;   3076 sec
[2020-08-20 00:37:15,365 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 00:37:15,395 INFO] number of examples: 620
[2020-08-20 00:37:16,420 INFO] Validation perplexity: 1.25705
[2020-08-20 00:37:16,420 INFO] Validation accuracy: 91.0893
[2020-08-20 00:37:16,422 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv2/toy_model_step_20000.pt
[2020-08-20 00:37:17,829 INFO]  * src vocab size = 20
[2020-08-20 00:37:17,829 INFO]  * tgt vocab size = 20
[2020-08-20 00:37:17,829 INFO] Building model...
[2020-08-20 00:37:19,974 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=256, out_features=20, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-08-20 00:37:19,976 INFO] encoder: 5265920
[2020-08-20 00:37:19,976 INFO] decoder: 6320660
[2020-08-20 00:37:19,976 INFO] * number of parameters: 11586580
[2020-08-20 00:37:19,980 INFO] Starting training on GPU: [0]
[2020-08-20 00:37:19,980 INFO] Start training loop and validate every 10000 steps...
[2020-08-20 00:37:19,980 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:37:20,098 INFO] number of examples: 9920
[2020-08-20 00:37:36,319 INFO] Step 100/20000; acc:  51.85; ppl:  3.61; xent: 1.28; lr: 0.00014; 2413/1956 tok/s;     16 sec
[2020-08-20 00:37:52,341 INFO] Step 200/20000; acc:  73.91; ppl:  1.82; xent: 0.60; lr: 0.00028; 2445/1988 tok/s;     32 sec
[2020-08-20 00:38:08,334 INFO] Step 300/20000; acc:  78.89; ppl:  1.60; xent: 0.47; lr: 0.00042; 2468/2003 tok/s;     48 sec
[2020-08-20 00:38:10,254 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_312.pt
[2020-08-20 00:38:24,632 INFO] Step 400/20000; acc:  81.62; ppl:  1.51; xent: 0.41; lr: 0.00056; 2424/1965 tok/s;     65 sec
[2020-08-20 00:38:40,605 INFO] Step 500/20000; acc:  83.20; ppl:  1.44; xent: 0.37; lr: 0.00070; 2444/1986 tok/s;     81 sec
[2020-08-20 00:38:56,576 INFO] Step 600/20000; acc:  84.52; ppl:  1.40; xent: 0.34; lr: 0.00084; 2448/1988 tok/s;     97 sec
[2020-08-20 00:39:00,424 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_624.pt
[2020-08-20 00:39:12,833 INFO] Step 700/20000; acc:  84.81; ppl:  1.40; xent: 0.33; lr: 0.00098; 2433/1972 tok/s;    113 sec
[2020-08-20 00:39:28,922 INFO] Step 800/20000; acc:  85.94; ppl:  1.36; xent: 0.31; lr: 0.00112; 2435/1969 tok/s;    129 sec
[2020-08-20 00:39:44,938 INFO] Step 900/20000; acc:  85.47; ppl:  1.37; xent: 0.31; lr: 0.00126; 2434/1978 tok/s;    145 sec
[2020-08-20 00:39:50,700 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_936.pt
[2020-08-20 00:40:01,276 INFO] Step 1000/20000; acc:  86.72; ppl:  1.34; xent: 0.29; lr: 0.00140; 2416/1970 tok/s;    161 sec
[2020-08-20 00:40:01,481 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:40:01,572 INFO] number of examples: 9920
[2020-08-20 00:40:17,480 INFO] Step 1100/20000; acc:  85.29; ppl:  1.37; xent: 0.32; lr: 0.00154; 2440/1977 tok/s;    177 sec
[2020-08-20 00:40:33,459 INFO] Step 1200/20000; acc:  86.38; ppl:  1.35; xent: 0.30; lr: 0.00168; 2450/1991 tok/s;    193 sec
[2020-08-20 00:40:41,120 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_1248.pt
[2020-08-20 00:40:49,710 INFO] Step 1300/20000; acc:  86.24; ppl:  1.34; xent: 0.30; lr: 0.00182; 2430/1973 tok/s;    210 sec
[2020-08-20 00:41:05,727 INFO] Step 1400/20000; acc:  86.12; ppl:  1.35; xent: 0.30; lr: 0.00196; 2465/1998 tok/s;    226 sec
[2020-08-20 00:41:21,649 INFO] Step 1500/20000; acc:  85.44; ppl:  1.37; xent: 0.32; lr: 0.00210; 2454/1993 tok/s;    242 sec
[2020-08-20 00:41:31,155 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_1560.pt
[2020-08-20 00:41:37,898 INFO] Step 1600/20000; acc:  84.64; ppl:  1.39; xent: 0.33; lr: 0.00224; 2403/1953 tok/s;    258 sec
[2020-08-20 00:41:53,753 INFO] Step 1700/20000; acc:  84.75; ppl:  1.38; xent: 0.32; lr: 0.00238; 2496/2023 tok/s;    274 sec
[2020-08-20 00:42:09,702 INFO] Step 1800/20000; acc:  83.73; ppl:  1.42; xent: 0.35; lr: 0.00252; 2455/1985 tok/s;    290 sec
[2020-08-20 00:42:21,154 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_1872.pt
[2020-08-20 00:42:25,917 INFO] Step 1900/20000; acc:  83.17; ppl:  1.43; xent: 0.36; lr: 0.00266; 2404/1954 tok/s;    306 sec
[2020-08-20 00:42:41,741 INFO] Step 2000/20000; acc:  83.45; ppl:  1.42; xent: 0.35; lr: 0.00279; 2497/2038 tok/s;    322 sec
[2020-08-20 00:42:42,059 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:42:42,100 INFO] number of examples: 9920
[2020-08-20 00:42:57,715 INFO] Step 2100/20000; acc:  83.74; ppl:  1.41; xent: 0.35; lr: 0.00273; 2465/1995 tok/s;    338 sec
[2020-08-20 00:43:10,992 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_2184.pt
[2020-08-20 00:43:13,824 INFO] Step 2200/20000; acc:  83.06; ppl:  1.44; xent: 0.36; lr: 0.00266; 2431/1976 tok/s;    354 sec
[2020-08-20 00:43:29,634 INFO] Step 2300/20000; acc:  83.93; ppl:  1.40; xent: 0.34; lr: 0.00261; 2498/2029 tok/s;    370 sec
[2020-08-20 00:43:45,419 INFO] Step 2400/20000; acc:  83.22; ppl:  1.43; xent: 0.36; lr: 0.00255; 2500/2027 tok/s;    385 sec
[2020-08-20 00:44:00,529 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_2496.pt
[2020-08-20 00:44:02,750 INFO] Step 2500/20000; acc:  83.70; ppl:  1.41; xent: 0.35; lr: 0.00250; 2258/1834 tok/s;    403 sec
[2020-08-20 00:44:18,572 INFO] Step 2600/20000; acc:  83.14; ppl:  1.44; xent: 0.36; lr: 0.00245; 2466/2004 tok/s;    419 sec
[2020-08-20 00:44:34,306 INFO] Step 2700/20000; acc:  83.86; ppl:  1.40; xent: 0.34; lr: 0.00241; 2513/2036 tok/s;    434 sec
[2020-08-20 00:44:50,127 INFO] Step 2800/20000; acc:  80.76; ppl:  1.52; xent: 0.42; lr: 0.00236; 2478/2005 tok/s;    450 sec
[2020-08-20 00:44:51,564 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_2808.pt
[2020-08-20 00:45:06,443 INFO] Step 2900/20000; acc:  82.14; ppl:  1.46; xent: 0.38; lr: 0.00232; 2413/1962 tok/s;    466 sec
[2020-08-20 00:45:22,226 INFO] Step 3000/20000; acc:  84.41; ppl:  1.38; xent: 0.32; lr: 0.00228; 2504/2043 tok/s;    482 sec
[2020-08-20 00:45:22,701 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:45:22,742 INFO] number of examples: 9920
[2020-08-20 00:45:38,147 INFO] Step 3100/20000; acc:  83.46; ppl:  1.42; xent: 0.35; lr: 0.00224; 2470/1999 tok/s;    498 sec
[2020-08-20 00:45:41,289 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_3120.pt
[2020-08-20 00:45:54,343 INFO] Step 3200/20000; acc:  82.73; ppl:  1.45; xent: 0.37; lr: 0.00221; 2421/1967 tok/s;    514 sec
[2020-08-20 00:46:10,172 INFO] Step 3300/20000; acc:  83.37; ppl:  1.41; xent: 0.35; lr: 0.00218; 2493/2026 tok/s;    530 sec
[2020-08-20 00:46:25,924 INFO] Step 3400/20000; acc:  84.44; ppl:  1.39; xent: 0.33; lr: 0.00214; 2506/2032 tok/s;    546 sec
[2020-08-20 00:46:30,943 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_3432.pt
[2020-08-20 00:46:41,996 INFO] Step 3500/20000; acc:  83.51; ppl:  1.42; xent: 0.35; lr: 0.00211; 2433/1977 tok/s;    562 sec
[2020-08-20 00:46:57,792 INFO] Step 3600/20000; acc:  83.12; ppl:  1.43; xent: 0.36; lr: 0.00208; 2475/2011 tok/s;    578 sec
[2020-08-20 00:47:13,595 INFO] Step 3700/20000; acc:  81.86; ppl:  1.48; xent: 0.39; lr: 0.00205; 2498/2024 tok/s;    594 sec
[2020-08-20 00:47:20,575 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_3744.pt
[2020-08-20 00:47:29,637 INFO] Step 3800/20000; acc:  83.31; ppl:  1.43; xent: 0.36; lr: 0.00203; 2444/1976 tok/s;    610 sec
[2020-08-20 00:47:45,414 INFO] Step 3900/20000; acc:  84.85; ppl:  1.37; xent: 0.32; lr: 0.00200; 2474/2010 tok/s;    625 sec
[2020-08-20 00:48:01,162 INFO] Step 4000/20000; acc:  84.57; ppl:  1.38; xent: 0.32; lr: 0.00198; 2509/2048 tok/s;    641 sec
[2020-08-20 00:48:01,793 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:48:01,835 INFO] number of examples: 9920
[2020-08-20 00:48:10,153 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_4056.pt
[2020-08-20 00:48:18,124 INFO] Step 4100/20000; acc:  84.92; ppl:  1.36; xent: 0.31; lr: 0.00195; 2317/1875 tok/s;    658 sec
[2020-08-20 00:48:33,892 INFO] Step 4200/20000; acc:  85.26; ppl:  1.36; xent: 0.31; lr: 0.00193; 2486/2020 tok/s;    674 sec
[2020-08-20 00:48:49,680 INFO] Step 4300/20000; acc:  84.89; ppl:  1.36; xent: 0.31; lr: 0.00191; 2500/2031 tok/s;    690 sec
[2020-08-20 00:49:00,398 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_4368.pt
[2020-08-20 00:49:05,763 INFO] Step 4400/20000; acc:  85.93; ppl:  1.33; xent: 0.29; lr: 0.00188; 2452/1988 tok/s;    706 sec
[2020-08-20 00:49:21,553 INFO] Step 4500/20000; acc:  86.21; ppl:  1.32; xent: 0.28; lr: 0.00186; 2480/2015 tok/s;    722 sec
[2020-08-20 00:49:37,325 INFO] Step 4600/20000; acc:  86.27; ppl:  1.32; xent: 0.28; lr: 0.00184; 2480/2016 tok/s;    737 sec
[2020-08-20 00:49:49,964 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_4680.pt
[2020-08-20 00:49:53,511 INFO] Step 4700/20000; acc:  86.21; ppl:  1.32; xent: 0.28; lr: 0.00182; 2436/1973 tok/s;    754 sec
[2020-08-20 00:50:09,280 INFO] Step 4800/20000; acc:  86.14; ppl:  1.33; xent: 0.28; lr: 0.00180; 2487/2013 tok/s;    769 sec
[2020-08-20 00:50:25,056 INFO] Step 4900/20000; acc:  85.13; ppl:  1.36; xent: 0.31; lr: 0.00179; 2475/2012 tok/s;    785 sec
[2020-08-20 00:50:39,504 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_4992.pt
[2020-08-20 00:50:41,040 INFO] Step 5000/20000; acc:  84.69; ppl:  1.38; xent: 0.32; lr: 0.00177; 2472/2018 tok/s;    801 sec
[2020-08-20 00:50:41,829 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:50:41,870 INFO] number of examples: 9920
[2020-08-20 00:50:56,917 INFO] Step 5100/20000; acc:  85.02; ppl:  1.36; xent: 0.31; lr: 0.00175; 2471/2001 tok/s;    817 sec
[2020-08-20 00:51:12,671 INFO] Step 5200/20000; acc:  85.73; ppl:  1.34; xent: 0.29; lr: 0.00173; 2493/2024 tok/s;    833 sec
[2020-08-20 00:51:28,490 INFO] Step 5300/20000; acc:  85.44; ppl:  1.34; xent: 0.30; lr: 0.00172; 2494/2026 tok/s;    849 sec
[2020-08-20 00:51:29,119 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_5304.pt
[2020-08-20 00:51:44,500 INFO] Step 5400/20000; acc:  83.43; ppl:  1.42; xent: 0.35; lr: 0.00170; 2461/1996 tok/s;    865 sec
[2020-08-20 00:52:00,281 INFO] Step 5500/20000; acc:  84.84; ppl:  1.37; xent: 0.32; lr: 0.00169; 2481/2016 tok/s;    880 sec
[2020-08-20 00:52:16,036 INFO] Step 5600/20000; acc:  85.77; ppl:  1.34; xent: 0.29; lr: 0.00167; 2484/2018 tok/s;    896 sec
[2020-08-20 00:52:18,560 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_5616.pt
[2020-08-20 00:52:32,132 INFO] Step 5700/20000; acc:  86.12; ppl:  1.33; xent: 0.29; lr: 0.00166; 2450/1984 tok/s;    912 sec
[2020-08-20 00:52:47,916 INFO] Step 5800/20000; acc:  86.26; ppl:  1.32; xent: 0.28; lr: 0.00164; 2484/2010 tok/s;    928 sec
[2020-08-20 00:53:03,682 INFO] Step 5900/20000; acc:  86.20; ppl:  1.33; xent: 0.28; lr: 0.00163; 2480/2014 tok/s;    944 sec
[2020-08-20 00:53:08,115 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_5928.pt
[2020-08-20 00:53:20,555 INFO] Step 6000/20000; acc:  85.65; ppl:  1.34; xent: 0.29; lr: 0.00161; 2338/1909 tok/s;    961 sec
[2020-08-20 00:53:21,503 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:53:21,581 INFO] number of examples: 9920
[2020-08-20 00:53:36,472 INFO] Step 6100/20000; acc:  84.89; ppl:  1.36; xent: 0.31; lr: 0.00160; 2464/1995 tok/s;    976 sec
[2020-08-20 00:53:52,183 INFO] Step 6200/20000; acc:  85.97; ppl:  1.33; xent: 0.28; lr: 0.00159; 2504/2033 tok/s;    992 sec
[2020-08-20 00:53:58,400 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_6240.pt
[2020-08-20 00:54:08,028 INFO] Step 6300/20000; acc:  86.16; ppl:  1.32; xent: 0.28; lr: 0.00157; 2488/2021 tok/s;   1008 sec
[2020-08-20 00:54:23,659 INFO] Step 6400/20000; acc:  85.56; ppl:  1.34; xent: 0.29; lr: 0.00156; 2523/2046 tok/s;   1024 sec
[2020-08-20 00:54:39,273 INFO] Step 6500/20000; acc:  86.53; ppl:  1.31; xent: 0.27; lr: 0.00155; 2505/2035 tok/s;   1039 sec
[2020-08-20 00:54:47,401 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_6552.pt
[2020-08-20 00:54:55,189 INFO] Step 6600/20000; acc:  86.07; ppl:  1.33; xent: 0.28; lr: 0.00154; 2462/2001 tok/s;   1055 sec
[2020-08-20 00:55:10,776 INFO] Step 6700/20000; acc:  83.40; ppl:  1.42; xent: 0.35; lr: 0.00153; 2528/2046 tok/s;   1071 sec
[2020-08-20 00:55:26,387 INFO] Step 6800/20000; acc:  84.70; ppl:  1.38; xent: 0.32; lr: 0.00152; 2514/2035 tok/s;   1086 sec
[2020-08-20 00:55:36,434 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_6864.pt
[2020-08-20 00:55:42,353 INFO] Step 6900/20000; acc:  85.57; ppl:  1.34; xent: 0.29; lr: 0.00150; 2449/1989 tok/s;   1102 sec
[2020-08-20 00:55:57,930 INFO] Step 7000/20000; acc:  85.08; ppl:  1.35; xent: 0.30; lr: 0.00149; 2526/2063 tok/s;   1118 sec
[2020-08-20 00:55:59,016 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:55:59,093 INFO] number of examples: 9920
[2020-08-20 00:56:13,703 INFO] Step 7100/20000; acc:  85.61; ppl:  1.34; xent: 0.30; lr: 0.00148; 2491/2018 tok/s;   1134 sec
[2020-08-20 00:56:25,563 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_7176.pt
[2020-08-20 00:56:29,967 INFO] Step 7200/20000; acc:  82.20; ppl:  1.46; xent: 0.38; lr: 0.00147; 2418/1962 tok/s;   1150 sec
[2020-08-20 00:56:45,603 INFO] Step 7300/20000; acc:  84.44; ppl:  1.38; xent: 0.32; lr: 0.00146; 2522/2049 tok/s;   1166 sec
[2020-08-20 00:57:01,242 INFO] Step 7400/20000; acc:  85.73; ppl:  1.34; xent: 0.29; lr: 0.00145; 2522/2046 tok/s;   1181 sec
[2020-08-20 00:57:15,026 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_7488.pt
[2020-08-20 00:57:17,325 INFO] Step 7500/20000; acc:  85.38; ppl:  1.35; xent: 0.30; lr: 0.00144; 2429/1974 tok/s;   1197 sec
[2020-08-20 00:57:32,942 INFO] Step 7600/20000; acc:  86.03; ppl:  1.33; xent: 0.28; lr: 0.00143; 2510/2040 tok/s;   1213 sec
[2020-08-20 00:57:48,542 INFO] Step 7700/20000; acc:  85.90; ppl:  1.33; xent: 0.28; lr: 0.00142; 2526/2045 tok/s;   1229 sec
[2020-08-20 00:58:04,211 INFO] Step 7800/20000; acc:  86.09; ppl:  1.33; xent: 0.29; lr: 0.00142; 2505/2028 tok/s;   1244 sec
[2020-08-20 00:58:04,212 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_7800.pt
[2020-08-20 00:58:20,129 INFO] Step 7900/20000; acc:  86.27; ppl:  1.32; xent: 0.28; lr: 0.00141; 2457/1996 tok/s;   1260 sec
[2020-08-20 00:58:35,810 INFO] Step 8000/20000; acc:  80.98; ppl:  1.53; xent: 0.42; lr: 0.00140; 2509/2049 tok/s;   1276 sec
[2020-08-20 00:58:37,054 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 00:58:37,131 INFO] number of examples: 9920
[2020-08-20 00:58:51,570 INFO] Step 8100/20000; acc:  79.17; ppl:  1.56; xent: 0.45; lr: 0.00139; 2492/2018 tok/s;   1292 sec
[2020-08-20 00:58:53,431 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_8112.pt
[2020-08-20 00:59:07,544 INFO] Step 8200/20000; acc:  82.49; ppl:  1.43; xent: 0.36; lr: 0.00138; 2459/1995 tok/s;   1308 sec
[2020-08-20 00:59:23,189 INFO] Step 8300/20000; acc:  83.03; ppl:  1.41; xent: 0.34; lr: 0.00137; 2525/2051 tok/s;   1323 sec
[2020-08-20 00:59:38,824 INFO] Step 8400/20000; acc:  83.28; ppl:  1.41; xent: 0.35; lr: 0.00136; 2521/2045 tok/s;   1339 sec
[2020-08-20 00:59:42,538 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_8424.pt
[2020-08-20 00:59:55,424 INFO] Step 8500/20000; acc:  83.28; ppl:  1.42; xent: 0.35; lr: 0.00136; 2356/1913 tok/s;   1355 sec
[2020-08-20 01:00:11,077 INFO] Step 8600/20000; acc:  83.92; ppl:  1.39; xent: 0.33; lr: 0.00135; 2505/2037 tok/s;   1371 sec
[2020-08-20 01:00:26,682 INFO] Step 8700/20000; acc:  84.79; ppl:  1.36; xent: 0.31; lr: 0.00134; 2519/2039 tok/s;   1387 sec
[2020-08-20 01:00:32,322 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_8736.pt
[2020-08-20 01:00:42,686 INFO] Step 8800/20000; acc:  85.77; ppl:  1.34; xent: 0.29; lr: 0.00133; 2458/1990 tok/s;   1403 sec
[2020-08-20 01:00:58,306 INFO] Step 8900/20000; acc:  85.22; ppl:  1.35; xent: 0.30; lr: 0.00132; 2502/2033 tok/s;   1418 sec
[2020-08-20 01:01:14,014 INFO] Step 9000/20000; acc:  85.35; ppl:  1.34; xent: 0.29; lr: 0.00132; 2503/2043 tok/s;   1434 sec
[2020-08-20 01:01:15,446 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:01:15,525 INFO] number of examples: 9920
[2020-08-20 01:01:21,706 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_9048.pt
[2020-08-20 01:01:30,284 INFO] Step 9100/20000; acc:  85.39; ppl:  1.35; xent: 0.30; lr: 0.00131; 2415/1956 tok/s;   1450 sec
[2020-08-20 01:01:45,950 INFO] Step 9200/20000; acc:  85.56; ppl:  1.33; xent: 0.29; lr: 0.00130; 2508/2035 tok/s;   1466 sec
[2020-08-20 01:02:01,640 INFO] Step 9300/20000; acc:  85.85; ppl:  1.33; xent: 0.28; lr: 0.00130; 2516/2045 tok/s;   1482 sec
[2020-08-20 01:02:11,057 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_9360.pt
[2020-08-20 01:02:17,655 INFO] Step 9400/20000; acc:  86.25; ppl:  1.32; xent: 0.27; lr: 0.00129; 2463/1997 tok/s;   1498 sec
[2020-08-20 01:02:33,286 INFO] Step 9500/20000; acc:  86.26; ppl:  1.31; xent: 0.27; lr: 0.00128; 2501/2032 tok/s;   1513 sec
[2020-08-20 01:02:49,410 INFO] Step 9600/20000; acc:  86.40; ppl:  1.30; xent: 0.26; lr: 0.00128; 2507/2038 tok/s;   1529 sec
[2020-08-20 01:03:00,640 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_9672.pt
[2020-08-20 01:03:05,347 INFO] Step 9700/20000; acc:  86.23; ppl:  1.32; xent: 0.27; lr: 0.00127; 2470/1999 tok/s;   1545 sec
[2020-08-20 01:03:21,055 INFO] Step 9800/20000; acc:  86.65; ppl:  1.30; xent: 0.26; lr: 0.00126; 2501/2024 tok/s;   1561 sec
[2020-08-20 01:03:36,753 INFO] Step 9900/20000; acc:  86.20; ppl:  1.31; xent: 0.27; lr: 0.00126; 2493/2026 tok/s;   1577 sec
[2020-08-20 01:03:49,949 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_9984.pt
[2020-08-20 01:03:52,778 INFO] Step 10000/20000; acc:  86.31; ppl:  1.31; xent: 0.27; lr: 0.00125; 2453/2002 tok/s;   1593 sec
[2020-08-20 01:03:52,779 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 01:03:52,782 INFO] number of examples: 620
[2020-08-20 01:03:53,884 INFO] Validation perplexity: 1.37621
[2020-08-20 01:03:53,885 INFO] Validation accuracy: 87.0247
[2020-08-20 01:03:55,443 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:03:55,522 INFO] number of examples: 9920
[2020-08-20 01:04:09,666 INFO] Step 10100/20000; acc:  85.53; ppl:  1.34; xent: 0.29; lr: 0.00124; 2325/1882 tok/s;   1610 sec
[2020-08-20 01:04:25,318 INFO] Step 10200/20000; acc:  84.69; ppl:  1.37; xent: 0.31; lr: 0.00124; 2515/2042 tok/s;   1625 sec
[2020-08-20 01:04:40,348 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_10296.pt
[2020-08-20 01:04:41,369 INFO] Step 10300/20000; acc:  85.90; ppl:  1.32; xent: 0.28; lr: 0.00123; 2456/1996 tok/s;   1641 sec
[2020-08-20 01:04:56,926 INFO] Step 10400/20000; acc:  86.21; ppl:  1.31; xent: 0.27; lr: 0.00123; 2535/2055 tok/s;   1657 sec
[2020-08-20 01:05:12,611 INFO] Step 10500/20000; acc:  85.85; ppl:  1.32; xent: 0.28; lr: 0.00122; 2492/2025 tok/s;   1673 sec
[2020-08-20 01:05:28,202 INFO] Step 10600/20000; acc:  86.38; ppl:  1.31; xent: 0.27; lr: 0.00121; 2515/2044 tok/s;   1688 sec
[2020-08-20 01:05:29,451 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_10608.pt
[2020-08-20 01:05:44,126 INFO] Step 10700/20000; acc:  82.88; ppl:  1.43; xent: 0.36; lr: 0.00121; 2474/2001 tok/s;   1704 sec
[2020-08-20 01:05:59,762 INFO] Step 10800/20000; acc:  84.01; ppl:  1.39; xent: 0.33; lr: 0.00120; 2510/2033 tok/s;   1720 sec
[2020-08-20 01:06:15,350 INFO] Step 10900/20000; acc:  84.65; ppl:  1.35; xent: 0.30; lr: 0.00120; 2512/2039 tok/s;   1735 sec
[2020-08-20 01:06:18,478 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_10920.pt
[2020-08-20 01:06:31,214 INFO] Step 11000/20000; acc:  85.97; ppl:  1.33; xent: 0.28; lr: 0.00119; 2477/2024 tok/s;   1751 sec
[2020-08-20 01:06:32,938 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:06:33,021 INFO] number of examples: 9920
[2020-08-20 01:06:47,042 INFO] Step 11100/20000; acc:  84.96; ppl:  1.36; xent: 0.31; lr: 0.00119; 2478/2005 tok/s;   1767 sec
[2020-08-20 01:07:02,686 INFO] Step 11200/20000; acc:  86.13; ppl:  1.32; xent: 0.28; lr: 0.00118; 2518/2043 tok/s;   1783 sec
[2020-08-20 01:07:07,673 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_11232.pt
[2020-08-20 01:07:18,544 INFO] Step 11300/20000; acc:  86.22; ppl:  1.31; xent: 0.27; lr: 0.00118; 2485/2020 tok/s;   1799 sec
[2020-08-20 01:07:34,147 INFO] Step 11400/20000; acc:  86.70; ppl:  1.30; xent: 0.26; lr: 0.00117; 2527/2049 tok/s;   1814 sec
[2020-08-20 01:07:49,756 INFO] Step 11500/20000; acc:  86.69; ppl:  1.29; xent: 0.26; lr: 0.00117; 2505/2035 tok/s;   1830 sec
[2020-08-20 01:07:56,659 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_11544.pt
[2020-08-20 01:08:05,807 INFO] Step 11600/20000; acc:  87.21; ppl:  1.28; xent: 0.25; lr: 0.00116; 2447/1989 tok/s;   1846 sec
[2020-08-20 01:08:21,373 INFO] Step 11700/20000; acc:  86.83; ppl:  1.29; xent: 0.26; lr: 0.00116; 2526/2044 tok/s;   1861 sec
[2020-08-20 01:08:36,970 INFO] Step 11800/20000; acc:  86.77; ppl:  1.30; xent: 0.26; lr: 0.00115; 2516/2037 tok/s;   1877 sec
[2020-08-20 01:08:45,713 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_11856.pt
[2020-08-20 01:08:53,731 INFO] Step 11900/20000; acc:  86.03; ppl:  1.32; xent: 0.28; lr: 0.00115; 2339/1900 tok/s;   1894 sec
[2020-08-20 01:09:09,425 INFO] Step 12000/20000; acc:  86.83; ppl:  1.30; xent: 0.27; lr: 0.00114; 2503/2047 tok/s;   1909 sec
[2020-08-20 01:09:11,310 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:09:11,395 INFO] number of examples: 9920
[2020-08-20 01:09:25,237 INFO] Step 12100/20000; acc:  86.70; ppl:  1.30; xent: 0.26; lr: 0.00114; 2483/2007 tok/s;   1925 sec
[2020-08-20 01:09:35,832 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_12168.pt
[2020-08-20 01:09:41,194 INFO] Step 12200/20000; acc:  86.89; ppl:  1.30; xent: 0.26; lr: 0.00113; 2465/2002 tok/s;   1941 sec
[2020-08-20 01:09:56,823 INFO] Step 12300/20000; acc:  86.71; ppl:  1.29; xent: 0.26; lr: 0.00113; 2523/2052 tok/s;   1957 sec
[2020-08-20 01:10:12,457 INFO] Step 12400/20000; acc:  87.37; ppl:  1.28; xent: 0.25; lr: 0.00112; 2520/2042 tok/s;   1972 sec
[2020-08-20 01:10:24,953 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_12480.pt
[2020-08-20 01:10:28,339 INFO] Step 12500/20000; acc:  86.96; ppl:  1.28; xent: 0.25; lr: 0.00112; 2467/2004 tok/s;   1988 sec
[2020-08-20 01:10:43,970 INFO] Step 12600/20000; acc:  87.07; ppl:  1.29; xent: 0.25; lr: 0.00111; 2513/2043 tok/s;   2004 sec
[2020-08-20 01:10:59,561 INFO] Step 12700/20000; acc:  86.54; ppl:  1.30; xent: 0.27; lr: 0.00111; 2518/2038 tok/s;   2020 sec
[2020-08-20 01:11:13,973 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_12792.pt
[2020-08-20 01:11:15,522 INFO] Step 12800/20000; acc:  86.16; ppl:  1.32; xent: 0.28; lr: 0.00110; 2459/1991 tok/s;   2036 sec
[2020-08-20 01:11:31,143 INFO] Step 12900/20000; acc:  86.60; ppl:  1.30; xent: 0.26; lr: 0.00110; 2508/2037 tok/s;   2051 sec
[2020-08-20 01:11:46,760 INFO] Step 13000/20000; acc:  87.02; ppl:  1.29; xent: 0.26; lr: 0.00110; 2516/2057 tok/s;   2067 sec
[2020-08-20 01:11:48,777 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:11:48,861 INFO] number of examples: 9920
[2020-08-20 01:12:02,557 INFO] Step 13100/20000; acc:  85.96; ppl:  1.32; xent: 0.28; lr: 0.00109; 2482/2006 tok/s;   2083 sec
[2020-08-20 01:12:03,183 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_13104.pt
[2020-08-20 01:12:18,432 INFO] Step 13200/20000; acc:  85.30; ppl:  1.35; xent: 0.30; lr: 0.00109; 2483/2015 tok/s;   2098 sec
[2020-08-20 01:12:34,111 INFO] Step 13300/20000; acc:  86.08; ppl:  1.31; xent: 0.27; lr: 0.00108; 2512/2043 tok/s;   2114 sec
[2020-08-20 01:12:49,696 INFO] Step 13400/20000; acc:  86.85; ppl:  1.30; xent: 0.26; lr: 0.00108; 2531/2052 tok/s;   2130 sec
[2020-08-20 01:12:52,205 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_13416.pt
[2020-08-20 01:13:05,719 INFO] Step 13500/20000; acc:  86.19; ppl:  1.32; xent: 0.28; lr: 0.00108; 2446/1987 tok/s;   2146 sec
[2020-08-20 01:13:21,368 INFO] Step 13600/20000; acc:  86.45; ppl:  1.31; xent: 0.27; lr: 0.00107; 2507/2037 tok/s;   2161 sec
[2020-08-20 01:13:36,914 INFO] Step 13700/20000; acc:  86.67; ppl:  1.31; xent: 0.27; lr: 0.00107; 2525/2044 tok/s;   2177 sec
[2020-08-20 01:13:41,334 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_13728.pt
[2020-08-20 01:13:52,873 INFO] Step 13800/20000; acc:  86.89; ppl:  1.30; xent: 0.26; lr: 0.00106; 2462/1994 tok/s;   2193 sec
[2020-08-20 01:14:08,508 INFO] Step 13900/20000; acc:  87.02; ppl:  1.29; xent: 0.25; lr: 0.00106; 2505/2034 tok/s;   2209 sec
[2020-08-20 01:14:24,141 INFO] Step 14000/20000; acc:  87.13; ppl:  1.29; xent: 0.25; lr: 0.00106; 2511/2053 tok/s;   2224 sec
[2020-08-20 01:14:26,330 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:14:26,417 INFO] number of examples: 9920
[2020-08-20 01:14:30,560 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_14040.pt
[2020-08-20 01:14:40,274 INFO] Step 14100/20000; acc:  86.97; ppl:  1.29; xent: 0.25; lr: 0.00105; 2429/1964 tok/s;   2240 sec
[2020-08-20 01:14:55,866 INFO] Step 14200/20000; acc:  87.12; ppl:  1.29; xent: 0.25; lr: 0.00105; 2533/2055 tok/s;   2256 sec
[2020-08-20 01:15:11,522 INFO] Step 14300/20000; acc:  86.99; ppl:  1.28; xent: 0.25; lr: 0.00105; 2513/2046 tok/s;   2272 sec
[2020-08-20 01:15:19,669 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_14352.pt
[2020-08-20 01:15:27,532 INFO] Step 14400/20000; acc:  86.83; ppl:  1.29; xent: 0.26; lr: 0.00104; 2463/1997 tok/s;   2288 sec
[2020-08-20 01:15:43,180 INFO] Step 14500/20000; acc:  85.90; ppl:  1.33; xent: 0.28; lr: 0.00104; 2506/2033 tok/s;   2303 sec
[2020-08-20 01:15:58,788 INFO] Step 14600/20000; acc:  86.18; ppl:  1.31; xent: 0.27; lr: 0.00103; 2515/2045 tok/s;   2319 sec
[2020-08-20 01:16:08,762 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_14664.pt
[2020-08-20 01:16:14,656 INFO] Step 14700/20000; acc:  86.66; ppl:  1.31; xent: 0.27; lr: 0.00103; 2471/2000 tok/s;   2335 sec
[2020-08-20 01:16:30,227 INFO] Step 14800/20000; acc:  86.93; ppl:  1.30; xent: 0.26; lr: 0.00103; 2528/2048 tok/s;   2350 sec
[2020-08-20 01:16:45,848 INFO] Step 14900/20000; acc:  86.88; ppl:  1.29; xent: 0.25; lr: 0.00102; 2506/2035 tok/s;   2366 sec
[2020-08-20 01:16:57,715 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_14976.pt
[2020-08-20 01:17:02,180 INFO] Step 15000/20000; acc:  87.17; ppl:  1.28; xent: 0.25; lr: 0.00102; 2402/1965 tok/s;   2382 sec
[2020-08-20 01:17:04,507 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:17:04,595 INFO] number of examples: 9920
[2020-08-20 01:17:17,931 INFO] Step 15100/20000; acc:  87.01; ppl:  1.29; xent: 0.25; lr: 0.00102; 2487/2011 tok/s;   2398 sec
[2020-08-20 01:17:33,496 INFO] Step 15200/20000; acc:  86.75; ppl:  1.30; xent: 0.26; lr: 0.00101; 2538/2058 tok/s;   2414 sec
[2020-08-20 01:17:47,270 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_15288.pt
[2020-08-20 01:17:49,463 INFO] Step 15300/20000; acc:  86.17; ppl:  1.31; xent: 0.27; lr: 0.00101; 2464/2006 tok/s;   2429 sec
[2020-08-20 01:18:05,071 INFO] Step 15400/20000; acc:  85.82; ppl:  1.33; xent: 0.28; lr: 0.00101; 2525/2049 tok/s;   2445 sec
[2020-08-20 01:18:20,652 INFO] Step 15500/20000; acc:  86.42; ppl:  1.30; xent: 0.27; lr: 0.00100; 2516/2040 tok/s;   2461 sec
[2020-08-20 01:18:36,224 INFO] Step 15600/20000; acc:  87.03; ppl:  1.29; xent: 0.25; lr: 0.00100; 2520/2048 tok/s;   2476 sec
[2020-08-20 01:18:36,226 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_15600.pt
[2020-08-20 01:18:52,212 INFO] Step 15700/20000; acc:  86.84; ppl:  1.29; xent: 0.26; lr: 0.00100; 2455/1986 tok/s;   2492 sec
[2020-08-20 01:19:07,852 INFO] Step 15800/20000; acc:  87.21; ppl:  1.29; xent: 0.25; lr: 0.00099; 2520/2043 tok/s;   2508 sec
[2020-08-20 01:19:23,466 INFO] Step 15900/20000; acc:  87.48; ppl:  1.27; xent: 0.24; lr: 0.00099; 2507/2034 tok/s;   2523 sec
[2020-08-20 01:19:25,339 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_15912.pt
[2020-08-20 01:19:39,433 INFO] Step 16000/20000; acc:  87.72; ppl:  1.27; xent: 0.24; lr: 0.00099; 2452/2006 tok/s;   2539 sec
[2020-08-20 01:19:41,941 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:19:42,030 INFO] number of examples: 9920
[2020-08-20 01:19:55,236 INFO] Step 16100/20000; acc:  87.22; ppl:  1.28; xent: 0.25; lr: 0.00099; 2480/2007 tok/s;   2555 sec
[2020-08-20 01:20:10,835 INFO] Step 16200/20000; acc:  85.82; ppl:  1.33; xent: 0.29; lr: 0.00098; 2532/2052 tok/s;   2571 sec
[2020-08-20 01:20:14,602 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_16224.pt
[2020-08-20 01:20:26,748 INFO] Step 16300/20000; acc:  87.15; ppl:  1.28; xent: 0.25; lr: 0.00098; 2472/2012 tok/s;   2587 sec
[2020-08-20 01:20:42,312 INFO] Step 16400/20000; acc:  87.33; ppl:  1.28; xent: 0.25; lr: 0.00098; 2534/2057 tok/s;   2602 sec
[2020-08-20 01:20:57,928 INFO] Step 16500/20000; acc:  87.19; ppl:  1.28; xent: 0.24; lr: 0.00097; 2507/2033 tok/s;   2618 sec
[2020-08-20 01:21:03,541 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_16536.pt
[2020-08-20 01:21:13,876 INFO] Step 16600/20000; acc:  87.51; ppl:  1.27; xent: 0.24; lr: 0.00097; 2464/2002 tok/s;   2634 sec
[2020-08-20 01:21:29,440 INFO] Step 16700/20000; acc:  87.25; ppl:  1.28; xent: 0.25; lr: 0.00097; 2522/2040 tok/s;   2649 sec
[2020-08-20 01:21:45,057 INFO] Step 16800/20000; acc:  87.20; ppl:  1.28; xent: 0.25; lr: 0.00096; 2526/2048 tok/s;   2665 sec
[2020-08-20 01:21:52,525 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_16848.pt
[2020-08-20 01:22:00,877 INFO] Step 16900/20000; acc:  87.25; ppl:  1.28; xent: 0.25; lr: 0.00096; 2475/2008 tok/s;   2681 sec
[2020-08-20 01:22:16,528 INFO] Step 17000/20000; acc:  87.78; ppl:  1.27; xent: 0.24; lr: 0.00096; 2501/2045 tok/s;   2697 sec
[2020-08-20 01:22:19,157 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:22:19,251 INFO] number of examples: 9920
[2020-08-20 01:22:32,296 INFO] Step 17100/20000; acc:  87.14; ppl:  1.28; xent: 0.25; lr: 0.00096; 2484/2011 tok/s;   2712 sec
[2020-08-20 01:22:41,635 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_17160.pt
[2020-08-20 01:22:48,141 INFO] Step 17200/20000; acc:  86.81; ppl:  1.29; xent: 0.26; lr: 0.00095; 2496/2022 tok/s;   2728 sec
[2020-08-20 01:23:03,769 INFO] Step 17300/20000; acc:  87.34; ppl:  1.28; xent: 0.24; lr: 0.00095; 2511/2043 tok/s;   2744 sec
[2020-08-20 01:23:19,342 INFO] Step 17400/20000; acc:  87.70; ppl:  1.27; xent: 0.24; lr: 0.00095; 2538/2061 tok/s;   2759 sec
[2020-08-20 01:23:30,589 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_17472.pt
[2020-08-20 01:23:35,213 INFO] Step 17500/20000; acc:  87.55; ppl:  1.27; xent: 0.24; lr: 0.00094; 2462/1997 tok/s;   2775 sec
[2020-08-20 01:23:50,811 INFO] Step 17600/20000; acc:  87.52; ppl:  1.27; xent: 0.24; lr: 0.00094; 2522/2050 tok/s;   2791 sec
[2020-08-20 01:24:06,408 INFO] Step 17700/20000; acc:  87.40; ppl:  1.28; xent: 0.24; lr: 0.00094; 2515/2033 tok/s;   2806 sec
[2020-08-20 01:24:19,532 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_17784.pt
[2020-08-20 01:24:22,517 INFO] Step 17800/20000; acc:  87.51; ppl:  1.28; xent: 0.24; lr: 0.00094; 2450/1986 tok/s;   2823 sec
[2020-08-20 01:24:38,139 INFO] Step 17900/20000; acc:  87.47; ppl:  1.27; xent: 0.24; lr: 0.00093; 2506/2034 tok/s;   2838 sec
[2020-08-20 01:24:53,729 INFO] Step 18000/20000; acc:  87.50; ppl:  1.28; xent: 0.25; lr: 0.00093; 2513/2055 tok/s;   2854 sec
[2020-08-20 01:24:56,549 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:24:56,643 INFO] number of examples: 9920
[2020-08-20 01:25:08,908 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_18096.pt
[2020-08-20 01:25:09,809 INFO] Step 18100/20000; acc:  87.33; ppl:  1.28; xent: 0.25; lr: 0.00093; 2431/1971 tok/s;   2870 sec
[2020-08-20 01:25:25,428 INFO] Step 18200/20000; acc:  87.35; ppl:  1.28; xent: 0.25; lr: 0.00093; 2534/2051 tok/s;   2885 sec
[2020-08-20 01:25:41,052 INFO] Step 18300/20000; acc:  87.15; ppl:  1.28; xent: 0.25; lr: 0.00092; 2514/2046 tok/s;   2901 sec
[2020-08-20 01:25:56,620 INFO] Step 18400/20000; acc:  87.54; ppl:  1.27; xent: 0.24; lr: 0.00092; 2536/2060 tok/s;   2917 sec
[2020-08-20 01:25:57,877 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_18408.pt
[2020-08-20 01:26:12,594 INFO] Step 18500/20000; acc:  87.52; ppl:  1.27; xent: 0.24; lr: 0.00092; 2444/1982 tok/s;   2933 sec
[2020-08-20 01:26:28,203 INFO] Step 18600/20000; acc:  87.54; ppl:  1.27; xent: 0.24; lr: 0.00092; 2525/2053 tok/s;   2948 sec
[2020-08-20 01:26:43,852 INFO] Step 18700/20000; acc:  87.46; ppl:  1.27; xent: 0.24; lr: 0.00091; 2501/2022 tok/s;   2964 sec
[2020-08-20 01:26:46,982 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_18720.pt
[2020-08-20 01:26:59,785 INFO] Step 18800/20000; acc:  87.85; ppl:  1.27; xent: 0.24; lr: 0.00091; 2479/2010 tok/s;   2980 sec
[2020-08-20 01:27:15,379 INFO] Step 18900/20000; acc:  85.97; ppl:  1.32; xent: 0.28; lr: 0.00091; 2509/2035 tok/s;   2995 sec
[2020-08-20 01:27:30,992 INFO] Step 19000/20000; acc:  87.53; ppl:  1.28; xent: 0.25; lr: 0.00091; 2509/2051 tok/s;   3011 sec
[2020-08-20 01:27:33,942 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:27:34,023 INFO] number of examples: 9920
[2020-08-20 01:27:36,179 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_19032.pt
[2020-08-20 01:27:48,408 INFO] Step 19100/20000; acc:  87.38; ppl:  1.27; xent: 0.24; lr: 0.00090; 2246/1821 tok/s;   3028 sec
[2020-08-20 01:28:03,988 INFO] Step 19200/20000; acc:  87.21; ppl:  1.29; xent: 0.25; lr: 0.00090; 2544/2059 tok/s;   3044 sec
[2020-08-20 01:28:19,627 INFO] Step 19300/20000; acc:  87.23; ppl:  1.28; xent: 0.24; lr: 0.00090; 2513/2045 tok/s;   3060 sec
[2020-08-20 01:28:26,506 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_19344.pt
[2020-08-20 01:28:35,560 INFO] Step 19400/20000; acc:  87.58; ppl:  1.27; xent: 0.24; lr: 0.00090; 2475/2010 tok/s;   3076 sec
[2020-08-20 01:28:51,185 INFO] Step 19500/20000; acc:  87.45; ppl:  1.27; xent: 0.24; lr: 0.00090; 2497/2025 tok/s;   3091 sec
[2020-08-20 01:29:06,794 INFO] Step 19600/20000; acc:  87.72; ppl:  1.27; xent: 0.24; lr: 0.00089; 2526/2054 tok/s;   3107 sec
[2020-08-20 01:29:15,574 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_19656.pt
[2020-08-20 01:29:22,982 INFO] Step 19700/20000; acc:  87.67; ppl:  1.27; xent: 0.24; lr: 0.00089; 2417/1954 tok/s;   3123 sec
[2020-08-20 01:29:38,589 INFO] Step 19800/20000; acc:  87.69; ppl:  1.27; xent: 0.24; lr: 0.00089; 2532/2054 tok/s;   3139 sec
[2020-08-20 01:29:54,233 INFO] Step 19900/20000; acc:  87.31; ppl:  1.27; xent: 0.24; lr: 0.00089; 2499/2027 tok/s;   3154 sec
[2020-08-20 01:30:04,835 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_19968.pt
[2020-08-20 01:30:10,126 INFO] Step 20000/20000; acc:  87.95; ppl:  1.26; xent: 0.23; lr: 0.00088; 2464/2014 tok/s;   3170 sec
[2020-08-20 01:30:10,126 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 01:30:10,149 INFO] number of examples: 620
[2020-08-20 01:30:11,227 INFO] Validation perplexity: 1.32455
[2020-08-20 01:30:11,227 INFO] Validation accuracy: 88.235
[2020-08-20 01:30:11,229 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv3/toy_model_step_20000.pt
[2020-08-20 01:30:12,773 INFO]  * src vocab size = 20
[2020-08-20 01:30:12,773 INFO]  * tgt vocab size = 20
[2020-08-20 01:30:12,773 INFO] Building model...
[2020-08-20 01:30:14,908 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=256, out_features=20, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-08-20 01:30:14,910 INFO] encoder: 5265920
[2020-08-20 01:30:14,910 INFO] decoder: 6320660
[2020-08-20 01:30:14,910 INFO] * number of parameters: 11586580
[2020-08-20 01:30:14,914 INFO] Starting training on GPU: [0]
[2020-08-20 01:30:14,914 INFO] Start training loop and validate every 10000 steps...
[2020-08-20 01:30:14,914 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:30:14,989 INFO] number of examples: 9920
[2020-08-20 01:30:30,650 INFO] Step 100/20000; acc:  50.46; ppl:  3.55; xent: 1.27; lr: 0.00014; 2500/2025 tok/s;     16 sec
[2020-08-20 01:30:46,016 INFO] Step 200/20000; acc:  73.50; ppl:  1.84; xent: 0.61; lr: 0.00028; 2582/2093 tok/s;     31 sec
[2020-08-20 01:31:01,458 INFO] Step 300/20000; acc:  77.60; ppl:  1.65; xent: 0.50; lr: 0.00042; 2533/2061 tok/s;     47 sec
[2020-08-20 01:31:03,440 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_312.pt
[2020-08-20 01:31:17,371 INFO] Step 400/20000; acc:  80.53; ppl:  1.53; xent: 0.43; lr: 0.00056; 2486/2018 tok/s;     62 sec
[2020-08-20 01:31:32,821 INFO] Step 500/20000; acc:  83.13; ppl:  1.45; xent: 0.37; lr: 0.00070; 2547/2071 tok/s;     78 sec
[2020-08-20 01:31:48,236 INFO] Step 600/20000; acc:  84.21; ppl:  1.42; xent: 0.35; lr: 0.00084; 2526/2049 tok/s;     93 sec
[2020-08-20 01:31:51,949 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_624.pt
[2020-08-20 01:32:03,903 INFO] Step 700/20000; acc:  84.80; ppl:  1.40; xent: 0.33; lr: 0.00098; 2492/2031 tok/s;    109 sec
[2020-08-20 01:32:19,373 INFO] Step 800/20000; acc:  86.22; ppl:  1.35; xent: 0.30; lr: 0.00112; 2529/2048 tok/s;    124 sec
[2020-08-20 01:32:34,743 INFO] Step 900/20000; acc:  85.52; ppl:  1.37; xent: 0.32; lr: 0.00126; 2564/2088 tok/s;    140 sec
[2020-08-20 01:32:40,295 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_936.pt
[2020-08-20 01:32:50,489 INFO] Step 1000/20000; acc:  85.93; ppl:  1.35; xent: 0.30; lr: 0.00140; 2516/2034 tok/s;    156 sec
[2020-08-20 01:32:50,644 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:32:50,733 INFO] number of examples: 9920
[2020-08-20 01:33:05,989 INFO] Step 1100/20000; acc:  85.63; ppl:  1.37; xent: 0.32; lr: 0.00154; 2536/2055 tok/s;    171 sec
[2020-08-20 01:33:21,297 INFO] Step 1200/20000; acc:  86.45; ppl:  1.34; xent: 0.29; lr: 0.00168; 2588/2098 tok/s;    186 sec
[2020-08-20 01:33:28,675 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_1248.pt
[2020-08-20 01:33:36,947 INFO] Step 1300/20000; acc:  86.06; ppl:  1.35; xent: 0.30; lr: 0.00182; 2506/2039 tok/s;    202 sec
[2020-08-20 01:33:52,340 INFO] Step 1400/20000; acc:  85.72; ppl:  1.37; xent: 0.31; lr: 0.00196; 2550/2071 tok/s;    217 sec
[2020-08-20 01:34:07,715 INFO] Step 1500/20000; acc:  85.83; ppl:  1.35; xent: 0.30; lr: 0.00210; 2557/2079 tok/s;    233 sec
[2020-08-20 01:34:16,945 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_1560.pt
[2020-08-20 01:34:23,363 INFO] Step 1600/20000; acc:  84.88; ppl:  1.39; xent: 0.33; lr: 0.00224; 2491/2019 tok/s;    248 sec
[2020-08-20 01:34:38,768 INFO] Step 1700/20000; acc:  84.79; ppl:  1.40; xent: 0.33; lr: 0.00238; 2532/2065 tok/s;    264 sec
[2020-08-20 01:34:54,144 INFO] Step 1800/20000; acc:  84.00; ppl:  1.41; xent: 0.34; lr: 0.00252; 2545/2061 tok/s;    279 sec
[2020-08-20 01:35:05,201 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_1872.pt
[2020-08-20 01:35:09,785 INFO] Step 1900/20000; acc:  83.99; ppl:  1.41; xent: 0.34; lr: 0.00266; 2523/2055 tok/s;    295 sec
[2020-08-20 01:35:25,077 INFO] Step 2000/20000; acc:  82.32; ppl:  1.46; xent: 0.38; lr: 0.00279; 2585/2088 tok/s;    310 sec
[2020-08-20 01:35:25,383 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:35:25,424 INFO] number of examples: 9920
[2020-08-20 01:35:40,552 INFO] Step 2100/20000; acc:  82.85; ppl:  1.46; xent: 0.38; lr: 0.00273; 2541/2060 tok/s;    326 sec
[2020-08-20 01:35:53,367 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_2184.pt
[2020-08-20 01:35:56,138 INFO] Step 2200/20000; acc:  83.77; ppl:  1.42; xent: 0.35; lr: 0.00266; 2542/2058 tok/s;    341 sec
[2020-08-20 01:36:11,395 INFO] Step 2300/20000; acc:  83.61; ppl:  1.41; xent: 0.34; lr: 0.00261; 2573/2095 tok/s;    356 sec
[2020-08-20 01:36:26,594 INFO] Step 2400/20000; acc:  83.78; ppl:  1.41; xent: 0.34; lr: 0.00255; 2584/2098 tok/s;    372 sec
[2020-08-20 01:36:41,120 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_2496.pt
[2020-08-20 01:36:42,062 INFO] Step 2500/20000; acc:  84.54; ppl:  1.38; xent: 0.32; lr: 0.00250; 2541/2067 tok/s;    387 sec
[2020-08-20 01:36:57,216 INFO] Step 2600/20000; acc:  85.25; ppl:  1.36; xent: 0.31; lr: 0.00245; 2575/2087 tok/s;    402 sec
[2020-08-20 01:37:12,330 INFO] Step 2700/20000; acc:  84.94; ppl:  1.37; xent: 0.32; lr: 0.00241; 2578/2102 tok/s;    417 sec
[2020-08-20 01:37:27,468 INFO] Step 2800/20000; acc:  84.21; ppl:  1.39; xent: 0.33; lr: 0.00236; 2583/2092 tok/s;    433 sec
[2020-08-20 01:37:28,672 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_2808.pt
[2020-08-20 01:37:42,924 INFO] Step 2900/20000; acc:  84.30; ppl:  1.39; xent: 0.33; lr: 0.00232; 2557/2083 tok/s;    448 sec
[2020-08-20 01:37:57,994 INFO] Step 3000/20000; acc:  82.10; ppl:  1.47; xent: 0.39; lr: 0.00228; 2616/2113 tok/s;    463 sec
[2020-08-20 01:37:58,457 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:37:58,499 INFO] number of examples: 9920
[2020-08-20 01:38:13,270 INFO] Step 3100/20000; acc:  84.16; ppl:  1.39; xent: 0.33; lr: 0.00224; 2580/2092 tok/s;    478 sec
[2020-08-20 01:38:16,293 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_3120.pt
[2020-08-20 01:38:28,682 INFO] Step 3200/20000; acc:  83.73; ppl:  1.41; xent: 0.34; lr: 0.00221; 2566/2077 tok/s;    494 sec
[2020-08-20 01:38:43,770 INFO] Step 3300/20000; acc:  83.38; ppl:  1.41; xent: 0.35; lr: 0.00218; 2603/2120 tok/s;    509 sec
[2020-08-20 01:38:58,872 INFO] Step 3400/20000; acc:  83.49; ppl:  1.42; xent: 0.35; lr: 0.00214; 2602/2113 tok/s;    524 sec
[2020-08-20 01:39:03,696 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_3432.pt
[2020-08-20 01:39:14,324 INFO] Step 3500/20000; acc:  84.44; ppl:  1.38; xent: 0.32; lr: 0.00211; 2540/2068 tok/s;    539 sec
[2020-08-20 01:39:29,459 INFO] Step 3600/20000; acc:  84.71; ppl:  1.38; xent: 0.32; lr: 0.00208; 2582/2090 tok/s;    555 sec
[2020-08-20 01:39:44,610 INFO] Step 3700/20000; acc:  85.23; ppl:  1.37; xent: 0.31; lr: 0.00205; 2573/2100 tok/s;    570 sec
[2020-08-20 01:39:51,285 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_3744.pt
[2020-08-20 01:40:00,074 INFO] Step 3800/20000; acc:  85.85; ppl:  1.34; xent: 0.30; lr: 0.00203; 2528/2046 tok/s;    585 sec
[2020-08-20 01:40:15,178 INFO] Step 3900/20000; acc:  85.77; ppl:  1.34; xent: 0.29; lr: 0.00200; 2618/2132 tok/s;    600 sec
[2020-08-20 01:40:30,293 INFO] Step 4000/20000; acc:  85.14; ppl:  1.36; xent: 0.31; lr: 0.00198; 2611/2109 tok/s;    615 sec
[2020-08-20 01:40:30,901 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:40:30,943 INFO] number of examples: 9920
[2020-08-20 01:40:38,879 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_4056.pt
[2020-08-20 01:40:45,843 INFO] Step 4100/20000; acc:  83.70; ppl:  1.41; xent: 0.34; lr: 0.00195; 2529/2052 tok/s;    631 sec
[2020-08-20 01:41:00,965 INFO] Step 4200/20000; acc:  81.82; ppl:  1.48; xent: 0.39; lr: 0.00193; 2622/2122 tok/s;    646 sec
[2020-08-20 01:41:16,120 INFO] Step 4300/20000; acc:  83.04; ppl:  1.42; xent: 0.35; lr: 0.00191; 2590/2109 tok/s;    661 sec
[2020-08-20 01:41:26,385 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_4368.pt
[2020-08-20 01:41:31,566 INFO] Step 4400/20000; acc:  84.46; ppl:  1.39; xent: 0.33; lr: 0.00188; 2540/2064 tok/s;    677 sec
[2020-08-20 01:41:46,697 INFO] Step 4500/20000; acc:  84.81; ppl:  1.37; xent: 0.31; lr: 0.00186; 2594/2110 tok/s;    692 sec
[2020-08-20 01:42:01,845 INFO] Step 4600/20000; acc:  84.97; ppl:  1.36; xent: 0.31; lr: 0.00184; 2581/2090 tok/s;    707 sec
[2020-08-20 01:42:13,910 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_4680.pt
[2020-08-20 01:42:17,311 INFO] Step 4700/20000; acc:  84.30; ppl:  1.39; xent: 0.33; lr: 0.00182; 2518/2054 tok/s;    722 sec
[2020-08-20 01:42:32,455 INFO] Step 4800/20000; acc:  85.73; ppl:  1.34; xent: 0.29; lr: 0.00180; 2583/2091 tok/s;    738 sec
[2020-08-20 01:42:47,595 INFO] Step 4900/20000; acc:  85.67; ppl:  1.34; xent: 0.29; lr: 0.00179; 2613/2129 tok/s;    753 sec
[2020-08-20 01:43:01,530 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_4992.pt
[2020-08-20 01:43:03,114 INFO] Step 5000/20000; acc:  85.98; ppl:  1.33; xent: 0.29; lr: 0.00177; 2543/2054 tok/s;    768 sec
[2020-08-20 01:43:03,876 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:43:03,918 INFO] number of examples: 9920
[2020-08-20 01:43:18,381 INFO] Step 5100/20000; acc:  85.23; ppl:  1.36; xent: 0.31; lr: 0.00175; 2576/2090 tok/s;    783 sec
[2020-08-20 01:43:33,477 INFO] Step 5200/20000; acc:  85.23; ppl:  1.35; xent: 0.30; lr: 0.00173; 2627/2125 tok/s;    799 sec
[2020-08-20 01:43:48,606 INFO] Step 5300/20000; acc:  85.83; ppl:  1.33; xent: 0.28; lr: 0.00172; 2593/2111 tok/s;    814 sec
[2020-08-20 01:43:49,210 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_5304.pt
[2020-08-20 01:44:03,980 INFO] Step 5400/20000; acc:  86.05; ppl:  1.33; xent: 0.29; lr: 0.00170; 2552/2073 tok/s;    829 sec
[2020-08-20 01:44:19,091 INFO] Step 5500/20000; acc:  86.85; ppl:  1.30; xent: 0.26; lr: 0.00169; 2597/2113 tok/s;    844 sec
[2020-08-20 01:44:34,230 INFO] Step 5600/20000; acc:  86.69; ppl:  1.30; xent: 0.27; lr: 0.00167; 2585/2092 tok/s;    859 sec
[2020-08-20 01:44:36,667 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_5616.pt
[2020-08-20 01:44:49,718 INFO] Step 5700/20000; acc:  86.23; ppl:  1.33; xent: 0.28; lr: 0.00166; 2515/2052 tok/s;    875 sec
[2020-08-20 01:45:04,807 INFO] Step 5800/20000; acc:  83.95; ppl:  1.41; xent: 0.34; lr: 0.00164; 2590/2096 tok/s;    890 sec
[2020-08-20 01:45:19,929 INFO] Step 5900/20000; acc:  86.27; ppl:  1.32; xent: 0.27; lr: 0.00163; 2617/2132 tok/s;    905 sec
[2020-08-20 01:45:24,150 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_5928.pt
[2020-08-20 01:45:35,374 INFO] Step 6000/20000; acc:  86.51; ppl:  1.31; xent: 0.27; lr: 0.00161; 2556/2065 tok/s;    920 sec
[2020-08-20 01:45:36,280 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:45:36,358 INFO] number of examples: 9920
[2020-08-20 01:45:50,619 INFO] Step 6100/20000; acc:  85.92; ppl:  1.34; xent: 0.29; lr: 0.00160; 2578/2092 tok/s;    936 sec
[2020-08-20 01:46:05,695 INFO] Step 6200/20000; acc:  85.79; ppl:  1.33; xent: 0.28; lr: 0.00159; 2629/2128 tok/s;    951 sec
[2020-08-20 01:46:11,754 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_6240.pt
[2020-08-20 01:46:21,159 INFO] Step 6300/20000; acc:  86.43; ppl:  1.30; xent: 0.27; lr: 0.00157; 2539/2066 tok/s;    966 sec
[2020-08-20 01:46:36,235 INFO] Step 6400/20000; acc:  86.75; ppl:  1.30; xent: 0.26; lr: 0.00156; 2600/2114 tok/s;    981 sec
[2020-08-20 01:46:51,283 INFO] Step 6500/20000; acc:  86.82; ppl:  1.30; xent: 0.26; lr: 0.00155; 2609/2121 tok/s;    996 sec
[2020-08-20 01:46:59,005 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_6552.pt
[2020-08-20 01:47:06,548 INFO] Step 6600/20000; acc:  86.71; ppl:  1.31; xent: 0.27; lr: 0.00154; 2565/2076 tok/s;   1012 sec
[2020-08-20 01:47:21,686 INFO] Step 6700/20000; acc:  86.72; ppl:  1.31; xent: 0.27; lr: 0.00153; 2570/2098 tok/s;   1027 sec
[2020-08-20 01:47:36,693 INFO] Step 6800/20000; acc:  85.74; ppl:  1.34; xent: 0.29; lr: 0.00152; 2605/2109 tok/s;   1042 sec
[2020-08-20 01:47:46,249 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_6864.pt
[2020-08-20 01:47:51,950 INFO] Step 6900/20000; acc:  84.54; ppl:  1.37; xent: 0.31; lr: 0.00150; 2595/2113 tok/s;   1057 sec
[2020-08-20 01:48:06,922 INFO] Step 7000/20000; acc:  84.51; ppl:  1.38; xent: 0.32; lr: 0.00149; 2636/2131 tok/s;   1072 sec
[2020-08-20 01:48:07,966 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:48:08,043 INFO] number of examples: 9920
[2020-08-20 01:48:22,038 INFO] Step 7100/20000; acc:  86.30; ppl:  1.32; xent: 0.28; lr: 0.00148; 2599/2108 tok/s;   1087 sec
[2020-08-20 01:48:33,391 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_7176.pt
[2020-08-20 01:48:37,283 INFO] Step 7200/20000; acc:  86.68; ppl:  1.30; xent: 0.26; lr: 0.00147; 2600/2104 tok/s;   1102 sec
[2020-08-20 01:48:52,219 INFO] Step 7300/20000; acc:  86.76; ppl:  1.30; xent: 0.26; lr: 0.00146; 2628/2140 tok/s;   1117 sec
[2020-08-20 01:49:07,160 INFO] Step 7400/20000; acc:  86.50; ppl:  1.31; xent: 0.27; lr: 0.00145; 2621/2131 tok/s;   1132 sec
[2020-08-20 01:49:20,313 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_7488.pt
[2020-08-20 01:49:22,447 INFO] Step 7500/20000; acc:  86.99; ppl:  1.29; xent: 0.26; lr: 0.00144; 2570/2089 tok/s;   1148 sec
[2020-08-20 01:49:37,391 INFO] Step 7600/20000; acc:  87.06; ppl:  1.30; xent: 0.26; lr: 0.00143; 2621/2123 tok/s;   1162 sec
[2020-08-20 01:49:52,343 INFO] Step 7700/20000; acc:  87.22; ppl:  1.29; xent: 0.26; lr: 0.00142; 2602/2122 tok/s;   1177 sec
[2020-08-20 01:50:07,317 INFO] Step 7800/20000; acc:  87.43; ppl:  1.28; xent: 0.25; lr: 0.00142; 2612/2115 tok/s;   1192 sec
[2020-08-20 01:50:07,318 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_7800.pt
[2020-08-20 01:50:22,658 INFO] Step 7900/20000; acc:  87.36; ppl:  1.28; xent: 0.25; lr: 0.00141; 2580/2101 tok/s;   1208 sec
[2020-08-20 01:50:37,626 INFO] Step 8000/20000; acc:  87.03; ppl:  1.30; xent: 0.26; lr: 0.00140; 2634/2131 tok/s;   1223 sec
[2020-08-20 01:50:38,832 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:50:38,913 INFO] number of examples: 9920
[2020-08-20 01:50:52,741 INFO] Step 8100/20000; acc:  87.18; ppl:  1.29; xent: 0.26; lr: 0.00139; 2602/2109 tok/s;   1238 sec
[2020-08-20 01:50:54,526 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_8112.pt
[2020-08-20 01:51:08,047 INFO] Step 8200/20000; acc:  86.90; ppl:  1.29; xent: 0.26; lr: 0.00138; 2590/2097 tok/s;   1253 sec
[2020-08-20 01:51:23,038 INFO] Step 8300/20000; acc:  86.95; ppl:  1.29; xent: 0.26; lr: 0.00137; 2617/2130 tok/s;   1268 sec
[2020-08-20 01:51:38,008 INFO] Step 8400/20000; acc:  87.46; ppl:  1.28; xent: 0.25; lr: 0.00136; 2617/2129 tok/s;   1283 sec
[2020-08-20 01:51:41,600 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_8424.pt
[2020-08-20 01:51:53,311 INFO] Step 8500/20000; acc:  87.12; ppl:  1.29; xent: 0.25; lr: 0.00136; 2568/2086 tok/s;   1298 sec
[2020-08-20 01:52:08,272 INFO] Step 8600/20000; acc:  86.81; ppl:  1.29; xent: 0.26; lr: 0.00135; 2620/2123 tok/s;   1313 sec
[2020-08-20 01:52:23,246 INFO] Step 8700/20000; acc:  87.21; ppl:  1.29; xent: 0.25; lr: 0.00134; 2597/2117 tok/s;   1328 sec
[2020-08-20 01:52:28,629 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_8736.pt
[2020-08-20 01:52:38,588 INFO] Step 8800/20000; acc:  87.59; ppl:  1.28; xent: 0.24; lr: 0.00133; 2550/2066 tok/s;   1344 sec
[2020-08-20 01:52:53,576 INFO] Step 8900/20000; acc:  87.52; ppl:  1.27; xent: 0.24; lr: 0.00132; 2643/2150 tok/s;   1359 sec
[2020-08-20 01:53:08,582 INFO] Step 9000/20000; acc:  87.46; ppl:  1.28; xent: 0.25; lr: 0.00132; 2624/2123 tok/s;   1374 sec
[2020-08-20 01:53:09,921 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:53:10,003 INFO] number of examples: 9920
[2020-08-20 01:53:15,897 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_9048.pt
[2020-08-20 01:53:23,997 INFO] Step 9100/20000; acc:  85.99; ppl:  1.33; xent: 0.28; lr: 0.00131; 2553/2069 tok/s;   1389 sec
[2020-08-20 01:53:38,898 INFO] Step 9200/20000; acc:  86.44; ppl:  1.31; xent: 0.27; lr: 0.00130; 2656/2150 tok/s;   1404 sec
[2020-08-20 01:53:53,893 INFO] Step 9300/20000; acc:  85.90; ppl:  1.33; xent: 0.28; lr: 0.00130; 2621/2133 tok/s;   1419 sec
[2020-08-20 01:54:02,843 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_9360.pt
[2020-08-20 01:54:09,168 INFO] Step 9400/20000; acc:  86.91; ppl:  1.29; xent: 0.26; lr: 0.00129; 2562/2083 tok/s;   1434 sec
[2020-08-20 01:54:24,123 INFO] Step 9500/20000; acc:  87.00; ppl:  1.29; xent: 0.25; lr: 0.00128; 2630/2136 tok/s;   1449 sec
[2020-08-20 01:54:39,076 INFO] Step 9600/20000; acc:  87.51; ppl:  1.28; xent: 0.24; lr: 0.00128; 2616/2121 tok/s;   1464 sec
[2020-08-20 01:54:49,876 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_9672.pt
[2020-08-20 01:54:54,365 INFO] Step 9700/20000; acc:  87.70; ppl:  1.27; xent: 0.24; lr: 0.00127; 2548/2078 tok/s;   1479 sec
[2020-08-20 01:55:09,356 INFO] Step 9800/20000; acc:  87.56; ppl:  1.27; xent: 0.24; lr: 0.00126; 2606/2111 tok/s;   1494 sec
[2020-08-20 01:55:24,282 INFO] Step 9900/20000; acc:  87.73; ppl:  1.27; xent: 0.24; lr: 0.00126; 2655/2161 tok/s;   1509 sec
[2020-08-20 01:55:36,893 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_9984.pt
[2020-08-20 01:55:39,536 INFO] Step 10000/20000; acc:  87.69; ppl:  1.27; xent: 0.24; lr: 0.00125; 2581/2086 tok/s;   1525 sec
[2020-08-20 01:55:39,537 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 01:55:39,541 INFO] number of examples: 620
[2020-08-20 01:55:40,568 INFO] Validation perplexity: 1.33101
[2020-08-20 01:55:40,569 INFO] Validation accuracy: 88.1442
[2020-08-20 01:55:42,053 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:55:42,135 INFO] number of examples: 9920
[2020-08-20 01:55:55,662 INFO] Step 10100/20000; acc:  87.77; ppl:  1.27; xent: 0.24; lr: 0.00124; 2442/1980 tok/s;   1541 sec
[2020-08-20 01:56:10,587 INFO] Step 10200/20000; acc:  87.37; ppl:  1.27; xent: 0.24; lr: 0.00124; 2650/2145 tok/s;   1556 sec
[2020-08-20 01:56:24,960 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_10296.pt
[2020-08-20 01:56:25,839 INFO] Step 10300/20000; acc:  86.68; ppl:  1.30; xent: 0.26; lr: 0.00123; 2581/2101 tok/s;   1571 sec
[2020-08-20 01:56:40,812 INFO] Step 10400/20000; acc:  87.47; ppl:  1.28; xent: 0.25; lr: 0.00123; 2610/2123 tok/s;   1586 sec
[2020-08-20 01:56:55,719 INFO] Step 10500/20000; acc:  87.54; ppl:  1.27; xent: 0.24; lr: 0.00122; 2639/2143 tok/s;   1601 sec
[2020-08-20 01:57:10,749 INFO] Step 10600/20000; acc:  87.75; ppl:  1.27; xent: 0.24; lr: 0.00121; 2600/2107 tok/s;   1616 sec
[2020-08-20 01:57:11,954 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_10608.pt
[2020-08-20 01:57:26,090 INFO] Step 10700/20000; acc:  87.74; ppl:  1.27; xent: 0.24; lr: 0.00121; 2544/2074 tok/s;   1631 sec
[2020-08-20 01:57:41,071 INFO] Step 10800/20000; acc:  87.75; ppl:  1.26; xent: 0.23; lr: 0.00120; 2609/2115 tok/s;   1646 sec
[2020-08-20 01:57:55,941 INFO] Step 10900/20000; acc:  87.72; ppl:  1.27; xent: 0.24; lr: 0.00120; 2664/2168 tok/s;   1661 sec
[2020-08-20 01:57:58,954 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_10920.pt
[2020-08-20 01:58:13,660 INFO] Step 11000/20000; acc:  87.25; ppl:  1.28; xent: 0.25; lr: 0.00119; 2221/1796 tok/s;   1679 sec
[2020-08-20 01:58:15,308 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 01:58:15,391 INFO] number of examples: 9920
[2020-08-20 01:58:28,807 INFO] Step 11100/20000; acc:  87.43; ppl:  1.29; xent: 0.25; lr: 0.00119; 2600/2108 tok/s;   1694 sec
[2020-08-20 01:58:43,794 INFO] Step 11200/20000; acc:  86.84; ppl:  1.30; xent: 0.26; lr: 0.00118; 2639/2136 tok/s;   1709 sec
[2020-08-20 01:58:48,573 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_11232.pt
[2020-08-20 01:58:59,149 INFO] Step 11300/20000; acc:  86.31; ppl:  1.30; xent: 0.27; lr: 0.00118; 2564/2088 tok/s;   1724 sec
[2020-08-20 01:59:14,151 INFO] Step 11400/20000; acc:  87.29; ppl:  1.28; xent: 0.25; lr: 0.00117; 2607/2120 tok/s;   1739 sec
[2020-08-20 01:59:29,073 INFO] Step 11500/20000; acc:  87.33; ppl:  1.27; xent: 0.24; lr: 0.00117; 2634/2140 tok/s;   1754 sec
[2020-08-20 01:59:35,676 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_11544.pt
[2020-08-20 01:59:44,488 INFO] Step 11600/20000; acc:  87.55; ppl:  1.27; xent: 0.24; lr: 0.00116; 2538/2056 tok/s;   1770 sec
[2020-08-20 01:59:59,534 INFO] Step 11700/20000; acc:  88.03; ppl:  1.26; xent: 0.23; lr: 0.00116; 2593/2114 tok/s;   1785 sec
[2020-08-20 02:00:14,580 INFO] Step 11800/20000; acc:  87.88; ppl:  1.27; xent: 0.24; lr: 0.00115; 2597/2105 tok/s;   1800 sec
[2020-08-20 02:00:22,970 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_11856.pt
[2020-08-20 02:00:30,191 INFO] Step 11900/20000; acc:  87.69; ppl:  1.27; xent: 0.24; lr: 0.00115; 2539/2067 tok/s;   1815 sec
[2020-08-20 02:00:45,236 INFO] Step 12000/20000; acc:  86.04; ppl:  1.33; xent: 0.28; lr: 0.00114; 2612/2112 tok/s;   1830 sec
[2020-08-20 02:00:47,029 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:00:47,115 INFO] number of examples: 9920
[2020-08-20 02:01:00,350 INFO] Step 12100/20000; acc:  86.85; ppl:  1.30; xent: 0.26; lr: 0.00114; 2605/2111 tok/s;   1845 sec
[2020-08-20 02:01:10,564 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_12168.pt
[2020-08-20 02:01:15,622 INFO] Step 12200/20000; acc:  87.19; ppl:  1.28; xent: 0.25; lr: 0.00113; 2594/2099 tok/s;   1861 sec
[2020-08-20 02:01:30,605 INFO] Step 12300/20000; acc:  87.67; ppl:  1.27; xent: 0.24; lr: 0.00113; 2623/2136 tok/s;   1876 sec
[2020-08-20 02:01:45,670 INFO] Step 12400/20000; acc:  87.81; ppl:  1.26; xent: 0.23; lr: 0.00112; 2596/2112 tok/s;   1891 sec
[2020-08-20 02:01:57,672 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_12480.pt
[2020-08-20 02:02:00,936 INFO] Step 12500/20000; acc:  87.75; ppl:  1.26; xent: 0.23; lr: 0.00112; 2575/2092 tok/s;   1906 sec
[2020-08-20 02:02:15,925 INFO] Step 12600/20000; acc:  87.80; ppl:  1.27; xent: 0.24; lr: 0.00111; 2613/2115 tok/s;   1921 sec
[2020-08-20 02:02:30,945 INFO] Step 12700/20000; acc:  87.92; ppl:  1.26; xent: 0.23; lr: 0.00111; 2593/2115 tok/s;   1936 sec
[2020-08-20 02:02:44,809 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_12792.pt
[2020-08-20 02:02:46,342 INFO] Step 12800/20000; acc:  86.71; ppl:  1.30; xent: 0.26; lr: 0.00110; 2541/2059 tok/s;   1951 sec
[2020-08-20 02:03:01,285 INFO] Step 12900/20000; acc:  87.80; ppl:  1.27; xent: 0.24; lr: 0.00110; 2648/2156 tok/s;   1966 sec
[2020-08-20 02:03:16,281 INFO] Step 13000/20000; acc:  87.42; ppl:  1.28; xent: 0.24; lr: 0.00110; 2622/2121 tok/s;   1981 sec
[2020-08-20 02:03:18,221 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:03:18,309 INFO] number of examples: 9920
[2020-08-20 02:03:31,425 INFO] Step 13100/20000; acc:  87.78; ppl:  1.27; xent: 0.24; lr: 0.00109; 2602/2108 tok/s;   1997 sec
[2020-08-20 02:03:32,022 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_13104.pt
[2020-08-20 02:03:46,666 INFO] Step 13200/20000; acc:  87.51; ppl:  1.27; xent: 0.24; lr: 0.00109; 2594/2100 tok/s;   2012 sec
[2020-08-20 02:04:01,612 INFO] Step 13300/20000; acc:  86.80; ppl:  1.29; xent: 0.26; lr: 0.00108; 2635/2145 tok/s;   2027 sec
[2020-08-20 02:04:16,621 INFO] Step 13400/20000; acc:  87.27; ppl:  1.28; xent: 0.24; lr: 0.00108; 2606/2121 tok/s;   2042 sec
[2020-08-20 02:04:19,014 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_13416.pt
[2020-08-20 02:04:31,922 INFO] Step 13500/20000; acc:  87.71; ppl:  1.27; xent: 0.24; lr: 0.00108; 2572/2088 tok/s;   2057 sec
[2020-08-20 02:04:46,870 INFO] Step 13600/20000; acc:  87.83; ppl:  1.27; xent: 0.24; lr: 0.00107; 2616/2118 tok/s;   2072 sec
[2020-08-20 02:05:01,894 INFO] Step 13700/20000; acc:  88.07; ppl:  1.26; xent: 0.23; lr: 0.00107; 2594/2115 tok/s;   2087 sec
[2020-08-20 02:05:06,098 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_13728.pt
[2020-08-20 02:05:17,254 INFO] Step 13800/20000; acc:  87.84; ppl:  1.27; xent: 0.24; lr: 0.00106; 2547/2065 tok/s;   2102 sec
[2020-08-20 02:05:32,243 INFO] Step 13900/20000; acc:  87.83; ppl:  1.26; xent: 0.23; lr: 0.00106; 2639/2149 tok/s;   2117 sec
[2020-08-20 02:05:47,245 INFO] Step 14000/20000; acc:  87.96; ppl:  1.26; xent: 0.23; lr: 0.00106; 2621/2120 tok/s;   2132 sec
[2020-08-20 02:05:49,344 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:05:49,430 INFO] number of examples: 9920
[2020-08-20 02:05:53,385 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_14040.pt
[2020-08-20 02:06:02,615 INFO] Step 14100/20000; acc:  87.91; ppl:  1.26; xent: 0.23; lr: 0.00105; 2565/2080 tok/s;   2148 sec
[2020-08-20 02:06:17,630 INFO] Step 14200/20000; acc:  87.81; ppl:  1.26; xent: 0.23; lr: 0.00105; 2630/2128 tok/s;   2163 sec
[2020-08-20 02:06:32,596 INFO] Step 14300/20000; acc:  87.78; ppl:  1.26; xent: 0.23; lr: 0.00105; 2634/2143 tok/s;   2178 sec
[2020-08-20 02:06:40,404 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_14352.pt
[2020-08-20 02:06:48,001 INFO] Step 14400/20000; acc:  87.82; ppl:  1.26; xent: 0.23; lr: 0.00104; 2539/2066 tok/s;   2193 sec
[2020-08-20 02:07:02,988 INFO] Step 14500/20000; acc:  87.68; ppl:  1.26; xent: 0.23; lr: 0.00104; 2624/2131 tok/s;   2208 sec
[2020-08-20 02:07:17,988 INFO] Step 14600/20000; acc:  88.04; ppl:  1.26; xent: 0.23; lr: 0.00103; 2611/2114 tok/s;   2223 sec
[2020-08-20 02:07:27,597 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_14664.pt
[2020-08-20 02:07:33,254 INFO] Step 14700/20000; acc:  88.00; ppl:  1.26; xent: 0.23; lr: 0.00103; 2553/2081 tok/s;   2238 sec
[2020-08-20 02:07:48,240 INFO] Step 14800/20000; acc:  87.92; ppl:  1.26; xent: 0.23; lr: 0.00103; 2605/2112 tok/s;   2253 sec
[2020-08-20 02:08:03,239 INFO] Step 14900/20000; acc:  88.00; ppl:  1.26; xent: 0.23; lr: 0.00102; 2639/2149 tok/s;   2268 sec
[2020-08-20 02:08:14,666 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_14976.pt
[2020-08-20 02:08:18,826 INFO] Step 15000/20000; acc:  86.91; ppl:  1.29; xent: 0.26; lr: 0.00102; 2522/2041 tok/s;   2284 sec
[2020-08-20 02:08:21,069 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:08:21,221 INFO] number of examples: 9920
[2020-08-20 02:08:34,059 INFO] Step 15100/20000; acc:  86.62; ppl:  1.31; xent: 0.27; lr: 0.00102; 2592/2101 tok/s;   2299 sec
[2020-08-20 02:08:49,012 INFO] Step 15200/20000; acc:  87.45; ppl:  1.28; xent: 0.24; lr: 0.00101; 2637/2133 tok/s;   2314 sec
[2020-08-20 02:09:02,154 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_15288.pt
[2020-08-20 02:09:04,377 INFO] Step 15300/20000; acc:  87.53; ppl:  1.27; xent: 0.24; lr: 0.00101; 2567/2088 tok/s;   2329 sec
[2020-08-20 02:09:19,285 INFO] Step 15400/20000; acc:  87.97; ppl:  1.26; xent: 0.23; lr: 0.00101; 2623/2135 tok/s;   2344 sec
[2020-08-20 02:09:34,230 INFO] Step 15500/20000; acc:  87.72; ppl:  1.27; xent: 0.24; lr: 0.00100; 2629/2136 tok/s;   2359 sec
[2020-08-20 02:09:49,156 INFO] Step 15600/20000; acc:  87.58; ppl:  1.28; xent: 0.24; lr: 0.00100; 2626/2126 tok/s;   2374 sec
[2020-08-20 02:09:49,158 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_15600.pt
[2020-08-20 02:10:04,489 INFO] Step 15700/20000; acc:  88.06; ppl:  1.26; xent: 0.23; lr: 0.00100; 2542/2072 tok/s;   2390 sec
[2020-08-20 02:10:19,487 INFO] Step 15800/20000; acc:  87.91; ppl:  1.26; xent: 0.23; lr: 0.00099; 2604/2110 tok/s;   2405 sec
[2020-08-20 02:10:34,512 INFO] Step 15900/20000; acc:  88.13; ppl:  1.25; xent: 0.23; lr: 0.00099; 2635/2147 tok/s;   2420 sec
[2020-08-20 02:10:36,305 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_15912.pt
[2020-08-20 02:10:49,801 INFO] Step 16000/20000; acc:  87.83; ppl:  1.27; xent: 0.24; lr: 0.00099; 2566/2077 tok/s;   2435 sec
[2020-08-20 02:10:52,203 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:10:52,292 INFO] number of examples: 9920
[2020-08-20 02:11:04,953 INFO] Step 16100/20000; acc:  87.70; ppl:  1.27; xent: 0.24; lr: 0.00099; 2608/2115 tok/s;   2450 sec
[2020-08-20 02:11:19,895 INFO] Step 16200/20000; acc:  87.68; ppl:  1.26; xent: 0.23; lr: 0.00098; 2639/2134 tok/s;   2465 sec
[2020-08-20 02:11:23,485 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_16224.pt
[2020-08-20 02:11:35,330 INFO] Step 16300/20000; acc:  88.02; ppl:  1.26; xent: 0.23; lr: 0.00098; 2556/2079 tok/s;   2480 sec
[2020-08-20 02:11:50,315 INFO] Step 16400/20000; acc:  87.98; ppl:  1.25; xent: 0.23; lr: 0.00098; 2608/2123 tok/s;   2495 sec
[2020-08-20 02:12:05,268 INFO] Step 16500/20000; acc:  87.62; ppl:  1.26; xent: 0.23; lr: 0.00097; 2627/2135 tok/s;   2510 sec
[2020-08-20 02:12:10,635 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_16536.pt
[2020-08-20 02:12:20,530 INFO] Step 16600/20000; acc:  87.75; ppl:  1.26; xent: 0.23; lr: 0.00097; 2573/2083 tok/s;   2526 sec
[2020-08-20 02:12:35,562 INFO] Step 16700/20000; acc:  88.10; ppl:  1.25; xent: 0.23; lr: 0.00097; 2590/2111 tok/s;   2541 sec
[2020-08-20 02:12:50,532 INFO] Step 16800/20000; acc:  87.94; ppl:  1.26; xent: 0.23; lr: 0.00096; 2608/2114 tok/s;   2556 sec
[2020-08-20 02:12:57,676 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_16848.pt
[2020-08-20 02:13:05,831 INFO] Step 16900/20000; acc:  87.32; ppl:  1.28; xent: 0.25; lr: 0.00096; 2588/2107 tok/s;   2571 sec
[2020-08-20 02:13:20,787 INFO] Step 17000/20000; acc:  87.77; ppl:  1.27; xent: 0.24; lr: 0.00096; 2625/2125 tok/s;   2586 sec
[2020-08-20 02:13:23,316 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:13:23,415 INFO] number of examples: 9920
[2020-08-20 02:13:35,924 INFO] Step 17100/20000; acc:  87.92; ppl:  1.27; xent: 0.24; lr: 0.00096; 2609/2116 tok/s;   2601 sec
[2020-08-20 02:13:44,906 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_17160.pt
[2020-08-20 02:13:51,172 INFO] Step 17200/20000; acc:  87.84; ppl:  1.26; xent: 0.23; lr: 0.00095; 2587/2092 tok/s;   2616 sec
[2020-08-20 02:14:06,166 INFO] Step 17300/20000; acc:  87.77; ppl:  1.26; xent: 0.23; lr: 0.00095; 2631/2140 tok/s;   2631 sec
[2020-08-20 02:14:21,198 INFO] Step 17400/20000; acc:  88.22; ppl:  1.25; xent: 0.22; lr: 0.00095; 2600/2116 tok/s;   2646 sec
[2020-08-20 02:14:31,960 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_17472.pt
[2020-08-20 02:14:36,461 INFO] Step 17500/20000; acc:  88.00; ppl:  1.25; xent: 0.22; lr: 0.00094; 2573/2090 tok/s;   2662 sec
[2020-08-20 02:14:51,461 INFO] Step 17600/20000; acc:  87.61; ppl:  1.27; xent: 0.24; lr: 0.00094; 2620/2122 tok/s;   2677 sec
[2020-08-20 02:15:06,425 INFO] Step 17700/20000; acc:  87.46; ppl:  1.28; xent: 0.24; lr: 0.00094; 2599/2118 tok/s;   2692 sec
[2020-08-20 02:15:18,968 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_17784.pt
[2020-08-20 02:15:21,696 INFO] Step 17800/20000; acc:  87.79; ppl:  1.26; xent: 0.23; lr: 0.00094; 2559/2074 tok/s;   2707 sec
[2020-08-20 02:15:36,656 INFO] Step 17900/20000; acc:  88.15; ppl:  1.26; xent: 0.23; lr: 0.00093; 2646/2155 tok/s;   2722 sec
[2020-08-20 02:15:51,609 INFO] Step 18000/20000; acc:  88.20; ppl:  1.25; xent: 0.23; lr: 0.00093; 2627/2126 tok/s;   2737 sec
[2020-08-20 02:15:54,325 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:15:54,417 INFO] number of examples: 9920
[2020-08-20 02:16:06,145 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_18096.pt
[2020-08-20 02:16:07,207 INFO] Step 18100/20000; acc:  88.26; ppl:  1.26; xent: 0.23; lr: 0.00093; 2530/2051 tok/s;   2752 sec
[2020-08-20 02:16:22,198 INFO] Step 18200/20000; acc:  87.98; ppl:  1.25; xent: 0.22; lr: 0.00093; 2633/2129 tok/s;   2767 sec
[2020-08-20 02:16:37,123 INFO] Step 18300/20000; acc:  88.19; ppl:  1.25; xent: 0.22; lr: 0.00092; 2643/2149 tok/s;   2782 sec
[2020-08-20 02:16:55,598 INFO] Step 18400/20000; acc:  88.06; ppl:  1.25; xent: 0.23; lr: 0.00092; 2613/2128 tok/s;   2801 sec
[2020-08-20 02:16:56,798 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_18408.pt
[2020-08-20 02:17:10,949 INFO] Step 18500/20000; acc:  88.20; ppl:  1.25; xent: 0.23; lr: 0.00092; 2556/2075 tok/s;   2816 sec
[2020-08-20 02:17:25,891 INFO] Step 18600/20000; acc:  88.26; ppl:  1.25; xent: 0.23; lr: 0.00092; 2633/2134 tok/s;   2831 sec
[2020-08-20 02:17:40,890 INFO] Step 18700/20000; acc:  87.81; ppl:  1.27; xent: 0.24; lr: 0.00091; 2591/2111 tok/s;   2846 sec
[2020-08-20 02:17:43,865 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_18720.pt
[2020-08-20 02:17:56,078 INFO] Step 18800/20000; acc:  87.29; ppl:  1.29; xent: 0.25; lr: 0.00091; 2576/2088 tok/s;   2861 sec
[2020-08-20 02:18:11,043 INFO] Step 18900/20000; acc:  88.14; ppl:  1.26; xent: 0.23; lr: 0.00091; 2640/2150 tok/s;   2876 sec
[2020-08-20 02:18:25,981 INFO] Step 19000/20000; acc:  88.17; ppl:  1.26; xent: 0.23; lr: 0.00091; 2632/2130 tok/s;   2891 sec
[2020-08-20 02:18:28,828 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:18:28,872 INFO] number of examples: 9920
[2020-08-20 02:18:30,929 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_19032.pt
[2020-08-20 02:18:41,725 INFO] Step 19100/20000; acc:  87.96; ppl:  1.26; xent: 0.23; lr: 0.00090; 2508/2033 tok/s;   2907 sec
[2020-08-20 02:18:56,722 INFO] Step 19200/20000; acc:  88.01; ppl:  1.25; xent: 0.23; lr: 0.00090; 2629/2126 tok/s;   2922 sec
[2020-08-20 02:19:11,670 INFO] Step 19300/20000; acc:  88.23; ppl:  1.25; xent: 0.22; lr: 0.00090; 2642/2148 tok/s;   2937 sec
[2020-08-20 02:19:18,270 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_19344.pt
[2020-08-20 02:19:27,492 INFO] Step 19400/20000; acc:  88.34; ppl:  1.25; xent: 0.22; lr: 0.00090; 2472/2013 tok/s;   2953 sec
[2020-08-20 02:19:42,493 INFO] Step 19500/20000; acc:  88.37; ppl:  1.25; xent: 0.22; lr: 0.00090; 2614/2123 tok/s;   2968 sec
[2020-08-20 02:19:57,452 INFO] Step 19600/20000; acc:  88.52; ppl:  1.25; xent: 0.22; lr: 0.00089; 2631/2131 tok/s;   2983 sec
[2020-08-20 02:20:05,903 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_19656.pt
[2020-08-20 02:20:12,722 INFO] Step 19700/20000; acc:  88.49; ppl:  1.24; xent: 0.22; lr: 0.00089; 2546/2075 tok/s;   2998 sec
[2020-08-20 02:20:27,722 INFO] Step 19800/20000; acc:  88.30; ppl:  1.25; xent: 0.22; lr: 0.00089; 2607/2113 tok/s;   3013 sec
[2020-08-20 02:20:42,634 INFO] Step 19900/20000; acc:  88.59; ppl:  1.25; xent: 0.22; lr: 0.00089; 2647/2156 tok/s;   3028 sec
[2020-08-20 02:20:52,846 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_19968.pt
[2020-08-20 02:20:57,923 INFO] Step 20000/20000; acc:  88.35; ppl:  1.25; xent: 0.22; lr: 0.00088; 2572/2081 tok/s;   3043 sec
[2020-08-20 02:20:57,924 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 02:20:57,944 INFO] number of examples: 620
[2020-08-20 02:20:58,969 INFO] Validation perplexity: 1.30145
[2020-08-20 02:20:58,969 INFO] Validation accuracy: 89.0419
[2020-08-20 02:20:58,971 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv4/toy_model_step_20000.pt
[2020-08-20 02:21:00,418 INFO]  * src vocab size = 20
[2020-08-20 02:21:00,418 INFO]  * tgt vocab size = 20
[2020-08-20 02:21:00,418 INFO] Building model...
[2020-08-20 02:21:02,549 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=256, out_features=20, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-08-20 02:21:02,551 INFO] encoder: 5265920
[2020-08-20 02:21:02,551 INFO] decoder: 6320660
[2020-08-20 02:21:02,551 INFO] * number of parameters: 11586580
[2020-08-20 02:21:02,555 INFO] Starting training on GPU: [0]
[2020-08-20 02:21:02,556 INFO] Start training loop and validate every 10000 steps...
[2020-08-20 02:21:02,556 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:21:02,629 INFO] number of examples: 9920
[2020-08-20 02:21:18,746 INFO] Step 100/20000; acc:  52.20; ppl:  3.61; xent: 1.28; lr: 0.00014; 2401/1955 tok/s;     16 sec
[2020-08-20 02:21:34,587 INFO] Step 200/20000; acc:  73.16; ppl:  1.85; xent: 0.62; lr: 0.00028; 2484/2020 tok/s;     32 sec
[2020-08-20 02:21:50,397 INFO] Step 300/20000; acc:  77.94; ppl:  1.64; xent: 0.50; lr: 0.00042; 2520/2039 tok/s;     48 sec
[2020-08-20 02:21:52,289 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_312.pt
[2020-08-20 02:22:06,604 INFO] Step 400/20000; acc:  81.80; ppl:  1.49; xent: 0.40; lr: 0.00056; 2444/1987 tok/s;     64 sec
[2020-08-20 02:22:22,463 INFO] Step 500/20000; acc:  82.65; ppl:  1.47; xent: 0.39; lr: 0.00070; 2474/2010 tok/s;     80 sec
[2020-08-20 02:22:38,320 INFO] Step 600/20000; acc:  84.59; ppl:  1.40; xent: 0.34; lr: 0.00084; 2474/2005 tok/s;     96 sec
[2020-08-20 02:22:42,094 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_624.pt
[2020-08-20 02:22:54,473 INFO] Step 700/20000; acc:  85.07; ppl:  1.40; xent: 0.33; lr: 0.00098; 2449/1991 tok/s;    112 sec
[2020-08-20 02:23:10,311 INFO] Step 800/20000; acc:  86.05; ppl:  1.35; xent: 0.30; lr: 0.00112; 2457/1989 tok/s;    128 sec
[2020-08-20 02:23:26,217 INFO] Step 900/20000; acc:  86.14; ppl:  1.35; xent: 0.30; lr: 0.00126; 2469/2009 tok/s;    144 sec
[2020-08-20 02:23:31,909 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_936.pt
[2020-08-20 02:23:42,421 INFO] Step 1000/20000; acc:  86.29; ppl:  1.35; xent: 0.30; lr: 0.00140; 2409/1951 tok/s;    160 sec
[2020-08-20 02:23:42,579 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:23:42,668 INFO] number of examples: 9920
[2020-08-20 02:23:58,418 INFO] Step 1100/20000; acc:  86.72; ppl:  1.34; xent: 0.29; lr: 0.00154; 2427/1975 tok/s;    176 sec
[2020-08-20 02:24:14,282 INFO] Step 1200/20000; acc:  86.12; ppl:  1.35; xent: 0.30; lr: 0.00168; 2479/2018 tok/s;    192 sec
[2020-08-20 02:24:21,867 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_1248.pt
[2020-08-20 02:24:30,493 INFO] Step 1300/20000; acc:  85.95; ppl:  1.35; xent: 0.30; lr: 0.00182; 2460/1990 tok/s;    208 sec
[2020-08-20 02:24:46,313 INFO] Step 1400/20000; acc:  86.35; ppl:  1.34; xent: 0.29; lr: 0.00196; 2503/2034 tok/s;    224 sec
[2020-08-20 02:25:02,176 INFO] Step 1500/20000; acc:  85.78; ppl:  1.36; xent: 0.31; lr: 0.00210; 2471/2008 tok/s;    240 sec
[2020-08-20 02:25:11,641 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_1560.pt
[2020-08-20 02:25:18,327 INFO] Step 1600/20000; acc:  85.20; ppl:  1.38; xent: 0.32; lr: 0.00224; 2430/1970 tok/s;    256 sec
[2020-08-20 02:25:34,124 INFO] Step 1700/20000; acc:  84.61; ppl:  1.39; xent: 0.33; lr: 0.00238; 2500/2032 tok/s;    272 sec
[2020-08-20 02:25:49,958 INFO] Step 1800/20000; acc:  83.41; ppl:  1.43; xent: 0.35; lr: 0.00252; 2465/1995 tok/s;    287 sec
[2020-08-20 02:26:01,345 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_1872.pt
[2020-08-20 02:26:06,172 INFO] Step 1900/20000; acc:  83.74; ppl:  1.42; xent: 0.35; lr: 0.00266; 2420/1968 tok/s;    304 sec
[2020-08-20 02:26:22,017 INFO] Step 2000/20000; acc:  84.06; ppl:  1.40; xent: 0.34; lr: 0.00279; 2463/1997 tok/s;    319 sec
[2020-08-20 02:26:22,337 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:26:22,378 INFO] number of examples: 9920
[2020-08-20 02:26:38,061 INFO] Step 2100/20000; acc:  83.78; ppl:  1.42; xent: 0.35; lr: 0.00273; 2419/1967 tok/s;    336 sec
[2020-08-20 02:26:51,375 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_2184.pt
[2020-08-20 02:26:54,757 INFO] Step 2200/20000; acc:  83.19; ppl:  1.43; xent: 0.36; lr: 0.00266; 2357/1918 tok/s;    352 sec
[2020-08-20 02:27:10,538 INFO] Step 2300/20000; acc:  84.37; ppl:  1.39; xent: 0.33; lr: 0.00261; 2527/2043 tok/s;    368 sec
[2020-08-20 02:27:26,564 INFO] Step 2400/20000; acc:  85.01; ppl:  1.37; xent: 0.31; lr: 0.00255; 2491/2025 tok/s;    384 sec
[2020-08-20 02:27:41,737 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_2496.pt
[2020-08-20 02:27:42,719 INFO] Step 2500/20000; acc:  84.81; ppl:  1.38; xent: 0.32; lr: 0.00250; 2430/1975 tok/s;    400 sec
[2020-08-20 02:27:58,504 INFO] Step 2600/20000; acc:  85.65; ppl:  1.35; xent: 0.30; lr: 0.00245; 2484/2015 tok/s;    416 sec
[2020-08-20 02:28:14,219 INFO] Step 2700/20000; acc:  84.90; ppl:  1.37; xent: 0.31; lr: 0.00241; 2512/2041 tok/s;    432 sec
[2020-08-20 02:28:29,876 INFO] Step 2800/20000; acc:  84.55; ppl:  1.38; xent: 0.32; lr: 0.00236; 2495/2021 tok/s;    447 sec
[2020-08-20 02:28:31,125 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_2808.pt
[2020-08-20 02:28:45,885 INFO] Step 2900/20000; acc:  84.63; ppl:  1.38; xent: 0.32; lr: 0.00232; 2447/1990 tok/s;    463 sec
[2020-08-20 02:29:01,547 INFO] Step 3000/20000; acc:  84.67; ppl:  1.37; xent: 0.32; lr: 0.00228; 2493/2021 tok/s;    479 sec
[2020-08-20 02:29:02,015 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:29:02,057 INFO] number of examples: 9920
[2020-08-20 02:29:17,364 INFO] Step 3100/20000; acc:  82.27; ppl:  1.47; xent: 0.39; lr: 0.00224; 2454/1996 tok/s;    495 sec
[2020-08-20 02:29:20,510 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_3120.pt
[2020-08-20 02:29:33,375 INFO] Step 3200/20000; acc:  83.04; ppl:  1.44; xent: 0.36; lr: 0.00221; 2457/2000 tok/s;    511 sec
[2020-08-20 02:29:48,972 INFO] Step 3300/20000; acc:  84.86; ppl:  1.37; xent: 0.32; lr: 0.00218; 2555/2067 tok/s;    526 sec
[2020-08-20 02:30:04,583 INFO] Step 3400/20000; acc:  84.72; ppl:  1.37; xent: 0.31; lr: 0.00214; 2539/2063 tok/s;    542 sec
[2020-08-20 02:30:09,581 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_3432.pt
[2020-08-20 02:30:20,376 INFO] Step 3500/20000; acc:  85.23; ppl:  1.36; xent: 0.31; lr: 0.00211; 2488/2022 tok/s;    558 sec
[2020-08-20 02:30:35,950 INFO] Step 3600/20000; acc:  84.81; ppl:  1.36; xent: 0.31; lr: 0.00208; 2515/2040 tok/s;    573 sec
[2020-08-20 02:30:51,530 INFO] Step 3700/20000; acc:  85.68; ppl:  1.35; xent: 0.30; lr: 0.00205; 2536/2060 tok/s;    589 sec
[2020-08-20 02:30:58,386 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_3744.pt
[2020-08-20 02:31:07,381 INFO] Step 3800/20000; acc:  85.86; ppl:  1.34; xent: 0.29; lr: 0.00203; 2460/1991 tok/s;    605 sec
[2020-08-20 02:31:22,979 INFO] Step 3900/20000; acc:  86.78; ppl:  1.31; xent: 0.27; lr: 0.00200; 2514/2044 tok/s;    620 sec
[2020-08-20 02:31:38,538 INFO] Step 4000/20000; acc:  84.61; ppl:  1.37; xent: 0.32; lr: 0.00198; 2511/2035 tok/s;    636 sec
[2020-08-20 02:31:39,159 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:31:39,202 INFO] number of examples: 9920
[2020-08-20 02:31:47,412 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_4056.pt
[2020-08-20 02:31:54,556 INFO] Step 4100/20000; acc:  80.86; ppl:  1.52; xent: 0.42; lr: 0.00195; 2420/1968 tok/s;    652 sec
[2020-08-20 02:32:10,166 INFO] Step 4200/20000; acc:  83.37; ppl:  1.43; xent: 0.36; lr: 0.00193; 2521/2053 tok/s;    668 sec
[2020-08-20 02:32:26,338 INFO] Step 4300/20000; acc:  84.16; ppl:  1.39; xent: 0.33; lr: 0.00191; 2568/2076 tok/s;    684 sec
[2020-08-20 02:32:36,977 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_4368.pt
[2020-08-20 02:32:42,302 INFO] Step 4400/20000; acc:  85.91; ppl:  1.33; xent: 0.29; lr: 0.00188; 2478/2014 tok/s;    700 sec
[2020-08-20 02:32:57,878 INFO] Step 4500/20000; acc:  84.80; ppl:  1.37; xent: 0.31; lr: 0.00186; 2525/2052 tok/s;    715 sec
[2020-08-20 02:33:13,468 INFO] Step 4600/20000; acc:  82.17; ppl:  1.47; xent: 0.38; lr: 0.00184; 2510/2038 tok/s;    731 sec
[2020-08-20 02:33:25,932 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_4680.pt
[2020-08-20 02:33:29,383 INFO] Step 4700/20000; acc:  84.48; ppl:  1.38; xent: 0.32; lr: 0.00182; 2487/2019 tok/s;    747 sec
[2020-08-20 02:33:44,942 INFO] Step 4800/20000; acc:  85.41; ppl:  1.35; xent: 0.30; lr: 0.00180; 2506/2029 tok/s;    762 sec
[2020-08-20 02:34:00,511 INFO] Step 4900/20000; acc:  85.45; ppl:  1.34; xent: 0.30; lr: 0.00179; 2519/2048 tok/s;    778 sec
[2020-08-20 02:34:14,889 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_4992.pt
[2020-08-20 02:34:16,465 INFO] Step 5000/20000; acc:  83.64; ppl:  1.40; xent: 0.34; lr: 0.00177; 2446/1981 tok/s;    794 sec
[2020-08-20 02:34:17,249 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:34:17,292 INFO] number of examples: 9920
[2020-08-20 02:34:32,174 INFO] Step 5100/20000; acc:  84.58; ppl:  1.37; xent: 0.32; lr: 0.00175; 2467/2007 tok/s;    810 sec
[2020-08-20 02:34:47,822 INFO] Step 5200/20000; acc:  85.56; ppl:  1.34; xent: 0.29; lr: 0.00173; 2523/2055 tok/s;    825 sec
[2020-08-20 02:35:03,407 INFO] Step 5300/20000; acc:  85.11; ppl:  1.35; xent: 0.30; lr: 0.00172; 2561/2071 tok/s;    841 sec
[2020-08-20 02:35:04,036 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_5304.pt
[2020-08-20 02:35:19,283 INFO] Step 5400/20000; acc:  86.22; ppl:  1.31; xent: 0.27; lr: 0.00170; 2494/2028 tok/s;    857 sec
[2020-08-20 02:35:34,849 INFO] Step 5500/20000; acc:  86.30; ppl:  1.32; xent: 0.28; lr: 0.00169; 2525/2051 tok/s;    872 sec
[2020-08-20 02:35:50,419 INFO] Step 5600/20000; acc:  86.82; ppl:  1.30; xent: 0.26; lr: 0.00167; 2517/2043 tok/s;    888 sec
[2020-08-20 02:35:52,917 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_5616.pt
[2020-08-20 02:36:06,241 INFO] Step 5700/20000; acc:  85.64; ppl:  1.34; xent: 0.29; lr: 0.00166; 2496/2027 tok/s;    904 sec
[2020-08-20 02:36:21,757 INFO] Step 5800/20000; acc:  85.34; ppl:  1.35; xent: 0.30; lr: 0.00164; 2512/2035 tok/s;    919 sec
[2020-08-20 02:36:37,337 INFO] Step 5900/20000; acc:  85.89; ppl:  1.33; xent: 0.29; lr: 0.00163; 2519/2047 tok/s;    935 sec
[2020-08-20 02:36:41,706 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_5928.pt
[2020-08-20 02:36:53,147 INFO] Step 6000/20000; acc:  85.58; ppl:  1.33; xent: 0.29; lr: 0.00161; 2469/2000 tok/s;    951 sec
[2020-08-20 02:36:54,083 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:36:54,158 INFO] number of examples: 9920
[2020-08-20 02:37:08,880 INFO] Step 6100/20000; acc:  85.54; ppl:  1.34; xent: 0.29; lr: 0.00160; 2465/2006 tok/s;    966 sec
[2020-08-20 02:37:24,424 INFO] Step 6200/20000; acc:  86.21; ppl:  1.32; xent: 0.28; lr: 0.00159; 2533/2063 tok/s;    982 sec
[2020-08-20 02:37:30,637 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_6240.pt
[2020-08-20 02:37:40,768 INFO] Step 6300/20000; acc:  84.78; ppl:  1.37; xent: 0.31; lr: 0.00157; 2442/1974 tok/s;    998 sec
[2020-08-20 02:37:56,368 INFO] Step 6400/20000; acc:  84.54; ppl:  1.37; xent: 0.32; lr: 0.00156; 2537/2062 tok/s;   1014 sec
[2020-08-20 02:38:11,929 INFO] Step 6500/20000; acc:  85.32; ppl:  1.35; xent: 0.30; lr: 0.00155; 2523/2049 tok/s;   1029 sec
[2020-08-20 02:38:20,025 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_6552.pt
[2020-08-20 02:38:29,840 INFO] Step 6600/20000; acc:  85.58; ppl:  1.33; xent: 0.29; lr: 0.00154; 2191/1779 tok/s;   1047 sec
[2020-08-20 02:38:45,465 INFO] Step 6700/20000; acc:  85.09; ppl:  1.36; xent: 0.30; lr: 0.00153; 2528/2053 tok/s;   1063 sec
[2020-08-20 02:39:01,037 INFO] Step 6800/20000; acc:  83.93; ppl:  1.40; xent: 0.33; lr: 0.00152; 2500/2025 tok/s;   1078 sec
[2020-08-20 02:39:10,988 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_6864.pt
[2020-08-20 02:39:17,140 INFO] Step 6900/20000; acc:  82.77; ppl:  1.44; xent: 0.37; lr: 0.00150; 2437/1980 tok/s;   1095 sec
[2020-08-20 02:39:32,738 INFO] Step 7000/20000; acc:  84.52; ppl:  1.37; xent: 0.32; lr: 0.00149; 2500/2025 tok/s;   1110 sec
[2020-08-20 02:39:33,828 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:39:33,904 INFO] number of examples: 9920
[2020-08-20 02:39:48,467 INFO] Step 7100/20000; acc:  85.96; ppl:  1.33; xent: 0.28; lr: 0.00148; 2467/2007 tok/s;   1126 sec
[2020-08-20 02:40:00,258 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_7176.pt
[2020-08-20 02:40:04,285 INFO] Step 7200/20000; acc:  85.50; ppl:  1.33; xent: 0.29; lr: 0.00147; 2490/2028 tok/s;   1142 sec
[2020-08-20 02:40:19,716 INFO] Step 7300/20000; acc:  86.10; ppl:  1.32; xent: 0.28; lr: 0.00146; 2585/2090 tok/s;   1157 sec
[2020-08-20 02:40:34,896 INFO] Step 7400/20000; acc:  86.17; ppl:  1.32; xent: 0.27; lr: 0.00145; 2608/2119 tok/s;   1172 sec
[2020-08-20 02:40:48,379 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_7488.pt
[2020-08-20 02:40:50,630 INFO] Step 7500/20000; acc:  86.05; ppl:  1.32; xent: 0.28; lr: 0.00144; 2498/2030 tok/s;   1188 sec
[2020-08-20 02:41:06,047 INFO] Step 7600/20000; acc:  85.51; ppl:  1.33; xent: 0.29; lr: 0.00143; 2547/2066 tok/s;   1203 sec
[2020-08-20 02:41:21,453 INFO] Step 7700/20000; acc:  86.12; ppl:  1.32; xent: 0.28; lr: 0.00142; 2562/2080 tok/s;   1219 sec
[2020-08-20 02:41:36,925 INFO] Step 7800/20000; acc:  86.13; ppl:  1.32; xent: 0.28; lr: 0.00142; 2516/2039 tok/s;   1234 sec
[2020-08-20 02:41:36,926 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_7800.pt
[2020-08-20 02:41:52,674 INFO] Step 7900/20000; acc:  86.10; ppl:  1.32; xent: 0.28; lr: 0.00141; 2491/2024 tok/s;   1250 sec
[2020-08-20 02:42:08,132 INFO] Step 8000/20000; acc:  86.21; ppl:  1.31; xent: 0.27; lr: 0.00140; 2520/2042 tok/s;   1266 sec
[2020-08-20 02:42:09,357 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:42:09,438 INFO] number of examples: 9920
[2020-08-20 02:42:23,766 INFO] Step 8100/20000; acc:  86.53; ppl:  1.30; xent: 0.26; lr: 0.00139; 2485/2021 tok/s;   1281 sec
[2020-08-20 02:42:25,632 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_8112.pt
[2020-08-20 02:42:39,521 INFO] Step 8200/20000; acc:  86.01; ppl:  1.33; xent: 0.28; lr: 0.00138; 2501/2038 tok/s;   1297 sec
[2020-08-20 02:42:54,977 INFO] Step 8300/20000; acc:  86.48; ppl:  1.31; xent: 0.27; lr: 0.00137; 2581/2087 tok/s;   1312 sec
[2020-08-20 02:43:10,452 INFO] Step 8400/20000; acc:  86.20; ppl:  1.32; xent: 0.28; lr: 0.00136; 2556/2076 tok/s;   1328 sec
[2020-08-20 02:43:14,178 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_8424.pt
[2020-08-20 02:43:26,157 INFO] Step 8500/20000; acc:  85.56; ppl:  1.35; xent: 0.30; lr: 0.00136; 2503/2036 tok/s;   1344 sec
[2020-08-20 02:43:41,571 INFO] Step 8600/20000; acc:  86.15; ppl:  1.32; xent: 0.28; lr: 0.00135; 2549/2067 tok/s;   1359 sec
[2020-08-20 02:43:56,987 INFO] Step 8700/20000; acc:  84.67; ppl:  1.37; xent: 0.31; lr: 0.00134; 2558/2076 tok/s;   1374 sec
[2020-08-20 02:44:02,574 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_8736.pt
[2020-08-20 02:44:12,782 INFO] Step 8800/20000; acc:  85.95; ppl:  1.33; xent: 0.29; lr: 0.00133; 2464/1997 tok/s;   1390 sec
[2020-08-20 02:44:28,240 INFO] Step 8900/20000; acc:  86.67; ppl:  1.30; xent: 0.26; lr: 0.00132; 2539/2064 tok/s;   1406 sec
[2020-08-20 02:44:43,671 INFO] Step 9000/20000; acc:  85.37; ppl:  1.34; xent: 0.29; lr: 0.00132; 2525/2047 tok/s;   1421 sec
[2020-08-20 02:44:45,078 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:44:45,163 INFO] number of examples: 9920
[2020-08-20 02:44:51,287 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_9048.pt
[2020-08-20 02:44:59,662 INFO] Step 9100/20000; acc:  86.68; ppl:  1.30; xent: 0.26; lr: 0.00131; 2431/1975 tok/s;   1437 sec
[2020-08-20 02:45:15,075 INFO] Step 9200/20000; acc:  86.74; ppl:  1.30; xent: 0.26; lr: 0.00130; 2556/2084 tok/s;   1453 sec
[2020-08-20 02:45:30,469 INFO] Step 9300/20000; acc:  86.88; ppl:  1.29; xent: 0.26; lr: 0.00130; 2589/2094 tok/s;   1468 sec
[2020-08-20 02:45:39,717 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_9360.pt
[2020-08-20 02:45:46,332 INFO] Step 9400/20000; acc:  87.01; ppl:  1.29; xent: 0.25; lr: 0.00129; 2490/2021 tok/s;   1484 sec
[2020-08-20 02:46:01,793 INFO] Step 9500/20000; acc:  86.54; ppl:  1.29; xent: 0.26; lr: 0.00128; 2548/2074 tok/s;   1499 sec
[2020-08-20 02:46:17,204 INFO] Step 9600/20000; acc:  86.46; ppl:  1.31; xent: 0.27; lr: 0.00128; 2550/2067 tok/s;   1515 sec
[2020-08-20 02:46:28,295 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_9672.pt
[2020-08-20 02:46:32,970 INFO] Step 9700/20000; acc:  86.72; ppl:  1.30; xent: 0.26; lr: 0.00127; 2498/2028 tok/s;   1530 sec
[2020-08-20 02:46:48,369 INFO] Step 9800/20000; acc:  87.00; ppl:  1.29; xent: 0.26; lr: 0.00126; 2531/2050 tok/s;   1546 sec
[2020-08-20 02:47:03,819 INFO] Step 9900/20000; acc:  87.29; ppl:  1.28; xent: 0.25; lr: 0.00126; 2537/2061 tok/s;   1561 sec
[2020-08-20 02:47:16,811 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_9984.pt
[2020-08-20 02:47:19,558 INFO] Step 10000/20000; acc:  86.95; ppl:  1.28; xent: 0.25; lr: 0.00125; 2481/2011 tok/s;   1577 sec
[2020-08-20 02:47:19,559 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 02:47:19,563 INFO] number of examples: 620
[2020-08-20 02:47:20,616 INFO] Validation perplexity: 1.32561
[2020-08-20 02:47:20,616 INFO] Validation accuracy: 88.4115
[2020-08-20 02:47:22,165 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:47:22,246 INFO] number of examples: 9920
[2020-08-20 02:47:36,227 INFO] Step 10100/20000; acc:  87.29; ppl:  1.28; xent: 0.24; lr: 0.00124; 2328/1892 tok/s;   1594 sec
[2020-08-20 02:47:51,628 INFO] Step 10200/20000; acc:  86.58; ppl:  1.31; xent: 0.27; lr: 0.00124; 2564/2090 tok/s;   1609 sec
[2020-08-20 02:48:06,385 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_10296.pt
[2020-08-20 02:48:07,251 INFO] Step 10300/20000; acc:  86.54; ppl:  1.30; xent: 0.26; lr: 0.00123; 2553/2064 tok/s;   1625 sec
[2020-08-20 02:48:22,655 INFO] Step 10400/20000; acc:  85.97; ppl:  1.32; xent: 0.27; lr: 0.00123; 2559/2078 tok/s;   1640 sec
[2020-08-20 02:48:38,096 INFO] Step 10500/20000; acc:  86.39; ppl:  1.30; xent: 0.26; lr: 0.00122; 2552/2076 tok/s;   1656 sec
[2020-08-20 02:48:53,585 INFO] Step 10600/20000; acc:  86.77; ppl:  1.29; xent: 0.25; lr: 0.00121; 2539/2058 tok/s;   1671 sec
[2020-08-20 02:48:54,821 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_10608.pt
[2020-08-20 02:49:09,418 INFO] Step 10700/20000; acc:  86.97; ppl:  1.29; xent: 0.26; lr: 0.00121; 2489/2022 tok/s;   1687 sec
[2020-08-20 02:49:24,936 INFO] Step 10800/20000; acc:  87.29; ppl:  1.29; xent: 0.25; lr: 0.00120; 2507/2030 tok/s;   1702 sec
[2020-08-20 02:49:40,355 INFO] Step 10900/20000; acc:  87.05; ppl:  1.29; xent: 0.25; lr: 0.00120; 2544/2069 tok/s;   1718 sec
[2020-08-20 02:49:43,468 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_10920.pt
[2020-08-20 02:49:56,436 INFO] Step 11000/20000; acc:  87.14; ppl:  1.28; xent: 0.25; lr: 0.00119; 2428/1967 tok/s;   1734 sec
[2020-08-20 02:49:58,126 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:49:58,214 INFO] number of examples: 9920
[2020-08-20 02:50:12,010 INFO] Step 11100/20000; acc:  87.31; ppl:  1.27; xent: 0.24; lr: 0.00119; 2492/2027 tok/s;   1749 sec
[2020-08-20 02:50:27,429 INFO] Step 11200/20000; acc:  87.28; ppl:  1.28; xent: 0.25; lr: 0.00118; 2559/2085 tok/s;   1765 sec
[2020-08-20 02:50:32,327 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_11232.pt
[2020-08-20 02:50:43,156 INFO] Step 11300/20000; acc:  86.21; ppl:  1.32; xent: 0.27; lr: 0.00118; 2533/2048 tok/s;   1781 sec
[2020-08-20 02:50:58,586 INFO] Step 11400/20000; acc:  87.21; ppl:  1.28; xent: 0.25; lr: 0.00117; 2554/2073 tok/s;   1796 sec
[2020-08-20 02:51:14,007 INFO] Step 11500/20000; acc:  87.06; ppl:  1.28; xent: 0.25; lr: 0.00117; 2558/2081 tok/s;   1811 sec
[2020-08-20 02:51:20,776 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_11544.pt
[2020-08-20 02:51:29,835 INFO] Step 11600/20000; acc:  87.51; ppl:  1.27; xent: 0.24; lr: 0.00116; 2485/2015 tok/s;   1827 sec
[2020-08-20 02:51:45,261 INFO] Step 11700/20000; acc:  87.39; ppl:  1.28; xent: 0.25; lr: 0.00116; 2553/2074 tok/s;   1843 sec
[2020-08-20 02:52:00,695 INFO] Step 11800/20000; acc:  87.23; ppl:  1.29; xent: 0.25; lr: 0.00115; 2521/2041 tok/s;   1858 sec
[2020-08-20 02:52:09,333 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_11856.pt
[2020-08-20 02:52:16,427 INFO] Step 11900/20000; acc:  87.39; ppl:  1.28; xent: 0.25; lr: 0.00115; 2492/2028 tok/s;   1874 sec
[2020-08-20 02:52:31,840 INFO] Step 12000/20000; acc:  86.88; ppl:  1.28; xent: 0.25; lr: 0.00114; 2538/2054 tok/s;   1889 sec
[2020-08-20 02:52:33,703 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:52:33,785 INFO] number of examples: 9920
[2020-08-20 02:52:47,426 INFO] Step 12100/20000; acc:  87.41; ppl:  1.27; xent: 0.24; lr: 0.00114; 2488/2024 tok/s;   1905 sec
[2020-08-20 02:52:57,935 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_12168.pt
[2020-08-20 02:53:03,202 INFO] Step 12200/20000; acc:  87.45; ppl:  1.27; xent: 0.24; lr: 0.00113; 2502/2039 tok/s;   1921 sec
[2020-08-20 02:53:18,608 INFO] Step 12300/20000; acc:  87.45; ppl:  1.27; xent: 0.24; lr: 0.00113; 2583/2089 tok/s;   1936 sec
[2020-08-20 02:53:34,027 INFO] Step 12400/20000; acc:  87.59; ppl:  1.27; xent: 0.24; lr: 0.00112; 2556/2076 tok/s;   1951 sec
[2020-08-20 02:53:46,373 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_12480.pt
[2020-08-20 02:53:49,826 INFO] Step 12500/20000; acc:  86.70; ppl:  1.30; xent: 0.26; lr: 0.00112; 2497/2030 tok/s;   1967 sec
[2020-08-20 02:54:05,236 INFO] Step 12600/20000; acc:  87.60; ppl:  1.27; xent: 0.24; lr: 0.00111; 2553/2070 tok/s;   1983 sec
[2020-08-20 02:54:20,688 INFO] Step 12700/20000; acc:  87.46; ppl:  1.27; xent: 0.24; lr: 0.00111; 2549/2071 tok/s;   1998 sec
[2020-08-20 02:54:34,880 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_12792.pt
[2020-08-20 02:54:36,378 INFO] Step 12800/20000; acc:  87.59; ppl:  1.27; xent: 0.24; lr: 0.00110; 2478/2005 tok/s;   2014 sec
[2020-08-20 02:54:51,828 INFO] Step 12900/20000; acc:  87.61; ppl:  1.27; xent: 0.24; lr: 0.00110; 2538/2065 tok/s;   2029 sec
[2020-08-20 02:55:07,302 INFO] Step 13000/20000; acc:  86.71; ppl:  1.29; xent: 0.25; lr: 0.00110; 2530/2048 tok/s;   2045 sec
[2020-08-20 02:55:09,305 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:55:09,392 INFO] number of examples: 9920
[2020-08-20 02:55:22,865 INFO] Step 13100/20000; acc:  87.15; ppl:  1.28; xent: 0.25; lr: 0.00109; 2490/2025 tok/s;   2060 sec
[2020-08-20 02:55:23,487 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_13104.pt
[2020-08-20 02:55:39,534 INFO] Step 13200/20000; acc:  87.17; ppl:  1.28; xent: 0.25; lr: 0.00109; 2371/1933 tok/s;   2077 sec
[2020-08-20 02:55:54,918 INFO] Step 13300/20000; acc:  86.98; ppl:  1.28; xent: 0.25; lr: 0.00108; 2585/2090 tok/s;   2092 sec
[2020-08-20 02:56:10,318 INFO] Step 13400/20000; acc:  87.44; ppl:  1.27; xent: 0.24; lr: 0.00108; 2560/2079 tok/s;   2108 sec
[2020-08-20 02:56:12,792 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_13416.pt
[2020-08-20 02:56:26,171 INFO] Step 13500/20000; acc:  87.19; ppl:  1.27; xent: 0.24; lr: 0.00108; 2487/2022 tok/s;   2124 sec
[2020-08-20 02:56:41,611 INFO] Step 13600/20000; acc:  87.05; ppl:  1.29; xent: 0.25; lr: 0.00107; 2549/2067 tok/s;   2139 sec
[2020-08-20 02:56:57,089 INFO] Step 13700/20000; acc:  86.93; ppl:  1.29; xent: 0.26; lr: 0.00107; 2545/2067 tok/s;   2155 sec
[2020-08-20 02:57:01,438 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_13728.pt
[2020-08-20 02:57:13,734 INFO] Step 13800/20000; acc:  87.46; ppl:  1.28; xent: 0.25; lr: 0.00106; 2336/1891 tok/s;   2171 sec
[2020-08-20 02:57:29,157 INFO] Step 13900/20000; acc:  87.42; ppl:  1.28; xent: 0.25; lr: 0.00106; 2540/2067 tok/s;   2187 sec
[2020-08-20 02:57:44,637 INFO] Step 14000/20000; acc:  87.08; ppl:  1.28; xent: 0.25; lr: 0.00106; 2528/2047 tok/s;   2202 sec
[2020-08-20 02:57:46,809 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 02:57:46,898 INFO] number of examples: 9920
[2020-08-20 02:57:50,979 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_14040.pt
[2020-08-20 02:58:00,627 INFO] Step 14100/20000; acc:  86.59; ppl:  1.30; xent: 0.26; lr: 0.00105; 2425/1972 tok/s;   2218 sec
[2020-08-20 02:58:16,076 INFO] Step 14200/20000; acc:  87.13; ppl:  1.28; xent: 0.24; lr: 0.00105; 2557/2083 tok/s;   2234 sec
[2020-08-20 02:58:31,484 INFO] Step 14300/20000; acc:  87.21; ppl:  1.28; xent: 0.24; lr: 0.00105; 2581/2087 tok/s;   2249 sec
[2020-08-20 02:58:39,505 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_14352.pt
[2020-08-20 02:58:47,513 INFO] Step 14400/20000; acc:  87.68; ppl:  1.26; xent: 0.23; lr: 0.00104; 2462/2000 tok/s;   2265 sec
[2020-08-20 02:59:02,952 INFO] Step 14500/20000; acc:  87.53; ppl:  1.27; xent: 0.24; lr: 0.00104; 2551/2074 tok/s;   2280 sec
[2020-08-20 02:59:18,401 INFO] Step 14600/20000; acc:  87.62; ppl:  1.27; xent: 0.24; lr: 0.00103; 2549/2067 tok/s;   2296 sec
[2020-08-20 02:59:28,250 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_14664.pt
[2020-08-20 02:59:34,106 INFO] Step 14700/20000; acc:  87.80; ppl:  1.26; xent: 0.24; lr: 0.00103; 2509/2038 tok/s;   2312 sec
[2020-08-20 02:59:49,492 INFO] Step 14800/20000; acc:  88.09; ppl:  1.26; xent: 0.23; lr: 0.00103; 2527/2046 tok/s;   2327 sec
[2020-08-20 03:00:04,954 INFO] Step 14900/20000; acc:  88.00; ppl:  1.26; xent: 0.23; lr: 0.00102; 2532/2059 tok/s;   2342 sec
[2020-08-20 03:00:16,707 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_14976.pt
[2020-08-20 03:00:21,218 INFO] Step 15000/20000; acc:  87.13; ppl:  1.27; xent: 0.24; lr: 0.00102; 2407/1950 tok/s;   2359 sec
[2020-08-20 03:00:23,548 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:00:23,636 INFO] number of examples: 9920
[2020-08-20 03:00:36,848 INFO] Step 15100/20000; acc:  87.14; ppl:  1.28; xent: 0.25; lr: 0.00102; 2484/2018 tok/s;   2374 sec
[2020-08-20 03:00:52,301 INFO] Step 15200/20000; acc:  87.60; ppl:  1.27; xent: 0.24; lr: 0.00101; 2551/2078 tok/s;   2390 sec
[2020-08-20 03:01:05,925 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_15288.pt
[2020-08-20 03:01:08,100 INFO] Step 15300/20000; acc:  87.72; ppl:  1.27; xent: 0.24; lr: 0.00101; 2518/2037 tok/s;   2406 sec
[2020-08-20 03:01:23,553 INFO] Step 15400/20000; acc:  87.80; ppl:  1.26; xent: 0.23; lr: 0.00101; 2560/2080 tok/s;   2421 sec
[2020-08-20 03:01:39,024 INFO] Step 15500/20000; acc:  87.60; ppl:  1.27; xent: 0.24; lr: 0.00100; 2542/2065 tok/s;   2436 sec
[2020-08-20 03:01:54,520 INFO] Step 15600/20000; acc:  87.38; ppl:  1.27; xent: 0.24; lr: 0.00100; 2544/2064 tok/s;   2452 sec
[2020-08-20 03:01:54,521 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_15600.pt
[2020-08-20 03:02:10,279 INFO] Step 15700/20000; acc:  87.67; ppl:  1.26; xent: 0.23; lr: 0.00100; 2498/2029 tok/s;   2468 sec
[2020-08-20 03:02:25,789 INFO] Step 15800/20000; acc:  87.72; ppl:  1.27; xent: 0.24; lr: 0.00099; 2510/2030 tok/s;   2483 sec
[2020-08-20 03:02:41,283 INFO] Step 15900/20000; acc:  87.79; ppl:  1.26; xent: 0.24; lr: 0.00099; 2528/2057 tok/s;   2499 sec
[2020-08-20 03:02:43,144 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_15912.pt
[2020-08-20 03:02:57,130 INFO] Step 16000/20000; acc:  87.51; ppl:  1.26; xent: 0.23; lr: 0.00099; 2470/2002 tok/s;   2515 sec
[2020-08-20 03:02:59,614 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:02:59,703 INFO] number of examples: 9920
[2020-08-20 03:03:12,785 INFO] Step 16100/20000; acc:  87.89; ppl:  1.26; xent: 0.23; lr: 0.00099; 2477/2012 tok/s;   2530 sec
[2020-08-20 03:03:28,224 INFO] Step 16200/20000; acc:  87.58; ppl:  1.27; xent: 0.24; lr: 0.00098; 2551/2078 tok/s;   2546 sec
[2020-08-20 03:03:31,933 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_16224.pt
[2020-08-20 03:03:44,030 INFO] Step 16300/20000; acc:  87.67; ppl:  1.26; xent: 0.23; lr: 0.00098; 2520/2039 tok/s;   2561 sec
[2020-08-20 03:03:59,492 INFO] Step 16400/20000; acc:  87.87; ppl:  1.26; xent: 0.23; lr: 0.00098; 2559/2079 tok/s;   2577 sec
[2020-08-20 03:04:14,944 INFO] Step 16500/20000; acc:  87.05; ppl:  1.28; xent: 0.25; lr: 0.00097; 2545/2068 tok/s;   2592 sec
[2020-08-20 03:04:20,513 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_16536.pt
[2020-08-20 03:04:30,794 INFO] Step 16600/20000; acc:  87.42; ppl:  1.27; xent: 0.24; lr: 0.00097; 2485/2015 tok/s;   2608 sec
[2020-08-20 03:04:46,253 INFO] Step 16700/20000; acc:  87.74; ppl:  1.27; xent: 0.24; lr: 0.00097; 2546/2069 tok/s;   2624 sec
[2020-08-20 03:05:01,720 INFO] Step 16800/20000; acc:  87.68; ppl:  1.27; xent: 0.24; lr: 0.00096; 2518/2037 tok/s;   2639 sec
[2020-08-20 03:05:09,132 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_16848.pt
[2020-08-20 03:05:17,450 INFO] Step 16900/20000; acc:  87.75; ppl:  1.27; xent: 0.24; lr: 0.00096; 2491/2027 tok/s;   2655 sec
[2020-08-20 03:05:32,905 INFO] Step 17000/20000; acc:  86.33; ppl:  1.30; xent: 0.26; lr: 0.00096; 2532/2052 tok/s;   2670 sec
[2020-08-20 03:05:35,533 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:05:35,623 INFO] number of examples: 9920
[2020-08-20 03:05:48,415 INFO] Step 17100/20000; acc:  87.47; ppl:  1.27; xent: 0.24; lr: 0.00096; 2497/2027 tok/s;   2686 sec
[2020-08-20 03:05:57,680 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_17160.pt
[2020-08-20 03:06:04,225 INFO] Step 17200/20000; acc:  87.48; ppl:  1.27; xent: 0.24; lr: 0.00095; 2496/2034 tok/s;   2702 sec
[2020-08-20 03:06:19,629 INFO] Step 17300/20000; acc:  87.14; ppl:  1.29; xent: 0.25; lr: 0.00095; 2584/2091 tok/s;   2717 sec
[2020-08-20 03:06:35,025 INFO] Step 17400/20000; acc:  87.37; ppl:  1.28; xent: 0.25; lr: 0.00095; 2568/2086 tok/s;   2732 sec
[2020-08-20 03:06:46,152 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_17472.pt
[2020-08-20 03:06:50,837 INFO] Step 17500/20000; acc:  87.57; ppl:  1.28; xent: 0.24; lr: 0.00094; 2488/2022 tok/s;   2748 sec
[2020-08-20 03:07:06,253 INFO] Step 17600/20000; acc:  87.73; ppl:  1.26; xent: 0.23; lr: 0.00094; 2553/2070 tok/s;   2764 sec
[2020-08-20 03:07:21,733 INFO] Step 17700/20000; acc:  87.74; ppl:  1.27; xent: 0.24; lr: 0.00094; 2544/2068 tok/s;   2779 sec
[2020-08-20 03:07:34,710 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_17784.pt
[2020-08-20 03:07:37,492 INFO] Step 17800/20000; acc:  88.02; ppl:  1.26; xent: 0.23; lr: 0.00094; 2473/2000 tok/s;   2795 sec
[2020-08-20 03:07:52,919 INFO] Step 17900/20000; acc:  88.17; ppl:  1.26; xent: 0.23; lr: 0.00093; 2540/2066 tok/s;   2810 sec
[2020-08-20 03:08:08,390 INFO] Step 18000/20000; acc:  87.67; ppl:  1.26; xent: 0.23; lr: 0.00093; 2526/2050 tok/s;   2826 sec
[2020-08-20 03:08:11,174 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:08:11,320 INFO] number of examples: 9920
[2020-08-20 03:08:23,426 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_18096.pt
[2020-08-20 03:08:24,354 INFO] Step 18100/20000; acc:  88.10; ppl:  1.25; xent: 0.22; lr: 0.00093; 2428/1971 tok/s;   2842 sec
[2020-08-20 03:08:39,764 INFO] Step 18200/20000; acc:  87.94; ppl:  1.26; xent: 0.23; lr: 0.00093; 2558/2084 tok/s;   2857 sec
[2020-08-20 03:08:55,213 INFO] Step 18300/20000; acc:  87.50; ppl:  1.27; xent: 0.24; lr: 0.00092; 2575/2083 tok/s;   2873 sec
[2020-08-20 03:09:10,634 INFO] Step 18400/20000; acc:  87.88; ppl:  1.26; xent: 0.24; lr: 0.00092; 2565/2084 tok/s;   2888 sec
[2020-08-20 03:09:11,876 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_18408.pt
[2020-08-20 03:09:26,424 INFO] Step 18500/20000; acc:  87.73; ppl:  1.26; xent: 0.23; lr: 0.00092; 2495/2028 tok/s;   2904 sec
[2020-08-20 03:09:41,872 INFO] Step 18600/20000; acc:  87.22; ppl:  1.28; xent: 0.25; lr: 0.00092; 2549/2066 tok/s;   2919 sec
[2020-08-20 03:09:57,280 INFO] Step 18700/20000; acc:  87.95; ppl:  1.26; xent: 0.23; lr: 0.00091; 2554/2077 tok/s;   2935 sec
[2020-08-20 03:10:00,357 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_18720.pt
[2020-08-20 03:10:13,008 INFO] Step 18800/20000; acc:  88.08; ppl:  1.26; xent: 0.23; lr: 0.00091; 2478/2003 tok/s;   2950 sec
[2020-08-20 03:10:28,431 INFO] Step 18900/20000; acc:  88.01; ppl:  1.26; xent: 0.23; lr: 0.00091; 2538/2065 tok/s;   2966 sec
[2020-08-20 03:10:43,913 INFO] Step 19000/20000; acc:  87.63; ppl:  1.26; xent: 0.23; lr: 0.00091; 2524/2046 tok/s;   2981 sec
[2020-08-20 03:10:46,858 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:10:46,902 INFO] number of examples: 9920
[2020-08-20 03:10:49,031 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_19032.pt
[2020-08-20 03:10:59,979 INFO] Step 19100/20000; acc:  87.88; ppl:  1.26; xent: 0.23; lr: 0.00090; 2417/1963 tok/s;   2997 sec
[2020-08-20 03:11:15,420 INFO] Step 19200/20000; acc:  87.77; ppl:  1.27; xent: 0.24; lr: 0.00090; 2550/2078 tok/s;   3013 sec
[2020-08-20 03:11:30,853 INFO] Step 19300/20000; acc:  87.66; ppl:  1.26; xent: 0.23; lr: 0.00090; 2578/2085 tok/s;   3028 sec
[2020-08-20 03:11:37,641 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_19344.pt
[2020-08-20 03:11:46,613 INFO] Step 19400/20000; acc:  88.07; ppl:  1.26; xent: 0.23; lr: 0.00090; 2511/2039 tok/s;   3044 sec
[2020-08-20 03:12:02,039 INFO] Step 19500/20000; acc:  87.89; ppl:  1.26; xent: 0.23; lr: 0.00090; 2550/2073 tok/s;   3059 sec
[2020-08-20 03:12:17,506 INFO] Step 19600/20000; acc:  87.68; ppl:  1.26; xent: 0.23; lr: 0.00089; 2547/2065 tok/s;   3075 sec
[2020-08-20 03:12:26,183 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_19656.pt
[2020-08-20 03:12:33,237 INFO] Step 19700/20000; acc:  87.91; ppl:  1.26; xent: 0.23; lr: 0.00089; 2504/2037 tok/s;   3091 sec
[2020-08-20 03:12:48,674 INFO] Step 19800/20000; acc:  88.17; ppl:  1.25; xent: 0.23; lr: 0.00089; 2525/2041 tok/s;   3106 sec
[2020-08-20 03:13:04,131 INFO] Step 19900/20000; acc:  88.04; ppl:  1.26; xent: 0.23; lr: 0.00089; 2530/2059 tok/s;   3122 sec
[2020-08-20 03:13:14,663 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_19968.pt
[2020-08-20 03:13:19,934 INFO] Step 20000/20000; acc:  87.51; ppl:  1.26; xent: 0.23; lr: 0.00088; 2474/2006 tok/s;   3137 sec
[2020-08-20 03:13:19,935 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 03:13:19,958 INFO] number of examples: 620
[2020-08-20 03:13:21,025 INFO] Validation perplexity: 1.33012
[2020-08-20 03:13:21,025 INFO] Validation accuracy: 88.3157
[2020-08-20 03:13:21,027 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv5/toy_model_step_20000.pt
[2020-08-20 03:13:23,420 INFO]  * src vocab size = 20
[2020-08-20 03:13:23,420 INFO]  * tgt vocab size = 20
[2020-08-20 03:13:23,420 INFO] Building model...
[2020-08-20 03:13:25,549 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=256, out_features=20, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-08-20 03:13:25,551 INFO] encoder: 5265920
[2020-08-20 03:13:25,551 INFO] decoder: 6320660
[2020-08-20 03:13:25,551 INFO] * number of parameters: 11586580
[2020-08-20 03:13:25,556 INFO] Starting training on GPU: [0]
[2020-08-20 03:13:25,556 INFO] Start training loop and validate every 10000 steps...
[2020-08-20 03:13:25,556 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:13:25,634 INFO] number of examples: 9920
[2020-08-20 03:13:40,768 INFO] Step 100/20000; acc:  53.71; ppl:  3.37; xent: 1.22; lr: 0.00014; 2601/2111 tok/s;     15 sec
[2020-08-20 03:13:55,683 INFO] Step 200/20000; acc:  73.96; ppl:  1.81; xent: 0.59; lr: 0.00028; 2638/2138 tok/s;     30 sec
[2020-08-20 03:14:10,580 INFO] Step 300/20000; acc:  77.91; ppl:  1.63; xent: 0.49; lr: 0.00042; 2619/2126 tok/s;     45 sec
[2020-08-20 03:14:12,361 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_312.pt
[2020-08-20 03:14:25,898 INFO] Step 400/20000; acc:  80.77; ppl:  1.53; xent: 0.42; lr: 0.00056; 2570/2080 tok/s;     60 sec
[2020-08-20 03:14:40,831 INFO] Step 500/20000; acc:  82.90; ppl:  1.45; xent: 0.37; lr: 0.00070; 2637/2144 tok/s;     75 sec
[2020-08-20 03:14:55,845 INFO] Step 600/20000; acc:  84.28; ppl:  1.41; xent: 0.35; lr: 0.00084; 2627/2136 tok/s;     90 sec
[2020-08-20 03:14:59,366 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_624.pt
[2020-08-20 03:15:10,775 INFO] Step 700/20000; acc:  85.31; ppl:  1.38; xent: 0.32; lr: 0.00098; 2642/2144 tok/s;    105 sec
[2020-08-20 03:15:25,389 INFO] Step 800/20000; acc:  85.72; ppl:  1.37; xent: 0.31; lr: 0.00112; 2669/2171 tok/s;    120 sec
[2020-08-20 03:15:39,948 INFO] Step 900/20000; acc:  86.55; ppl:  1.34; xent: 0.29; lr: 0.00126; 2684/2177 tok/s;    134 sec
[2020-08-20 03:15:45,190 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_936.pt
[2020-08-20 03:15:54,737 INFO] Step 1000/20000; acc:  85.57; ppl:  1.37; xent: 0.31; lr: 0.00140; 2654/2158 tok/s;    149 sec
[2020-08-20 03:15:54,881 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:15:54,966 INFO] number of examples: 9920
[2020-08-20 03:16:09,424 INFO] Step 1100/20000; acc:  86.09; ppl:  1.35; xent: 0.30; lr: 0.00154; 2691/2184 tok/s;    164 sec
[2020-08-20 03:16:23,884 INFO] Step 1200/20000; acc:  85.89; ppl:  1.35; xent: 0.30; lr: 0.00168; 2719/2204 tok/s;    178 sec
[2020-08-20 03:16:30,847 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_1248.pt
[2020-08-20 03:16:38,732 INFO] Step 1300/20000; acc:  85.58; ppl:  1.36; xent: 0.31; lr: 0.00182; 2630/2134 tok/s;    193 sec
[2020-08-20 03:16:53,283 INFO] Step 1400/20000; acc:  85.44; ppl:  1.36; xent: 0.31; lr: 0.00196; 2707/2190 tok/s;    208 sec
[2020-08-20 03:17:07,810 INFO] Step 1500/20000; acc:  84.96; ppl:  1.38; xent: 0.32; lr: 0.00210; 2713/2206 tok/s;    222 sec
[2020-08-20 03:17:16,531 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_1560.pt
[2020-08-20 03:17:22,669 INFO] Step 1600/20000; acc:  85.38; ppl:  1.36; xent: 0.31; lr: 0.00224; 2648/2151 tok/s;    237 sec
[2020-08-20 03:17:37,184 INFO] Step 1700/20000; acc:  85.71; ppl:  1.36; xent: 0.31; lr: 0.00238; 2718/2206 tok/s;    252 sec
[2020-08-20 03:17:51,735 INFO] Step 1800/20000; acc:  84.57; ppl:  1.40; xent: 0.33; lr: 0.00252; 2684/2184 tok/s;    266 sec
[2020-08-20 03:18:02,147 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_1872.pt
[2020-08-20 03:18:07,197 INFO] Step 1900/20000; acc:  83.85; ppl:  1.41; xent: 0.34; lr: 0.00266; 2527/2050 tok/s;    282 sec
[2020-08-20 03:18:21,818 INFO] Step 2000/20000; acc:  83.99; ppl:  1.43; xent: 0.35; lr: 0.00279; 2688/2185 tok/s;    296 sec
[2020-08-20 03:18:22,112 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:18:22,154 INFO] number of examples: 9920
[2020-08-20 03:18:36,539 INFO] Step 2100/20000; acc:  84.76; ppl:  1.39; xent: 0.33; lr: 0.00273; 2681/2176 tok/s;    311 sec
[2020-08-20 03:18:48,711 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_2184.pt
[2020-08-20 03:18:52,491 INFO] Step 2200/20000; acc:  85.13; ppl:  1.38; xent: 0.32; lr: 0.00266; 2468/2000 tok/s;    327 sec
[2020-08-20 03:19:07,070 INFO] Step 2300/20000; acc:  85.22; ppl:  1.37; xent: 0.31; lr: 0.00261; 2677/2173 tok/s;    342 sec
[2020-08-20 03:19:21,657 INFO] Step 2400/20000; acc:  85.73; ppl:  1.35; xent: 0.30; lr: 0.00255; 2699/2184 tok/s;    356 sec
[2020-08-20 03:19:35,560 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_2496.pt
[2020-08-20 03:19:36,481 INFO] Step 2500/20000; acc:  85.44; ppl:  1.37; xent: 0.31; lr: 0.00250; 2659/2161 tok/s;    371 sec
[2020-08-20 03:19:51,096 INFO] Step 2600/20000; acc:  83.93; ppl:  1.41; xent: 0.34; lr: 0.00245; 2692/2188 tok/s;    386 sec
[2020-08-20 03:20:05,702 INFO] Step 2700/20000; acc:  85.80; ppl:  1.36; xent: 0.30; lr: 0.00241; 2702/2193 tok/s;    400 sec
[2020-08-20 03:20:20,230 INFO] Step 2800/20000; acc:  85.95; ppl:  1.35; xent: 0.30; lr: 0.00236; 2691/2189 tok/s;    415 sec
[2020-08-20 03:20:21,393 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_2808.pt
[2020-08-20 03:20:35,215 INFO] Step 2900/20000; acc:  82.75; ppl:  1.44; xent: 0.37; lr: 0.00232; 2607/2115 tok/s;    430 sec
[2020-08-20 03:20:49,707 INFO] Step 3000/20000; acc:  85.24; ppl:  1.37; xent: 0.32; lr: 0.00228; 2710/2203 tok/s;    444 sec
[2020-08-20 03:20:50,142 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:20:50,183 INFO] number of examples: 9920
[2020-08-20 03:21:04,479 INFO] Step 3100/20000; acc:  85.34; ppl:  1.36; xent: 0.31; lr: 0.00224; 2671/2167 tok/s;    459 sec
[2020-08-20 03:21:07,368 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_3120.pt
[2020-08-20 03:21:19,238 INFO] Step 3200/20000; acc:  83.77; ppl:  1.42; xent: 0.35; lr: 0.00221; 2668/2164 tok/s;    474 sec
[2020-08-20 03:21:33,674 INFO] Step 3300/20000; acc:  83.70; ppl:  1.41; xent: 0.34; lr: 0.00218; 2723/2210 tok/s;    488 sec
[2020-08-20 03:21:48,225 INFO] Step 3400/20000; acc:  84.17; ppl:  1.40; xent: 0.33; lr: 0.00214; 2703/2186 tok/s;    503 sec
[2020-08-20 03:21:52,881 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_3432.pt
[2020-08-20 03:22:03,285 INFO] Step 3500/20000; acc:  83.87; ppl:  1.42; xent: 0.35; lr: 0.00211; 2617/2127 tok/s;    518 sec
[2020-08-20 03:22:17,790 INFO] Step 3600/20000; acc:  85.53; ppl:  1.35; xent: 0.30; lr: 0.00208; 2713/2206 tok/s;    532 sec
[2020-08-20 03:22:32,341 INFO] Step 3700/20000; acc:  87.09; ppl:  1.31; xent: 0.27; lr: 0.00205; 2709/2198 tok/s;    547 sec
[2020-08-20 03:22:38,758 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_3744.pt
[2020-08-20 03:22:47,255 INFO] Step 3800/20000; acc:  86.52; ppl:  1.33; xent: 0.28; lr: 0.00203; 2625/2135 tok/s;    562 sec
[2020-08-20 03:23:01,824 INFO] Step 3900/20000; acc:  85.72; ppl:  1.35; xent: 0.30; lr: 0.00200; 2682/2175 tok/s;    576 sec
[2020-08-20 03:23:16,347 INFO] Step 4000/20000; acc:  84.80; ppl:  1.37; xent: 0.31; lr: 0.00198; 2703/2197 tok/s;    591 sec
[2020-08-20 03:23:16,923 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:23:16,965 INFO] number of examples: 9920
[2020-08-20 03:23:24,529 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_4056.pt
[2020-08-20 03:23:31,252 INFO] Step 4100/20000; acc:  84.26; ppl:  1.39; xent: 0.33; lr: 0.00195; 2647/2149 tok/s;    606 sec
[2020-08-20 03:23:44,861 INFO] Step 4200/20000; acc:  85.76; ppl:  1.35; xent: 0.30; lr: 0.00193; 2896/2348 tok/s;    619 sec
[2020-08-20 03:23:58,469 INFO] Step 4300/20000; acc:  85.98; ppl:  1.34; xent: 0.29; lr: 0.00191; 2871/2329 tok/s;    633 sec
[2020-08-20 03:24:07,766 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_4368.pt
[2020-08-20 03:24:12,532 INFO] Step 4400/20000; acc:  85.66; ppl:  1.34; xent: 0.29; lr: 0.00188; 2794/2260 tok/s;    647 sec
[2020-08-20 03:24:26,179 INFO] Step 4500/20000; acc:  86.08; ppl:  1.33; xent: 0.29; lr: 0.00186; 2890/2347 tok/s;    661 sec
[2020-08-20 03:24:39,818 INFO] Step 4600/20000; acc:  86.51; ppl:  1.32; xent: 0.28; lr: 0.00184; 2884/2346 tok/s;    674 sec
[2020-08-20 03:24:50,778 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_4680.pt
[2020-08-20 03:24:53,815 INFO] Step 4700/20000; acc:  87.00; ppl:  1.30; xent: 0.26; lr: 0.00182; 2816/2284 tok/s;    688 sec
[2020-08-20 03:25:07,489 INFO] Step 4800/20000; acc:  86.88; ppl:  1.30; xent: 0.26; lr: 0.00180; 2861/2329 tok/s;    702 sec
[2020-08-20 03:25:21,125 INFO] Step 4900/20000; acc:  86.88; ppl:  1.31; xent: 0.27; lr: 0.00179; 2867/2325 tok/s;    716 sec
[2020-08-20 03:25:33,678 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_4992.pt
[2020-08-20 03:25:35,110 INFO] Step 5000/20000; acc:  79.69; ppl:  1.58; xent: 0.45; lr: 0.00177; 2811/2285 tok/s;    730 sec
[2020-08-20 03:25:35,782 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:25:35,821 INFO] number of examples: 9920
[2020-08-20 03:25:48,769 INFO] Step 5100/20000; acc:  83.01; ppl:  1.42; xent: 0.35; lr: 0.00175; 2883/2341 tok/s;    743 sec
[2020-08-20 03:26:02,418 INFO] Step 5200/20000; acc:  83.35; ppl:  1.42; xent: 0.35; lr: 0.00173; 2883/2338 tok/s;    757 sec
[2020-08-20 03:26:15,998 INFO] Step 5300/20000; acc:  84.02; ppl:  1.39; xent: 0.33; lr: 0.00172; 2884/2340 tok/s;    770 sec
[2020-08-20 03:26:17,384 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_5304.pt
[2020-08-20 03:26:31,793 INFO] Step 5400/20000; acc:  84.28; ppl:  1.37; xent: 0.31; lr: 0.00170; 2626/2125 tok/s;    786 sec
[2020-08-20 03:26:45,433 INFO] Step 5500/20000; acc:  85.83; ppl:  1.33; xent: 0.29; lr: 0.00169; 2888/2344 tok/s;    800 sec
[2020-08-20 03:26:59,066 INFO] Step 5600/20000; acc:  85.79; ppl:  1.33; xent: 0.28; lr: 0.00167; 2888/2349 tok/s;    814 sec
[2020-08-20 03:27:01,301 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_5616.pt
[2020-08-20 03:27:13,108 INFO] Step 5700/20000; acc:  86.53; ppl:  1.31; xent: 0.27; lr: 0.00166; 2813/2282 tok/s;    828 sec
[2020-08-20 03:27:26,711 INFO] Step 5800/20000; acc:  85.99; ppl:  1.33; xent: 0.28; lr: 0.00164; 2877/2342 tok/s;    841 sec
[2020-08-20 03:27:40,356 INFO] Step 5900/20000; acc:  85.58; ppl:  1.34; xent: 0.29; lr: 0.00163; 2863/2323 tok/s;    855 sec
[2020-08-20 03:27:44,177 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_5928.pt
[2020-08-20 03:27:54,328 INFO] Step 6000/20000; acc:  85.32; ppl:  1.35; xent: 0.30; lr: 0.00161; 2815/2288 tok/s;    869 sec
[2020-08-20 03:27:55,147 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:27:55,224 INFO] number of examples: 9920
[2020-08-20 03:28:08,061 INFO] Step 6100/20000; acc:  85.67; ppl:  1.33; xent: 0.29; lr: 0.00160; 2868/2329 tok/s;    883 sec
[2020-08-20 03:28:21,647 INFO] Step 6200/20000; acc:  85.52; ppl:  1.35; xent: 0.30; lr: 0.00159; 2890/2344 tok/s;    896 sec
[2020-08-20 03:28:27,264 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_6240.pt
[2020-08-20 03:28:35,920 INFO] Step 6300/20000; acc:  85.24; ppl:  1.35; xent: 0.30; lr: 0.00157; 2748/2230 tok/s;    910 sec
[2020-08-20 03:28:49,510 INFO] Step 6400/20000; acc:  85.06; ppl:  1.35; xent: 0.30; lr: 0.00156; 2891/2339 tok/s;    924 sec
[2020-08-20 03:29:03,177 INFO] Step 6500/20000; acc:  86.53; ppl:  1.31; xent: 0.27; lr: 0.00155; 2881/2338 tok/s;    938 sec
[2020-08-20 03:29:10,263 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_6552.pt
[2020-08-20 03:29:18,735 INFO] Step 6600/20000; acc:  86.49; ppl:  1.32; xent: 0.27; lr: 0.00154; 2533/2062 tok/s;    953 sec
[2020-08-20 03:29:32,396 INFO] Step 6700/20000; acc:  87.27; ppl:  1.29; xent: 0.25; lr: 0.00153; 2884/2339 tok/s;    967 sec
[2020-08-20 03:29:46,051 INFO] Step 6800/20000; acc:  87.35; ppl:  1.29; xent: 0.25; lr: 0.00152; 2867/2333 tok/s;    980 sec
[2020-08-20 03:29:54,813 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_6864.pt
[2020-08-20 03:30:00,107 INFO] Step 6900/20000; acc:  87.45; ppl:  1.29; xent: 0.25; lr: 0.00150; 2778/2255 tok/s;    995 sec
[2020-08-20 03:30:13,732 INFO] Step 7000/20000; acc:  87.46; ppl:  1.28; xent: 0.25; lr: 0.00149; 2887/2346 tok/s;   1008 sec
[2020-08-20 03:30:14,684 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:30:14,754 INFO] number of examples: 9920
[2020-08-20 03:30:27,448 INFO] Step 7100/20000; acc:  85.30; ppl:  1.36; xent: 0.31; lr: 0.00148; 2873/2334 tok/s;   1022 sec
[2020-08-20 03:30:37,748 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_7176.pt
[2020-08-20 03:30:41,337 INFO] Step 7200/20000; acc:  86.60; ppl:  1.31; xent: 0.27; lr: 0.00147; 2825/2292 tok/s;   1036 sec
[2020-08-20 03:30:54,979 INFO] Step 7300/20000; acc:  86.72; ppl:  1.31; xent: 0.27; lr: 0.00146; 2873/2330 tok/s;   1049 sec
[2020-08-20 03:31:08,653 INFO] Step 7400/20000; acc:  87.15; ppl:  1.29; xent: 0.26; lr: 0.00145; 2877/2329 tok/s;   1063 sec
[2020-08-20 03:31:20,593 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_7488.pt
[2020-08-20 03:31:22,569 INFO] Step 7500/20000; acc:  87.45; ppl:  1.29; xent: 0.25; lr: 0.00144; 2831/2297 tok/s;   1077 sec
[2020-08-20 03:31:36,193 INFO] Step 7600/20000; acc:  87.19; ppl:  1.29; xent: 0.25; lr: 0.00143; 2891/2352 tok/s;   1091 sec
[2020-08-20 03:31:49,790 INFO] Step 7700/20000; acc:  87.29; ppl:  1.29; xent: 0.25; lr: 0.00142; 2899/2353 tok/s;   1104 sec
[2020-08-20 03:32:03,401 INFO] Step 7800/20000; acc:  87.23; ppl:  1.28; xent: 0.25; lr: 0.00142; 2872/2337 tok/s;   1118 sec
[2020-08-20 03:32:03,402 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_7800.pt
[2020-08-20 03:32:17,296 INFO] Step 7900/20000; acc:  87.42; ppl:  1.28; xent: 0.25; lr: 0.00141; 2809/2278 tok/s;   1132 sec
[2020-08-20 03:32:30,906 INFO] Step 8000/20000; acc:  86.89; ppl:  1.29; xent: 0.26; lr: 0.00140; 2894/2353 tok/s;   1145 sec
[2020-08-20 03:32:32,001 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:32:32,073 INFO] number of examples: 9920
[2020-08-20 03:32:44,608 INFO] Step 8100/20000; acc:  87.61; ppl:  1.27; xent: 0.24; lr: 0.00139; 2877/2335 tok/s;   1159 sec
[2020-08-20 03:32:46,233 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_8112.pt
[2020-08-20 03:32:58,451 INFO] Step 8200/20000; acc:  87.10; ppl:  1.29; xent: 0.26; lr: 0.00138; 2834/2300 tok/s;   1173 sec
[2020-08-20 03:33:12,057 INFO] Step 8300/20000; acc:  86.78; ppl:  1.31; xent: 0.27; lr: 0.00137; 2879/2336 tok/s;   1187 sec
[2020-08-20 03:33:25,693 INFO] Step 8400/20000; acc:  87.06; ppl:  1.29; xent: 0.25; lr: 0.00136; 2884/2334 tok/s;   1200 sec
[2020-08-20 03:33:28,960 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_8424.pt
[2020-08-20 03:33:39,635 INFO] Step 8500/20000; acc:  87.28; ppl:  1.29; xent: 0.25; lr: 0.00136; 2824/2291 tok/s;   1214 sec
[2020-08-20 03:33:53,219 INFO] Step 8600/20000; acc:  87.29; ppl:  1.28; xent: 0.25; lr: 0.00135; 2900/2359 tok/s;   1228 sec
[2020-08-20 03:34:06,811 INFO] Step 8700/20000; acc:  87.80; ppl:  1.27; xent: 0.24; lr: 0.00134; 2898/2352 tok/s;   1241 sec
[2020-08-20 03:34:11,720 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_8736.pt
[2020-08-20 03:34:20,736 INFO] Step 8800/20000; acc:  87.42; ppl:  1.28; xent: 0.25; lr: 0.00133; 2813/2289 tok/s;   1255 sec
[2020-08-20 03:34:34,273 INFO] Step 8900/20000; acc:  87.70; ppl:  1.28; xent: 0.24; lr: 0.00132; 2881/2336 tok/s;   1269 sec
[2020-08-20 03:34:47,734 INFO] Step 9000/20000; acc:  87.61; ppl:  1.28; xent: 0.25; lr: 0.00132; 2928/2381 tok/s;   1282 sec
[2020-08-20 03:34:48,957 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:34:49,027 INFO] number of examples: 9920
[2020-08-20 03:34:54,275 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_9048.pt
[2020-08-20 03:35:01,556 INFO] Step 9100/20000; acc:  86.03; ppl:  1.33; xent: 0.29; lr: 0.00131; 2847/2311 tok/s;   1296 sec
[2020-08-20 03:35:14,990 INFO] Step 9200/20000; acc:  86.27; ppl:  1.32; xent: 0.28; lr: 0.00130; 2925/2375 tok/s;   1309 sec
[2020-08-20 03:35:28,455 INFO] Step 9300/20000; acc:  87.10; ppl:  1.29; xent: 0.25; lr: 0.00130; 2910/2360 tok/s;   1323 sec
[2020-08-20 03:35:36,505 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_9360.pt
[2020-08-20 03:35:42,313 INFO] Step 9400/20000; acc:  87.08; ppl:  1.29; xent: 0.25; lr: 0.00129; 2834/2295 tok/s;   1337 sec
[2020-08-20 03:35:55,852 INFO] Step 9500/20000; acc:  87.70; ppl:  1.28; xent: 0.24; lr: 0.00128; 2910/2359 tok/s;   1350 sec
[2020-08-20 03:36:09,263 INFO] Step 9600/20000; acc:  87.03; ppl:  1.29; xent: 0.26; lr: 0.00128; 2933/2386 tok/s;   1364 sec
[2020-08-20 03:36:19,040 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_9672.pt
[2020-08-20 03:36:23,260 INFO] Step 9700/20000; acc:  87.63; ppl:  1.28; xent: 0.25; lr: 0.00127; 2820/2289 tok/s;   1378 sec
[2020-08-20 03:36:36,859 INFO] Step 9800/20000; acc:  86.65; ppl:  1.31; xent: 0.27; lr: 0.00126; 2881/2346 tok/s;   1391 sec
[2020-08-20 03:36:50,230 INFO] Step 9900/20000; acc:  87.31; ppl:  1.29; xent: 0.25; lr: 0.00126; 2919/2365 tok/s;   1405 sec
[2020-08-20 03:37:01,501 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_9984.pt
[2020-08-20 03:37:04,059 INFO] Step 10000/20000; acc:  87.46; ppl:  1.27; xent: 0.24; lr: 0.00125; 2849/2317 tok/s;   1419 sec
[2020-08-20 03:37:04,060 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 03:37:04,064 INFO] number of examples: 620
[2020-08-20 03:37:05,002 INFO] Validation perplexity: 1.33106
[2020-08-20 03:37:05,002 INFO] Validation accuracy: 88.4065
[2020-08-20 03:37:06,361 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:37:06,434 INFO] number of examples: 9920
[2020-08-20 03:37:18,579 INFO] Step 10100/20000; acc:  86.96; ppl:  1.29; xent: 0.26; lr: 0.00124; 2709/2200 tok/s;   1433 sec
[2020-08-20 03:37:32,038 INFO] Step 10200/20000; acc:  86.06; ppl:  1.32; xent: 0.28; lr: 0.00124; 2918/2368 tok/s;   1446 sec
[2020-08-20 03:37:44,950 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_10296.pt
[2020-08-20 03:37:45,745 INFO] Step 10300/20000; acc:  87.48; ppl:  1.28; xent: 0.25; lr: 0.00123; 2862/2322 tok/s;   1460 sec
[2020-08-20 03:37:59,280 INFO] Step 10400/20000; acc:  87.22; ppl:  1.28; xent: 0.25; lr: 0.00123; 2902/2349 tok/s;   1474 sec
[2020-08-20 03:38:12,741 INFO] Step 10500/20000; acc:  87.80; ppl:  1.26; xent: 0.23; lr: 0.00122; 2924/2372 tok/s;   1487 sec
[2020-08-20 03:38:26,193 INFO] Step 10600/20000; acc:  87.86; ppl:  1.27; xent: 0.24; lr: 0.00121; 2926/2379 tok/s;   1501 sec
[2020-08-20 03:38:27,278 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_10608.pt
[2020-08-20 03:38:42,451 INFO] Step 10700/20000; acc:  88.03; ppl:  1.27; xent: 0.24; lr: 0.00121; 2423/1968 tok/s;   1517 sec
[2020-08-20 03:38:56,215 INFO] Step 10800/20000; acc:  87.94; ppl:  1.26; xent: 0.23; lr: 0.00120; 2909/2367 tok/s;   1531 sec
[2020-08-20 03:39:09,773 INFO] Step 10900/20000; acc:  88.06; ppl:  1.26; xent: 0.23; lr: 0.00120; 2878/2332 tok/s;   1544 sec
[2020-08-20 03:39:12,472 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_10920.pt
[2020-08-20 03:39:23,576 INFO] Step 11000/20000; acc:  88.04; ppl:  1.26; xent: 0.23; lr: 0.00119; 2860/2327 tok/s;   1558 sec
[2020-08-20 03:39:25,066 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:39:25,176 INFO] number of examples: 9920
[2020-08-20 03:39:37,436 INFO] Step 11100/20000; acc:  87.97; ppl:  1.26; xent: 0.23; lr: 0.00119; 2831/2297 tok/s;   1572 sec
[2020-08-20 03:39:51,920 INFO] Step 11200/20000; acc:  88.07; ppl:  1.26; xent: 0.23; lr: 0.00118; 2719/2207 tok/s;   1586 sec
[2020-08-20 03:39:56,671 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_11232.pt
[2020-08-20 03:40:08,179 INFO] Step 11300/20000; acc:  88.18; ppl:  1.25; xent: 0.23; lr: 0.00118; 2423/1965 tok/s;   1603 sec
[2020-08-20 03:40:22,681 INFO] Step 11400/20000; acc:  87.99; ppl:  1.25; xent: 0.23; lr: 0.00117; 2709/2193 tok/s;   1617 sec
[2020-08-20 03:40:37,186 INFO] Step 11500/20000; acc:  88.27; ppl:  1.26; xent: 0.23; lr: 0.00117; 2713/2201 tok/s;   1632 sec
[2020-08-20 03:40:43,545 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_11544.pt
[2020-08-20 03:40:54,764 INFO] Step 11600/20000; acc:  87.85; ppl:  1.26; xent: 0.23; lr: 0.00116; 2240/1822 tok/s;   1649 sec
[2020-08-20 03:41:09,383 INFO] Step 11700/20000; acc:  88.14; ppl:  1.26; xent: 0.23; lr: 0.00116; 2694/2188 tok/s;   1664 sec
[2020-08-20 03:41:24,000 INFO] Step 11800/20000; acc:  87.92; ppl:  1.26; xent: 0.23; lr: 0.00115; 2679/2179 tok/s;   1678 sec
[2020-08-20 03:41:32,187 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_11856.pt
[2020-08-20 03:41:38,877 INFO] Step 11900/20000; acc:  88.16; ppl:  1.26; xent: 0.23; lr: 0.00115; 2630/2131 tok/s;   1693 sec
[2020-08-20 03:41:53,480 INFO] Step 12000/20000; acc:  87.94; ppl:  1.26; xent: 0.23; lr: 0.00114; 2697/2196 tok/s;   1708 sec
[2020-08-20 03:41:55,287 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:41:55,369 INFO] number of examples: 9920
[2020-08-20 03:42:08,244 INFO] Step 12100/20000; acc:  88.15; ppl:  1.26; xent: 0.23; lr: 0.00114; 2658/2156 tok/s;   1723 sec
[2020-08-20 03:42:18,221 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_12168.pt
[2020-08-20 03:42:23,203 INFO] Step 12200/20000; acc:  88.10; ppl:  1.26; xent: 0.23; lr: 0.00113; 2636/2141 tok/s;   1738 sec
[2020-08-20 03:42:37,823 INFO] Step 12300/20000; acc:  87.86; ppl:  1.27; xent: 0.24; lr: 0.00113; 2674/2168 tok/s;   1752 sec
[2020-08-20 03:42:52,405 INFO] Step 12400/20000; acc:  87.52; ppl:  1.28; xent: 0.24; lr: 0.00112; 2692/2180 tok/s;   1767 sec
[2020-08-20 03:43:04,114 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_12480.pt
[2020-08-20 03:43:07,554 INFO] Step 12500/20000; acc:  87.88; ppl:  1.27; xent: 0.24; lr: 0.00112; 2601/2109 tok/s;   1782 sec
[2020-08-20 03:43:22,203 INFO] Step 12600/20000; acc:  87.69; ppl:  1.27; xent: 0.24; lr: 0.00111; 2686/2184 tok/s;   1797 sec
[2020-08-20 03:43:36,935 INFO] Step 12700/20000; acc:  87.99; ppl:  1.27; xent: 0.24; lr: 0.00111; 2674/2173 tok/s;   1811 sec
[2020-08-20 03:43:50,706 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_12792.pt
[2020-08-20 03:43:53,820 INFO] Step 12800/20000; acc:  88.16; ppl:  1.26; xent: 0.23; lr: 0.00110; 2318/1887 tok/s;   1828 sec
[2020-08-20 03:44:08,818 INFO] Step 12900/20000; acc:  88.08; ppl:  1.26; xent: 0.23; lr: 0.00110; 2612/2115 tok/s;   1843 sec
[2020-08-20 03:44:23,944 INFO] Step 13000/20000; acc:  88.14; ppl:  1.26; xent: 0.23; lr: 0.00110; 2605/2120 tok/s;   1858 sec
[2020-08-20 03:44:25,850 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:44:25,939 INFO] number of examples: 9920
[2020-08-20 03:44:38,777 INFO] Step 13100/20000; acc:  87.74; ppl:  1.27; xent: 0.24; lr: 0.00109; 2645/2147 tok/s;   1873 sec
[2020-08-20 03:44:39,361 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_13104.pt
[2020-08-20 03:44:53,580 INFO] Step 13200/20000; acc:  88.22; ppl:  1.26; xent: 0.23; lr: 0.00109; 2662/2161 tok/s;   1888 sec
[2020-08-20 03:45:08,136 INFO] Step 13300/20000; acc:  87.46; ppl:  1.28; xent: 0.25; lr: 0.00108; 2685/2176 tok/s;   1903 sec
[2020-08-20 03:45:22,680 INFO] Step 13400/20000; acc:  87.04; ppl:  1.29; xent: 0.25; lr: 0.00108; 2701/2188 tok/s;   1917 sec
[2020-08-20 03:45:25,035 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_13416.pt
[2020-08-20 03:45:37,727 INFO] Step 13500/20000; acc:  87.77; ppl:  1.27; xent: 0.24; lr: 0.00108; 2618/2122 tok/s;   1932 sec
[2020-08-20 03:45:52,255 INFO] Step 13600/20000; acc:  87.93; ppl:  1.27; xent: 0.24; lr: 0.00107; 2705/2199 tok/s;   1947 sec
[2020-08-20 03:46:06,678 INFO] Step 13700/20000; acc:  88.35; ppl:  1.25; xent: 0.23; lr: 0.00107; 2737/2225 tok/s;   1961 sec
[2020-08-20 03:46:10,630 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_13728.pt
[2020-08-20 03:46:21,083 INFO] Step 13800/20000; acc:  87.97; ppl:  1.27; xent: 0.24; lr: 0.00106; 2715/2208 tok/s;   1976 sec
[2020-08-20 03:46:35,200 INFO] Step 13900/20000; acc:  87.46; ppl:  1.28; xent: 0.24; lr: 0.00106; 2774/2247 tok/s;   1990 sec
[2020-08-20 03:46:49,362 INFO] Step 14000/20000; acc:  88.04; ppl:  1.26; xent: 0.23; lr: 0.00106; 2783/2264 tok/s;   2004 sec
[2020-08-20 03:46:51,357 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:46:51,440 INFO] number of examples: 9920
[2020-08-20 03:46:55,166 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_14040.pt
[2020-08-20 03:47:03,928 INFO] Step 14100/20000; acc:  87.01; ppl:  1.29; xent: 0.26; lr: 0.00105; 2697/2190 tok/s;   2018 sec
[2020-08-20 03:47:18,072 INFO] Step 14200/20000; acc:  87.41; ppl:  1.28; xent: 0.25; lr: 0.00105; 2784/2260 tok/s;   2033 sec
[2020-08-20 03:47:32,182 INFO] Step 14300/20000; acc:  87.87; ppl:  1.27; xent: 0.24; lr: 0.00105; 2771/2247 tok/s;   2047 sec
[2020-08-20 03:47:39,480 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_14352.pt
[2020-08-20 03:47:46,554 INFO] Step 14400/20000; acc:  87.50; ppl:  1.28; xent: 0.24; lr: 0.00104; 2734/2215 tok/s;   2061 sec
[2020-08-20 03:48:00,668 INFO] Step 14500/20000; acc:  87.68; ppl:  1.27; xent: 0.24; lr: 0.00104; 2788/2260 tok/s;   2075 sec
[2020-08-20 03:48:14,870 INFO] Step 14600/20000; acc:  87.86; ppl:  1.27; xent: 0.24; lr: 0.00103; 2770/2251 tok/s;   2089 sec
[2020-08-20 03:48:23,948 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_14664.pt
[2020-08-20 03:48:29,359 INFO] Step 14700/20000; acc:  87.83; ppl:  1.27; xent: 0.24; lr: 0.00103; 2723/2216 tok/s;   2104 sec
[2020-08-20 03:48:43,490 INFO] Step 14800/20000; acc:  87.52; ppl:  1.28; xent: 0.24; lr: 0.00103; 2766/2249 tok/s;   2118 sec
[2020-08-20 03:48:57,566 INFO] Step 14900/20000; acc:  87.61; ppl:  1.27; xent: 0.24; lr: 0.00102; 2784/2257 tok/s;   2132 sec
[2020-08-20 03:49:08,361 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_14976.pt
[2020-08-20 03:49:13,368 INFO] Step 15000/20000; acc:  87.41; ppl:  1.28; xent: 0.25; lr: 0.00102; 2501/2035 tok/s;   2148 sec
[2020-08-20 03:49:15,475 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:49:15,554 INFO] number of examples: 9920
[2020-08-20 03:49:27,522 INFO] Step 15100/20000; acc:  87.60; ppl:  1.27; xent: 0.24; lr: 0.00102; 2775/2253 tok/s;   2162 sec
[2020-08-20 03:49:41,651 INFO] Step 15200/20000; acc:  88.15; ppl:  1.26; xent: 0.23; lr: 0.00101; 2787/2263 tok/s;   2176 sec
[2020-08-20 03:49:54,004 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_15288.pt
[2020-08-20 03:49:56,109 INFO] Step 15300/20000; acc:  88.10; ppl:  1.26; xent: 0.23; lr: 0.00101; 2708/2195 tok/s;   2191 sec
[2020-08-20 03:50:10,260 INFO] Step 15400/20000; acc:  87.78; ppl:  1.26; xent: 0.23; lr: 0.00101; 2773/2246 tok/s;   2205 sec
[2020-08-20 03:50:24,343 INFO] Step 15500/20000; acc:  88.00; ppl:  1.26; xent: 0.23; lr: 0.00100; 2795/2265 tok/s;   2219 sec
[2020-08-20 03:50:38,368 INFO] Step 15600/20000; acc:  88.03; ppl:  1.26; xent: 0.23; lr: 0.00100; 2806/2281 tok/s;   2233 sec
[2020-08-20 03:50:38,370 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_15600.pt
[2020-08-20 03:50:52,775 INFO] Step 15700/20000; acc:  87.58; ppl:  1.27; xent: 0.24; lr: 0.00100; 2740/2228 tok/s;   2247 sec
[2020-08-20 03:51:08,107 INFO] Step 15800/20000; acc:  87.62; ppl:  1.27; xent: 0.24; lr: 0.00099; 2800/2276 tok/s;   2263 sec
[2020-08-20 03:51:22,125 INFO] Step 15900/20000; acc:  87.88; ppl:  1.26; xent: 0.23; lr: 0.00099; 2800/2270 tok/s;   2277 sec
[2020-08-20 03:51:23,815 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_15912.pt
[2020-08-20 03:51:36,525 INFO] Step 16000/20000; acc:  88.02; ppl:  1.25; xent: 0.23; lr: 0.00099; 2738/2228 tok/s;   2291 sec
[2020-08-20 03:51:38,789 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:51:38,882 INFO] number of examples: 9920
[2020-08-20 03:51:50,710 INFO] Step 16100/20000; acc:  88.27; ppl:  1.26; xent: 0.23; lr: 0.00099; 2766/2245 tok/s;   2305 sec
[2020-08-20 03:52:04,738 INFO] Step 16200/20000; acc:  88.31; ppl:  1.25; xent: 0.22; lr: 0.00098; 2806/2279 tok/s;   2319 sec
[2020-08-20 03:52:08,110 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_16224.pt
[2020-08-20 03:52:20,025 INFO] Step 16300/20000; acc:  88.35; ppl:  1.25; xent: 0.22; lr: 0.00098; 2561/2074 tok/s;   2334 sec
[2020-08-20 03:52:34,154 INFO] Step 16400/20000; acc:  88.05; ppl:  1.25; xent: 0.22; lr: 0.00098; 2777/2251 tok/s;   2349 sec
[2020-08-20 03:52:48,225 INFO] Step 16500/20000; acc:  88.24; ppl:  1.25; xent: 0.23; lr: 0.00097; 2800/2267 tok/s;   2363 sec
[2020-08-20 03:52:53,310 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_16536.pt
[2020-08-20 03:53:02,717 INFO] Step 16600/20000; acc:  88.06; ppl:  1.26; xent: 0.23; lr: 0.00097; 2715/2207 tok/s;   2377 sec
[2020-08-20 03:53:16,840 INFO] Step 16700/20000; acc:  88.39; ppl:  1.25; xent: 0.22; lr: 0.00097; 2794/2272 tok/s;   2391 sec
[2020-08-20 03:53:30,916 INFO] Step 16800/20000; acc:  88.21; ppl:  1.25; xent: 0.22; lr: 0.00096; 2772/2253 tok/s;   2405 sec
[2020-08-20 03:53:37,660 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_16848.pt
[2020-08-20 03:53:46,474 INFO] Step 16900/20000; acc:  88.13; ppl:  1.25; xent: 0.22; lr: 0.00096; 2526/2048 tok/s;   2421 sec
[2020-08-20 03:54:00,525 INFO] Step 17000/20000; acc:  88.14; ppl:  1.25; xent: 0.22; lr: 0.00096; 2803/2282 tok/s;   2435 sec
[2020-08-20 03:54:02,947 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:54:03,035 INFO] number of examples: 9920
[2020-08-20 03:54:14,835 INFO] Step 17100/20000; acc:  87.32; ppl:  1.29; xent: 0.25; lr: 0.00096; 2739/2224 tok/s;   2449 sec
[2020-08-20 03:54:23,286 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_17160.pt
[2020-08-20 03:54:29,681 INFO] Step 17200/20000; acc:  86.69; ppl:  1.30; xent: 0.26; lr: 0.00095; 2655/2156 tok/s;   2464 sec
[2020-08-20 03:54:43,751 INFO] Step 17300/20000; acc:  87.40; ppl:  1.28; xent: 0.24; lr: 0.00095; 2781/2252 tok/s;   2478 sec
[2020-08-20 03:54:57,843 INFO] Step 17400/20000; acc:  87.87; ppl:  1.27; xent: 0.24; lr: 0.00095; 2783/2257 tok/s;   2492 sec
[2020-08-20 03:55:07,962 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_17472.pt
[2020-08-20 03:55:12,217 INFO] Step 17500/20000; acc:  87.42; ppl:  1.27; xent: 0.24; lr: 0.00094; 2746/2222 tok/s;   2507 sec
[2020-08-20 03:55:26,286 INFO] Step 17600/20000; acc:  87.12; ppl:  1.29; xent: 0.25; lr: 0.00094; 2790/2270 tok/s;   2521 sec
[2020-08-20 03:55:40,376 INFO] Step 17700/20000; acc:  87.02; ppl:  1.30; xent: 0.26; lr: 0.00094; 2802/2278 tok/s;   2535 sec
[2020-08-20 03:55:52,201 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_17784.pt
[2020-08-20 03:55:54,763 INFO] Step 17800/20000; acc:  87.35; ppl:  1.28; xent: 0.25; lr: 0.00094; 2713/2205 tok/s;   2549 sec
[2020-08-20 03:56:08,874 INFO] Step 17900/20000; acc:  87.51; ppl:  1.28; xent: 0.25; lr: 0.00093; 2786/2259 tok/s;   2563 sec
[2020-08-20 03:56:23,059 INFO] Step 18000/20000; acc:  86.83; ppl:  1.30; xent: 0.27; lr: 0.00093; 2776/2261 tok/s;   2578 sec
[2020-08-20 03:56:25,590 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:56:25,792 INFO] number of examples: 9920
[2020-08-20 03:56:36,817 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_18096.pt
[2020-08-20 03:56:37,692 INFO] Step 18100/20000; acc:  87.33; ppl:  1.28; xent: 0.25; lr: 0.00093; 2674/2171 tok/s;   2592 sec
[2020-08-20 03:56:51,756 INFO] Step 18200/20000; acc:  87.87; ppl:  1.27; xent: 0.24; lr: 0.00093; 2806/2278 tok/s;   2606 sec
[2020-08-20 03:57:05,806 INFO] Step 18300/20000; acc:  87.93; ppl:  1.26; xent: 0.23; lr: 0.00092; 2785/2256 tok/s;   2620 sec
[2020-08-20 03:57:19,881 INFO] Step 18400/20000; acc:  87.89; ppl:  1.26; xent: 0.23; lr: 0.00092; 2788/2261 tok/s;   2634 sec
[2020-08-20 03:57:21,002 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_18408.pt
[2020-08-20 03:57:34,542 INFO] Step 18500/20000; acc:  87.90; ppl:  1.26; xent: 0.23; lr: 0.00092; 2692/2178 tok/s;   2649 sec
[2020-08-20 03:57:48,640 INFO] Step 18600/20000; acc:  87.83; ppl:  1.27; xent: 0.24; lr: 0.00092; 2781/2263 tok/s;   2663 sec
[2020-08-20 03:58:02,744 INFO] Step 18700/20000; acc:  87.92; ppl:  1.27; xent: 0.24; lr: 0.00091; 2804/2279 tok/s;   2677 sec
[2020-08-20 03:58:05,561 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_18720.pt
[2020-08-20 03:58:17,135 INFO] Step 18800/20000; acc:  86.62; ppl:  1.30; xent: 0.26; lr: 0.00091; 2707/2200 tok/s;   2692 sec
[2020-08-20 03:58:31,207 INFO] Step 18900/20000; acc:  87.69; ppl:  1.27; xent: 0.24; lr: 0.00091; 2793/2264 tok/s;   2706 sec
[2020-08-20 03:58:45,295 INFO] Step 19000/20000; acc:  87.73; ppl:  1.27; xent: 0.24; lr: 0.00091; 2798/2277 tok/s;   2720 sec
[2020-08-20 03:58:47,981 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 03:58:48,024 INFO] number of examples: 9920
[2020-08-20 03:58:49,961 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_19032.pt
[2020-08-20 03:58:59,862 INFO] Step 19100/20000; acc:  87.98; ppl:  1.26; xent: 0.23; lr: 0.00090; 2690/2183 tok/s;   2734 sec
[2020-08-20 03:59:14,024 INFO] Step 19200/20000; acc:  88.41; ppl:  1.25; xent: 0.23; lr: 0.00090; 2778/2258 tok/s;   2748 sec
[2020-08-20 03:59:28,392 INFO] Step 19300/20000; acc:  88.23; ppl:  1.25; xent: 0.22; lr: 0.00090; 2784/2254 tok/s;   2763 sec
[2020-08-20 03:59:34,636 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_19344.pt
[2020-08-20 03:59:42,866 INFO] Step 19400/20000; acc:  88.28; ppl:  1.25; xent: 0.22; lr: 0.00090; 2709/2198 tok/s;   2777 sec
[2020-08-20 03:59:56,996 INFO] Step 19500/20000; acc:  88.41; ppl:  1.24; xent: 0.22; lr: 0.00090; 2791/2259 tok/s;   2791 sec
[2020-08-20 04:00:10,877 INFO] Step 19600/20000; acc:  88.52; ppl:  1.25; xent: 0.22; lr: 0.00089; 2825/2299 tok/s;   2805 sec
[2020-08-20 04:00:18,761 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_19656.pt
[2020-08-20 04:00:25,304 INFO] Step 19700/20000; acc:  88.29; ppl:  1.26; xent: 0.23; lr: 0.00089; 2745/2230 tok/s;   2820 sec
[2020-08-20 04:00:39,465 INFO] Step 19800/20000; acc:  88.36; ppl:  1.25; xent: 0.22; lr: 0.00089; 2750/2235 tok/s;   2834 sec
[2020-08-20 04:00:53,616 INFO] Step 19900/20000; acc:  88.33; ppl:  1.25; xent: 0.23; lr: 0.00089; 2779/2253 tok/s;   2848 sec
[2020-08-20 04:01:03,257 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_19968.pt
[2020-08-20 04:01:08,191 INFO] Step 20000/20000; acc:  88.05; ppl:  1.26; xent: 0.23; lr: 0.00088; 2701/2198 tok/s;   2863 sec
[2020-08-20 04:01:08,192 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 04:01:08,232 INFO] number of examples: 620
[2020-08-20 04:01:09,210 INFO] Validation perplexity: 1.29148
[2020-08-20 04:01:09,210 INFO] Validation accuracy: 89.5613
[2020-08-20 04:01:09,212 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv6/toy_model_step_20000.pt
[2020-08-20 04:01:10,607 INFO]  * src vocab size = 20
[2020-08-20 04:01:10,607 INFO]  * tgt vocab size = 20
[2020-08-20 04:01:10,607 INFO] Building model...
[2020-08-20 04:01:12,692 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=256, out_features=20, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-08-20 04:01:12,694 INFO] encoder: 5265920
[2020-08-20 04:01:12,694 INFO] decoder: 6320660
[2020-08-20 04:01:12,694 INFO] * number of parameters: 11586580
[2020-08-20 04:01:12,702 INFO] Starting training on GPU: [0]
[2020-08-20 04:01:12,703 INFO] Start training loop and validate every 10000 steps...
[2020-08-20 04:01:12,703 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:01:12,776 INFO] number of examples: 9920
[2020-08-20 04:01:28,202 INFO] Step 100/20000; acc:  52.44; ppl:  3.50; xent: 1.25; lr: 0.00014; 2538/2064 tok/s;     15 sec
[2020-08-20 04:01:43,482 INFO] Step 200/20000; acc:  73.32; ppl:  1.84; xent: 0.61; lr: 0.00028; 2558/2065 tok/s;     31 sec
[2020-08-20 04:01:58,771 INFO] Step 300/20000; acc:  78.01; ppl:  1.64; xent: 0.49; lr: 0.00042; 2584/2107 tok/s;     46 sec
[2020-08-20 04:02:00,611 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_312.pt
[2020-08-20 04:02:14,609 INFO] Step 400/20000; acc:  80.98; ppl:  1.53; xent: 0.43; lr: 0.00056; 2440/1985 tok/s;     62 sec
[2020-08-20 04:02:29,808 INFO] Step 500/20000; acc:  82.73; ppl:  1.46; xent: 0.38; lr: 0.00070; 2602/2108 tok/s;     77 sec
[2020-08-20 04:02:45,085 INFO] Step 600/20000; acc:  84.50; ppl:  1.41; xent: 0.34; lr: 0.00084; 2558/2084 tok/s;     92 sec
[2020-08-20 04:02:48,733 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_624.pt
[2020-08-20 04:03:00,610 INFO] Step 700/20000; acc:  85.00; ppl:  1.39; xent: 0.33; lr: 0.00098; 2537/2062 tok/s;    108 sec
[2020-08-20 04:03:15,940 INFO] Step 800/20000; acc:  85.09; ppl:  1.39; xent: 0.33; lr: 0.00112; 2570/2084 tok/s;    123 sec
[2020-08-20 04:03:31,182 INFO] Step 900/20000; acc:  85.93; ppl:  1.35; xent: 0.30; lr: 0.00126; 2592/2103 tok/s;    138 sec
[2020-08-20 04:03:36,708 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_936.pt
[2020-08-20 04:03:47,732 INFO] Step 1000/20000; acc:  85.99; ppl:  1.36; xent: 0.31; lr: 0.00140; 2377/1925 tok/s;    155 sec
[2020-08-20 04:03:47,884 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:03:47,973 INFO] number of examples: 9920
[2020-08-20 04:04:03,165 INFO] Step 1100/20000; acc:  85.91; ppl:  1.36; xent: 0.30; lr: 0.00154; 2551/2074 tok/s;    170 sec
[2020-08-20 04:04:18,439 INFO] Step 1200/20000; acc:  86.08; ppl:  1.35; xent: 0.30; lr: 0.00168; 2558/2065 tok/s;    186 sec
[2020-08-20 04:04:25,744 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_1248.pt
[2020-08-20 04:04:34,194 INFO] Step 1300/20000; acc:  86.38; ppl:  1.34; xent: 0.29; lr: 0.00182; 2508/2045 tok/s;    201 sec
[2020-08-20 04:04:49,452 INFO] Step 1400/20000; acc:  86.05; ppl:  1.35; xent: 0.30; lr: 0.00196; 2534/2062 tok/s;    217 sec
[2020-08-20 04:05:04,647 INFO] Step 1500/20000; acc:  85.27; ppl:  1.37; xent: 0.32; lr: 0.00210; 2602/2107 tok/s;    232 sec
[2020-08-20 04:05:13,745 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_1560.pt
[2020-08-20 04:05:20,174 INFO] Step 1600/20000; acc:  85.11; ppl:  1.37; xent: 0.32; lr: 0.00224; 2514/2049 tok/s;    247 sec
[2020-08-20 04:05:35,456 INFO] Step 1700/20000; acc:  85.41; ppl:  1.37; xent: 0.32; lr: 0.00238; 2578/2095 tok/s;    263 sec
[2020-08-20 04:05:50,658 INFO] Step 1800/20000; acc:  84.54; ppl:  1.40; xent: 0.33; lr: 0.00252; 2594/2103 tok/s;    278 sec
[2020-08-20 04:06:01,642 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_1872.pt
[2020-08-20 04:06:06,280 INFO] Step 1900/20000; acc:  83.46; ppl:  1.43; xent: 0.36; lr: 0.00266; 2533/2054 tok/s;    294 sec
[2020-08-20 04:06:21,504 INFO] Step 2000/20000; acc:  82.76; ppl:  1.45; xent: 0.37; lr: 0.00279; 2578/2088 tok/s;    309 sec
[2020-08-20 04:06:21,808 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:06:21,849 INFO] number of examples: 9920
[2020-08-20 04:06:36,982 INFO] Step 2100/20000; acc:  84.09; ppl:  1.39; xent: 0.33; lr: 0.00273; 2547/2070 tok/s;    324 sec
[2020-08-20 04:06:49,749 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_2184.pt
[2020-08-20 04:06:52,549 INFO] Step 2200/20000; acc:  84.02; ppl:  1.40; xent: 0.34; lr: 0.00266; 2510/2026 tok/s;    340 sec
[2020-08-20 04:07:07,692 INFO] Step 2300/20000; acc:  84.15; ppl:  1.39; xent: 0.33; lr: 0.00261; 2606/2124 tok/s;    355 sec
[2020-08-20 04:07:22,899 INFO] Step 2400/20000; acc:  84.88; ppl:  1.37; xent: 0.32; lr: 0.00255; 2546/2073 tok/s;    370 sec
[2020-08-20 04:07:37,559 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_2496.pt
[2020-08-20 04:07:38,506 INFO] Step 2500/20000; acc:  82.94; ppl:  1.44; xent: 0.37; lr: 0.00250; 2531/2050 tok/s;    386 sec
[2020-08-20 04:07:53,710 INFO] Step 2600/20000; acc:  83.66; ppl:  1.42; xent: 0.35; lr: 0.00245; 2569/2093 tok/s;    401 sec
[2020-08-20 04:08:08,962 INFO] Step 2700/20000; acc:  85.28; ppl:  1.36; xent: 0.31; lr: 0.00241; 2587/2102 tok/s;    416 sec
[2020-08-20 04:08:24,217 INFO] Step 2800/20000; acc:  85.06; ppl:  1.37; xent: 0.31; lr: 0.00236; 2583/2095 tok/s;    432 sec
[2020-08-20 04:08:25,437 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_2808.pt
[2020-08-20 04:08:39,735 INFO] Step 2900/20000; acc:  85.21; ppl:  1.37; xent: 0.31; lr: 0.00232; 2543/2062 tok/s;    447 sec
[2020-08-20 04:08:54,980 INFO] Step 3000/20000; acc:  85.58; ppl:  1.35; xent: 0.30; lr: 0.00228; 2578/2088 tok/s;    462 sec
[2020-08-20 04:08:55,441 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:08:55,484 INFO] number of examples: 9920
[2020-08-20 04:09:10,364 INFO] Step 3100/20000; acc:  84.51; ppl:  1.38; xent: 0.32; lr: 0.00224; 2564/2084 tok/s;    478 sec
[2020-08-20 04:09:13,411 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_3120.pt
[2020-08-20 04:09:25,807 INFO] Step 3200/20000; acc:  84.04; ppl:  1.39; xent: 0.33; lr: 0.00221; 2529/2042 tok/s;    493 sec
[2020-08-20 04:09:40,963 INFO] Step 3300/20000; acc:  84.05; ppl:  1.40; xent: 0.33; lr: 0.00218; 2607/2124 tok/s;    508 sec
[2020-08-20 04:09:56,149 INFO] Step 3400/20000; acc:  83.63; ppl:  1.41; xent: 0.35; lr: 0.00214; 2548/2074 tok/s;    523 sec
[2020-08-20 04:10:01,008 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_3432.pt
[2020-08-20 04:10:11,647 INFO] Step 3500/20000; acc:  82.36; ppl:  1.47; xent: 0.38; lr: 0.00211; 2546/2062 tok/s;    539 sec
[2020-08-20 04:10:26,855 INFO] Step 3600/20000; acc:  84.56; ppl:  1.38; xent: 0.32; lr: 0.00208; 2569/2094 tok/s;    554 sec
[2020-08-20 04:10:42,019 INFO] Step 3700/20000; acc:  85.58; ppl:  1.34; xent: 0.29; lr: 0.00205; 2599/2111 tok/s;    569 sec
[2020-08-20 04:10:48,715 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_3744.pt
[2020-08-20 04:10:57,589 INFO] Step 3800/20000; acc:  86.27; ppl:  1.32; xent: 0.28; lr: 0.00203; 2531/2053 tok/s;    585 sec
[2020-08-20 04:11:12,795 INFO] Step 3900/20000; acc:  85.92; ppl:  1.33; xent: 0.28; lr: 0.00200; 2600/2108 tok/s;    600 sec
[2020-08-20 04:11:28,002 INFO] Step 4000/20000; acc:  84.79; ppl:  1.37; xent: 0.32; lr: 0.00198; 2584/2093 tok/s;    615 sec
[2020-08-20 04:11:28,613 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:11:28,656 INFO] number of examples: 9920
[2020-08-20 04:11:36,643 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_4056.pt
[2020-08-20 04:11:43,914 INFO] Step 4100/20000; acc:  81.93; ppl:  1.47; xent: 0.38; lr: 0.00195; 2478/2015 tok/s;    631 sec
[2020-08-20 04:11:59,131 INFO] Step 4200/20000; acc:  83.31; ppl:  1.41; xent: 0.35; lr: 0.00193; 2564/2071 tok/s;    646 sec
[2020-08-20 04:12:14,362 INFO] Step 4300/20000; acc:  84.14; ppl:  1.39; xent: 0.33; lr: 0.00191; 2591/2111 tok/s;    662 sec
[2020-08-20 04:12:24,701 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_4368.pt
[2020-08-20 04:12:29,944 INFO] Step 4400/20000; acc:  86.25; ppl:  1.33; xent: 0.28; lr: 0.00188; 2491/2028 tok/s;    677 sec
[2020-08-20 04:12:45,130 INFO] Step 4500/20000; acc:  86.03; ppl:  1.32; xent: 0.28; lr: 0.00186; 2596/2104 tok/s;    692 sec
[2020-08-20 04:13:00,481 INFO] Step 4600/20000; acc:  86.51; ppl:  1.31; xent: 0.27; lr: 0.00184; 2544/2074 tok/s;    708 sec
[2020-08-20 04:13:12,721 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_4680.pt
[2020-08-20 04:13:16,144 INFO] Step 4700/20000; acc:  85.95; ppl:  1.33; xent: 0.28; lr: 0.00182; 2516/2043 tok/s;    723 sec
[2020-08-20 04:13:31,522 INFO] Step 4800/20000; acc:  85.29; ppl:  1.35; xent: 0.30; lr: 0.00180; 2562/2078 tok/s;    739 sec
[2020-08-20 04:13:46,841 INFO] Step 4900/20000; acc:  85.86; ppl:  1.33; xent: 0.28; lr: 0.00179; 2581/2092 tok/s;    754 sec
[2020-08-20 04:14:01,043 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_4992.pt
[2020-08-20 04:14:02,633 INFO] Step 5000/20000; acc:  86.14; ppl:  1.32; xent: 0.28; lr: 0.00177; 2488/2015 tok/s;    770 sec
[2020-08-20 04:14:03,397 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:14:03,441 INFO] number of examples: 9920
[2020-08-20 04:14:18,138 INFO] Step 5100/20000; acc:  85.16; ppl:  1.35; xent: 0.30; lr: 0.00175; 2544/2067 tok/s;    785 sec
[2020-08-20 04:14:33,508 INFO] Step 5200/20000; acc:  86.23; ppl:  1.32; xent: 0.28; lr: 0.00173; 2537/2049 tok/s;    801 sec
[2020-08-20 04:14:48,908 INFO] Step 5300/20000; acc:  86.97; ppl:  1.30; xent: 0.26; lr: 0.00172; 2566/2090 tok/s;    816 sec
[2020-08-20 04:14:49,523 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_5304.pt
[2020-08-20 04:15:04,639 INFO] Step 5400/20000; acc:  86.05; ppl:  1.33; xent: 0.28; lr: 0.00170; 2469/2010 tok/s;    832 sec
[2020-08-20 04:15:20,048 INFO] Step 5500/20000; acc:  86.55; ppl:  1.31; xent: 0.27; lr: 0.00169; 2557/2072 tok/s;    847 sec
[2020-08-20 04:15:35,435 INFO] Step 5600/20000; acc:  86.74; ppl:  1.30; xent: 0.26; lr: 0.00167; 2539/2069 tok/s;    863 sec
[2020-08-20 04:15:37,901 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_5616.pt
[2020-08-20 04:15:51,229 INFO] Step 5700/20000; acc:  86.76; ppl:  1.31; xent: 0.27; lr: 0.00166; 2493/2023 tok/s;    879 sec
[2020-08-20 04:16:06,596 INFO] Step 5800/20000; acc:  86.45; ppl:  1.32; xent: 0.28; lr: 0.00164; 2563/2079 tok/s;    894 sec
[2020-08-20 04:16:21,980 INFO] Step 5900/20000; acc:  86.68; ppl:  1.31; xent: 0.27; lr: 0.00163; 2575/2087 tok/s;    909 sec
[2020-08-20 04:16:26,292 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_5928.pt
[2020-08-20 04:16:37,610 INFO] Step 6000/20000; acc:  86.92; ppl:  1.30; xent: 0.26; lr: 0.00161; 2515/2037 tok/s;    925 sec
[2020-08-20 04:16:38,528 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:16:38,608 INFO] number of examples: 9920
[2020-08-20 04:16:53,064 INFO] Step 6100/20000; acc:  87.14; ppl:  1.29; xent: 0.25; lr: 0.00160; 2552/2074 tok/s;    940 sec
[2020-08-20 04:17:08,346 INFO] Step 6200/20000; acc:  86.89; ppl:  1.30; xent: 0.26; lr: 0.00159; 2553/2062 tok/s;    956 sec
[2020-08-20 04:17:14,475 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_6240.pt
[2020-08-20 04:17:23,911 INFO] Step 6300/20000; acc:  86.84; ppl:  1.31; xent: 0.27; lr: 0.00157; 2535/2066 tok/s;    971 sec
[2020-08-20 04:17:39,238 INFO] Step 6400/20000; acc:  86.91; ppl:  1.30; xent: 0.26; lr: 0.00156; 2538/2066 tok/s;    987 sec
[2020-08-20 04:17:54,547 INFO] Step 6500/20000; acc:  85.67; ppl:  1.34; xent: 0.29; lr: 0.00155; 2570/2083 tok/s;   1002 sec
[2020-08-20 04:18:02,451 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_6552.pt
[2020-08-20 04:18:11,060 INFO] Step 6600/20000; acc:  86.81; ppl:  1.30; xent: 0.26; lr: 0.00154; 2366/1929 tok/s;   1018 sec
[2020-08-20 04:18:26,265 INFO] Step 6700/20000; acc:  87.45; ppl:  1.28; xent: 0.25; lr: 0.00153; 2589/2102 tok/s;   1034 sec
[2020-08-20 04:18:41,416 INFO] Step 6800/20000; acc:  87.30; ppl:  1.29; xent: 0.26; lr: 0.00152; 2600/2108 tok/s;   1049 sec
[2020-08-20 04:18:51,088 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_6864.pt
[2020-08-20 04:18:56,926 INFO] Step 6900/20000; acc:  86.83; ppl:  1.30; xent: 0.26; lr: 0.00150; 2552/2069 tok/s;   1064 sec
[2020-08-20 04:19:12,048 INFO] Step 7000/20000; acc:  87.37; ppl:  1.29; xent: 0.25; lr: 0.00149; 2599/2106 tok/s;   1079 sec
[2020-08-20 04:19:13,081 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:19:13,160 INFO] number of examples: 9920
[2020-08-20 04:19:27,243 INFO] Step 7100/20000; acc:  87.39; ppl:  1.28; xent: 0.25; lr: 0.00148; 2595/2108 tok/s;   1095 sec
[2020-08-20 04:19:38,722 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_7176.pt
[2020-08-20 04:19:42,685 INFO] Step 7200/20000; acc:  86.61; ppl:  1.31; xent: 0.27; lr: 0.00147; 2529/2043 tok/s;   1110 sec
[2020-08-20 04:19:57,780 INFO] Step 7300/20000; acc:  87.81; ppl:  1.27; xent: 0.24; lr: 0.00146; 2608/2125 tok/s;   1125 sec
[2020-08-20 04:20:12,881 INFO] Step 7400/20000; acc:  87.12; ppl:  1.29; xent: 0.26; lr: 0.00145; 2579/2100 tok/s;   1140 sec
[2020-08-20 04:20:26,163 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_7488.pt
[2020-08-20 04:20:28,259 INFO] Step 7500/20000; acc:  86.65; ppl:  1.31; xent: 0.27; lr: 0.00144; 2557/2071 tok/s;   1156 sec
[2020-08-20 04:20:43,352 INFO] Step 7600/20000; acc:  86.60; ppl:  1.31; xent: 0.27; lr: 0.00143; 2590/2111 tok/s;   1171 sec
[2020-08-20 04:20:58,474 INFO] Step 7700/20000; acc:  86.51; ppl:  1.31; xent: 0.27; lr: 0.00142; 2604/2114 tok/s;   1186 sec
[2020-08-20 04:21:13,623 INFO] Step 7800/20000; acc:  87.40; ppl:  1.29; xent: 0.25; lr: 0.00142; 2601/2110 tok/s;   1201 sec
[2020-08-20 04:21:13,625 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_7800.pt
[2020-08-20 04:21:29,082 INFO] Step 7900/20000; acc:  85.66; ppl:  1.34; xent: 0.29; lr: 0.00141; 2559/2073 tok/s;   1216 sec
[2020-08-20 04:21:44,229 INFO] Step 8000/20000; acc:  85.81; ppl:  1.34; xent: 0.30; lr: 0.00140; 2594/2102 tok/s;   1232 sec
[2020-08-20 04:21:45,434 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:21:45,514 INFO] number of examples: 9920
[2020-08-20 04:21:59,456 INFO] Step 8100/20000; acc:  86.69; ppl:  1.30; xent: 0.26; lr: 0.00139; 2593/2107 tok/s;   1247 sec
[2020-08-20 04:22:01,269 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_8112.pt
[2020-08-20 04:22:14,875 INFO] Step 8200/20000; acc:  87.23; ppl:  1.29; xent: 0.25; lr: 0.00138; 2531/2045 tok/s;   1262 sec
[2020-08-20 04:22:30,014 INFO] Step 8300/20000; acc:  87.56; ppl:  1.28; xent: 0.25; lr: 0.00137; 2601/2119 tok/s;   1277 sec
[2020-08-20 04:22:45,149 INFO] Step 8400/20000; acc:  87.75; ppl:  1.28; xent: 0.25; lr: 0.00136; 2575/2096 tok/s;   1292 sec
[2020-08-20 04:22:48,771 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_8424.pt
[2020-08-20 04:23:00,540 INFO] Step 8500/20000; acc:  87.63; ppl:  1.28; xent: 0.24; lr: 0.00136; 2553/2069 tok/s;   1308 sec
[2020-08-20 04:23:15,658 INFO] Step 8600/20000; acc:  87.65; ppl:  1.27; xent: 0.24; lr: 0.00135; 2585/2105 tok/s;   1323 sec
[2020-08-20 04:23:30,780 INFO] Step 8700/20000; acc:  87.46; ppl:  1.28; xent: 0.25; lr: 0.00134; 2604/2114 tok/s;   1338 sec
[2020-08-20 04:23:36,227 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_8736.pt
[2020-08-20 04:23:46,269 INFO] Step 8800/20000; acc:  88.12; ppl:  1.27; xent: 0.24; lr: 0.00133; 2548/2067 tok/s;   1354 sec
[2020-08-20 04:24:01,319 INFO] Step 8900/20000; acc:  87.46; ppl:  1.28; xent: 0.25; lr: 0.00132; 2625/2126 tok/s;   1369 sec
[2020-08-20 04:24:16,422 INFO] Step 9000/20000; acc:  87.89; ppl:  1.28; xent: 0.24; lr: 0.00132; 2600/2108 tok/s;   1384 sec
[2020-08-20 04:24:17,775 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:24:17,868 INFO] number of examples: 9920
[2020-08-20 04:24:23,822 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_9048.pt
[2020-08-20 04:24:31,974 INFO] Step 9100/20000; acc:  87.01; ppl:  1.29; xent: 0.26; lr: 0.00131; 2542/2066 tok/s;   1399 sec
[2020-08-20 04:24:47,053 INFO] Step 9200/20000; acc:  87.52; ppl:  1.28; xent: 0.25; lr: 0.00130; 2588/2090 tok/s;   1414 sec
[2020-08-20 04:25:02,271 INFO] Step 9300/20000; acc:  87.46; ppl:  1.28; xent: 0.24; lr: 0.00130; 2587/2109 tok/s;   1430 sec
[2020-08-20 04:25:11,313 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_9360.pt
[2020-08-20 04:25:17,724 INFO] Step 9400/20000; acc:  87.67; ppl:  1.27; xent: 0.24; lr: 0.00129; 2523/2053 tok/s;   1445 sec
[2020-08-20 04:25:32,828 INFO] Step 9500/20000; acc:  87.82; ppl:  1.26; xent: 0.23; lr: 0.00128; 2603/2110 tok/s;   1460 sec
[2020-08-20 04:25:47,944 INFO] Step 9600/20000; acc:  87.30; ppl:  1.28; xent: 0.24; lr: 0.00128; 2585/2106 tok/s;   1475 sec
[2020-08-20 04:25:58,834 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_9672.pt
[2020-08-20 04:26:03,352 INFO] Step 9700/20000; acc:  86.87; ppl:  1.29; xent: 0.26; lr: 0.00127; 2552/2070 tok/s;   1491 sec
[2020-08-20 04:26:18,486 INFO] Step 9800/20000; acc:  86.72; ppl:  1.31; xent: 0.27; lr: 0.00126; 2609/2119 tok/s;   1506 sec
[2020-08-20 04:26:33,496 INFO] Step 9900/20000; acc:  87.71; ppl:  1.27; xent: 0.24; lr: 0.00126; 2630/2129 tok/s;   1521 sec
[2020-08-20 04:26:46,157 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_9984.pt
[2020-08-20 04:26:50,039 INFO] Step 10000/20000; acc:  87.53; ppl:  1.28; xent: 0.25; lr: 0.00125; 2376/1926 tok/s;   1537 sec
[2020-08-20 04:26:50,040 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 04:26:50,044 INFO] number of examples: 620
[2020-08-20 04:26:51,080 INFO] Validation perplexity: 1.3139
[2020-08-20 04:26:51,080 INFO] Validation accuracy: 88.6838
[2020-08-20 04:26:52,579 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:26:52,662 INFO] number of examples: 9920
[2020-08-20 04:27:06,267 INFO] Step 10100/20000; acc:  87.77; ppl:  1.26; xent: 0.23; lr: 0.00124; 2433/1978 tok/s;   1554 sec
[2020-08-20 04:27:21,381 INFO] Step 10200/20000; acc:  87.68; ppl:  1.27; xent: 0.24; lr: 0.00124; 2582/2087 tok/s;   1569 sec
[2020-08-20 04:27:35,902 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_10296.pt
[2020-08-20 04:27:36,824 INFO] Step 10300/20000; acc:  88.07; ppl:  1.26; xent: 0.23; lr: 0.00123; 2547/2075 tok/s;   1584 sec
[2020-08-20 04:27:51,871 INFO] Step 10400/20000; acc:  88.21; ppl:  1.26; xent: 0.23; lr: 0.00123; 2594/2110 tok/s;   1599 sec
[2020-08-20 04:28:06,924 INFO] Step 10500/20000; acc:  88.23; ppl:  1.26; xent: 0.23; lr: 0.00122; 2608/2115 tok/s;   1614 sec
[2020-08-20 04:28:21,985 INFO] Step 10600/20000; acc:  88.16; ppl:  1.25; xent: 0.23; lr: 0.00121; 2596/2114 tok/s;   1629 sec
[2020-08-20 04:28:23,187 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_10608.pt
[2020-08-20 04:28:37,512 INFO] Step 10700/20000; acc:  87.94; ppl:  1.26; xent: 0.23; lr: 0.00121; 2535/2057 tok/s;   1645 sec
[2020-08-20 04:28:52,530 INFO] Step 10800/20000; acc:  88.38; ppl:  1.25; xent: 0.22; lr: 0.00120; 2628/2133 tok/s;   1660 sec
[2020-08-20 04:29:07,559 INFO] Step 10900/20000; acc:  88.17; ppl:  1.26; xent: 0.23; lr: 0.00120; 2627/2127 tok/s;   1675 sec
[2020-08-20 04:29:10,563 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_10920.pt
[2020-08-20 04:29:25,679 INFO] Step 11000/20000; acc:  88.11; ppl:  1.26; xent: 0.23; lr: 0.00119; 2170/1758 tok/s;   1693 sec
[2020-08-20 04:29:27,319 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:29:27,454 INFO] number of examples: 9920
[2020-08-20 04:29:40,851 INFO] Step 11100/20000; acc:  88.15; ppl:  1.25; xent: 0.22; lr: 0.00119; 2605/2118 tok/s;   1708 sec
[2020-08-20 04:29:55,703 INFO] Step 11200/20000; acc:  88.27; ppl:  1.25; xent: 0.22; lr: 0.00118; 2629/2124 tok/s;   1723 sec
[2020-08-20 04:30:00,492 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_11232.pt
[2020-08-20 04:30:11,150 INFO] Step 11300/20000; acc:  88.55; ppl:  1.25; xent: 0.22; lr: 0.00118; 2543/2074 tok/s;   1738 sec
[2020-08-20 04:30:26,063 INFO] Step 11400/20000; acc:  88.32; ppl:  1.25; xent: 0.23; lr: 0.00117; 2619/2129 tok/s;   1753 sec
[2020-08-20 04:30:40,986 INFO] Step 11500/20000; acc:  87.99; ppl:  1.27; xent: 0.24; lr: 0.00117; 2631/2134 tok/s;   1768 sec
[2020-08-20 04:30:47,556 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_11544.pt
[2020-08-20 04:30:56,162 INFO] Step 11600/20000; acc:  88.06; ppl:  1.26; xent: 0.23; lr: 0.00116; 2578/2100 tok/s;   1783 sec
[2020-08-20 04:31:10,991 INFO] Step 11700/20000; acc:  88.18; ppl:  1.26; xent: 0.23; lr: 0.00116; 2648/2150 tok/s;   1798 sec
[2020-08-20 04:31:25,938 INFO] Step 11800/20000; acc:  88.26; ppl:  1.26; xent: 0.23; lr: 0.00115; 2645/2147 tok/s;   1813 sec
[2020-08-20 04:31:34,279 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_11856.pt
[2020-08-20 04:31:41,183 INFO] Step 11900/20000; acc:  86.51; ppl:  1.32; xent: 0.27; lr: 0.00115; 2586/2094 tok/s;   1828 sec
[2020-08-20 04:31:56,084 INFO] Step 12000/20000; acc:  87.89; ppl:  1.28; xent: 0.25; lr: 0.00114; 2639/2139 tok/s;   1843 sec
[2020-08-20 04:31:57,873 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:31:57,959 INFO] number of examples: 9920
[2020-08-20 04:32:11,176 INFO] Step 12100/20000; acc:  88.07; ppl:  1.26; xent: 0.23; lr: 0.00114; 2622/2132 tok/s;   1858 sec
[2020-08-20 04:32:21,237 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_12168.pt
[2020-08-20 04:32:26,671 INFO] Step 12200/20000; acc:  88.33; ppl:  1.26; xent: 0.23; lr: 0.00113; 2517/2033 tok/s;   1874 sec
[2020-08-20 04:32:41,602 INFO] Step 12300/20000; acc:  88.42; ppl:  1.25; xent: 0.23; lr: 0.00113; 2634/2148 tok/s;   1889 sec
[2020-08-20 04:32:56,475 INFO] Step 12400/20000; acc:  88.26; ppl:  1.26; xent: 0.23; lr: 0.00112; 2625/2133 tok/s;   1904 sec
[2020-08-20 04:33:08,430 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_12480.pt
[2020-08-20 04:33:11,703 INFO] Step 12500/20000; acc:  88.45; ppl:  1.25; xent: 0.23; lr: 0.00112; 2576/2090 tok/s;   1919 sec
[2020-08-20 04:33:26,600 INFO] Step 12600/20000; acc:  88.47; ppl:  1.25; xent: 0.22; lr: 0.00111; 2627/2140 tok/s;   1934 sec
[2020-08-20 04:33:41,549 INFO] Step 12700/20000; acc:  88.41; ppl:  1.25; xent: 0.22; lr: 0.00111; 2627/2133 tok/s;   1949 sec
[2020-08-20 04:33:55,241 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_12792.pt
[2020-08-20 04:33:56,707 INFO] Step 12800/20000; acc:  88.67; ppl:  1.25; xent: 0.22; lr: 0.00110; 2608/2115 tok/s;   1964 sec
[2020-08-20 04:34:11,551 INFO] Step 12900/20000; acc:  88.17; ppl:  1.25; xent: 0.23; lr: 0.00110; 2659/2154 tok/s;   1979 sec
[2020-08-20 04:34:26,415 INFO] Step 13000/20000; acc:  87.94; ppl:  1.27; xent: 0.24; lr: 0.00110; 2646/2144 tok/s;   1994 sec
[2020-08-20 04:34:28,338 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:34:28,425 INFO] number of examples: 9920
[2020-08-20 04:34:41,407 INFO] Step 13100/20000; acc:  88.15; ppl:  1.26; xent: 0.23; lr: 0.00109; 2636/2143 tok/s;   2009 sec
[2020-08-20 04:34:42,000 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_13104.pt
[2020-08-20 04:34:57,597 INFO] Step 13200/20000; acc:  88.08; ppl:  1.26; xent: 0.23; lr: 0.00109; 2411/1948 tok/s;   2025 sec
[2020-08-20 04:35:12,507 INFO] Step 13300/20000; acc:  88.10; ppl:  1.26; xent: 0.23; lr: 0.00108; 2636/2147 tok/s;   2040 sec
[2020-08-20 04:35:27,377 INFO] Step 13400/20000; acc:  88.40; ppl:  1.25; xent: 0.22; lr: 0.00108; 2627/2136 tok/s;   2055 sec
[2020-08-20 04:35:29,764 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_13416.pt
[2020-08-20 04:35:42,571 INFO] Step 13500/20000; acc:  88.42; ppl:  1.25; xent: 0.22; lr: 0.00108; 2579/2091 tok/s;   2070 sec
[2020-08-20 04:35:57,451 INFO] Step 13600/20000; acc:  88.41; ppl:  1.25; xent: 0.22; lr: 0.00107; 2631/2144 tok/s;   2085 sec
[2020-08-20 04:36:12,393 INFO] Step 13700/20000; acc:  88.45; ppl:  1.25; xent: 0.22; lr: 0.00107; 2627/2132 tok/s;   2100 sec
[2020-08-20 04:36:16,575 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_13728.pt
[2020-08-20 04:36:27,707 INFO] Step 13800/20000; acc:  88.51; ppl:  1.25; xent: 0.22; lr: 0.00106; 2584/2098 tok/s;   2115 sec
[2020-08-20 04:36:42,578 INFO] Step 13900/20000; acc:  88.58; ppl:  1.25; xent: 0.22; lr: 0.00106; 2655/2151 tok/s;   2130 sec
[2020-08-20 04:36:57,431 INFO] Step 14000/20000; acc:  87.94; ppl:  1.26; xent: 0.23; lr: 0.00106; 2648/2145 tok/s;   2145 sec
[2020-08-20 04:36:59,519 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:36:59,614 INFO] number of examples: 9920
[2020-08-20 04:37:03,559 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_14040.pt
[2020-08-20 04:37:17,698 INFO] Step 14100/20000; acc:  88.24; ppl:  1.26; xent: 0.23; lr: 0.00105; 1946/1581 tok/s;   2165 sec
[2020-08-20 04:37:32,531 INFO] Step 14200/20000; acc:  88.24; ppl:  1.25; xent: 0.23; lr: 0.00105; 2637/2132 tok/s;   2180 sec
[2020-08-20 04:37:47,407 INFO] Step 14300/20000; acc:  88.48; ppl:  1.25; xent: 0.22; lr: 0.00105; 2641/2151 tok/s;   2195 sec
[2020-08-20 04:37:55,126 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_14352.pt
[2020-08-20 04:38:03,304 INFO] Step 14400/20000; acc:  88.40; ppl:  1.25; xent: 0.22; lr: 0.00104; 2459/1999 tok/s;   2211 sec
[2020-08-20 04:38:18,183 INFO] Step 14500/20000; acc:  88.53; ppl:  1.25; xent: 0.22; lr: 0.00104; 2632/2134 tok/s;   2225 sec
[2020-08-20 04:38:33,040 INFO] Step 14600/20000; acc:  88.76; ppl:  1.24; xent: 0.21; lr: 0.00103; 2633/2144 tok/s;   2240 sec
[2020-08-20 04:38:42,574 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_14664.pt
[2020-08-20 04:38:48,267 INFO] Step 14700/20000; acc:  88.02; ppl:  1.26; xent: 0.23; lr: 0.00103; 2582/2097 tok/s;   2256 sec
[2020-08-20 04:39:03,139 INFO] Step 14800/20000; acc:  88.70; ppl:  1.25; xent: 0.22; lr: 0.00103; 2661/2161 tok/s;   2270 sec
[2020-08-20 04:39:17,979 INFO] Step 14900/20000; acc:  88.60; ppl:  1.24; xent: 0.22; lr: 0.00102; 2659/2154 tok/s;   2285 sec
[2020-08-20 04:39:29,308 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_14976.pt
[2020-08-20 04:39:33,143 INFO] Step 15000/20000; acc:  88.63; ppl:  1.25; xent: 0.22; lr: 0.00102; 2591/2100 tok/s;   2300 sec
[2020-08-20 04:39:35,375 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:39:35,464 INFO] number of examples: 9920
[2020-08-20 04:39:48,165 INFO] Step 15100/20000; acc:  88.38; ppl:  1.25; xent: 0.22; lr: 0.00102; 2626/2134 tok/s;   2315 sec
[2020-08-20 04:40:02,999 INFO] Step 15200/20000; acc:  87.81; ppl:  1.27; xent: 0.24; lr: 0.00101; 2640/2134 tok/s;   2330 sec
[2020-08-20 04:40:16,117 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_15288.pt
[2020-08-20 04:40:18,272 INFO] Step 15300/20000; acc:  88.26; ppl:  1.26; xent: 0.23; lr: 0.00101; 2569/2092 tok/s;   2346 sec
[2020-08-20 04:40:33,134 INFO] Step 15400/20000; acc:  88.67; ppl:  1.25; xent: 0.22; lr: 0.00101; 2628/2136 tok/s;   2360 sec
[2020-08-20 04:40:48,037 INFO] Step 15500/20000; acc:  88.72; ppl:  1.24; xent: 0.22; lr: 0.00100; 2629/2133 tok/s;   2375 sec
[2020-08-20 04:41:02,931 INFO] Step 15600/20000; acc:  89.02; ppl:  1.23; xent: 0.21; lr: 0.00100; 2629/2140 tok/s;   2390 sec
[2020-08-20 04:41:02,932 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_15600.pt
[2020-08-20 04:41:18,165 INFO] Step 15700/20000; acc:  88.86; ppl:  1.24; xent: 0.21; lr: 0.00100; 2581/2098 tok/s;   2405 sec
[2020-08-20 04:41:33,066 INFO] Step 15800/20000; acc:  88.90; ppl:  1.24; xent: 0.21; lr: 0.00099; 2652/2153 tok/s;   2420 sec
[2020-08-20 04:41:48,000 INFO] Step 15900/20000; acc:  89.13; ppl:  1.24; xent: 0.21; lr: 0.00099; 2647/2143 tok/s;   2435 sec
[2020-08-20 04:41:49,790 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_15912.pt
[2020-08-20 04:42:03,124 INFO] Step 16000/20000; acc:  88.97; ppl:  1.24; xent: 0.22; lr: 0.00099; 2596/2104 tok/s;   2450 sec
[2020-08-20 04:42:05,487 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:42:05,576 INFO] number of examples: 9920
[2020-08-20 04:42:18,157 INFO] Step 16100/20000; acc:  88.81; ppl:  1.25; xent: 0.22; lr: 0.00099; 2626/2133 tok/s;   2465 sec
[2020-08-20 04:42:33,006 INFO] Step 16200/20000; acc:  88.67; ppl:  1.24; xent: 0.22; lr: 0.00098; 2632/2128 tok/s;   2480 sec
[2020-08-20 04:42:36,564 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_16224.pt
[2020-08-20 04:42:48,194 INFO] Step 16300/20000; acc:  89.08; ppl:  1.24; xent: 0.21; lr: 0.00098; 2589/2110 tok/s;   2495 sec
[2020-08-20 04:43:03,003 INFO] Step 16400/20000; acc:  88.53; ppl:  1.25; xent: 0.22; lr: 0.00098; 2638/2142 tok/s;   2510 sec
[2020-08-20 04:43:17,792 INFO] Step 16500/20000; acc:  88.51; ppl:  1.26; xent: 0.23; lr: 0.00097; 2645/2146 tok/s;   2525 sec
[2020-08-20 04:43:23,090 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_16536.pt
[2020-08-20 04:43:33,348 INFO] Step 16600/20000; acc:  88.35; ppl:  1.26; xent: 0.23; lr: 0.00097; 2517/2048 tok/s;   2541 sec
[2020-08-20 04:43:48,093 INFO] Step 16700/20000; acc:  89.20; ppl:  1.24; xent: 0.21; lr: 0.00097; 2667/2169 tok/s;   2555 sec
[2020-08-20 04:44:02,834 INFO] Step 16800/20000; acc:  89.37; ppl:  1.23; xent: 0.21; lr: 0.00096; 2685/2179 tok/s;   2570 sec
[2020-08-20 04:44:09,916 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_16848.pt
[2020-08-20 04:44:17,856 INFO] Step 16900/20000; acc:  89.33; ppl:  1.23; xent: 0.21; lr: 0.00096; 2627/2127 tok/s;   2585 sec
[2020-08-20 04:44:32,648 INFO] Step 17000/20000; acc:  89.13; ppl:  1.23; xent: 0.21; lr: 0.00096; 2657/2154 tok/s;   2600 sec
[2020-08-20 04:44:35,147 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:44:35,237 INFO] number of examples: 9920
[2020-08-20 04:44:47,557 INFO] Step 17100/20000; acc:  89.12; ppl:  1.24; xent: 0.21; lr: 0.00096; 2648/2151 tok/s;   2615 sec
[2020-08-20 04:44:56,407 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_17160.pt
[2020-08-20 04:45:02,630 INFO] Step 17200/20000; acc:  89.30; ppl:  1.23; xent: 0.21; lr: 0.00095; 2593/2098 tok/s;   2630 sec
[2020-08-20 04:45:17,419 INFO] Step 17300/20000; acc:  89.27; ppl:  1.23; xent: 0.21; lr: 0.00095; 2658/2164 tok/s;   2645 sec
[2020-08-20 04:45:32,107 INFO] Step 17400/20000; acc:  89.37; ppl:  1.23; xent: 0.20; lr: 0.00095; 2660/2160 tok/s;   2659 sec
[2020-08-20 04:45:42,673 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_17472.pt
[2020-08-20 04:45:47,359 INFO] Step 17500/20000; acc:  89.21; ppl:  1.24; xent: 0.21; lr: 0.00094; 2564/2082 tok/s;   2675 sec
[2020-08-20 04:46:02,108 INFO] Step 17600/20000; acc:  89.68; ppl:  1.22; xent: 0.20; lr: 0.00094; 2655/2160 tok/s;   2689 sec
[2020-08-20 04:46:16,878 INFO] Step 17700/20000; acc:  89.36; ppl:  1.23; xent: 0.21; lr: 0.00094; 2662/2165 tok/s;   2704 sec
[2020-08-20 04:46:29,322 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_17784.pt
[2020-08-20 04:46:32,863 INFO] Step 17800/20000; acc:  88.99; ppl:  1.25; xent: 0.22; lr: 0.00094; 2474/2007 tok/s;   2720 sec
[2020-08-20 04:46:47,618 INFO] Step 17900/20000; acc:  89.30; ppl:  1.23; xent: 0.21; lr: 0.00093; 2676/2167 tok/s;   2735 sec
[2020-08-20 04:47:02,424 INFO] Step 18000/20000; acc:  88.79; ppl:  1.25; xent: 0.22; lr: 0.00093; 2654/2153 tok/s;   2750 sec
[2020-08-20 04:47:05,056 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:47:05,147 INFO] number of examples: 9920
[2020-08-20 04:47:16,705 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_18096.pt
[2020-08-20 04:47:17,658 INFO] Step 18100/20000; acc:  89.04; ppl:  1.24; xent: 0.22; lr: 0.00093; 2588/2101 tok/s;   2765 sec
[2020-08-20 04:47:32,398 INFO] Step 18200/20000; acc:  89.19; ppl:  1.24; xent: 0.21; lr: 0.00093; 2658/2151 tok/s;   2780 sec
[2020-08-20 04:47:47,155 INFO] Step 18300/20000; acc:  89.55; ppl:  1.23; xent: 0.21; lr: 0.00092; 2662/2168 tok/s;   2794 sec
[2020-08-20 04:48:01,915 INFO] Step 18400/20000; acc:  89.62; ppl:  1.23; xent: 0.20; lr: 0.00092; 2646/2148 tok/s;   2809 sec
[2020-08-20 04:48:03,094 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_18408.pt
[2020-08-20 04:48:16,973 INFO] Step 18500/20000; acc:  89.55; ppl:  1.23; xent: 0.21; lr: 0.00092; 2601/2112 tok/s;   2824 sec
[2020-08-20 04:48:31,878 INFO] Step 18600/20000; acc:  89.84; ppl:  1.22; xent: 0.20; lr: 0.00092; 2624/2134 tok/s;   2839 sec
[2020-08-20 04:48:46,825 INFO] Step 18700/20000; acc:  89.58; ppl:  1.23; xent: 0.21; lr: 0.00091; 2632/2140 tok/s;   2854 sec
[2020-08-20 04:48:49,798 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_18720.pt
[2020-08-20 04:49:02,026 INFO] Step 18800/20000; acc:  89.59; ppl:  1.23; xent: 0.20; lr: 0.00091; 2600/2109 tok/s;   2869 sec
[2020-08-20 04:49:16,926 INFO] Step 18900/20000; acc:  89.57; ppl:  1.23; xent: 0.21; lr: 0.00091; 2652/2148 tok/s;   2884 sec
[2020-08-20 04:49:31,859 INFO] Step 19000/20000; acc:  89.34; ppl:  1.23; xent: 0.21; lr: 0.00091; 2626/2130 tok/s;   2899 sec
[2020-08-20 04:49:34,681 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:49:34,725 INFO] number of examples: 9920
[2020-08-20 04:49:36,800 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_19032.pt
[2020-08-20 04:49:47,169 INFO] Step 19100/20000; acc:  89.68; ppl:  1.23; xent: 0.20; lr: 0.00090; 2582/2095 tok/s;   2914 sec
[2020-08-20 04:50:02,072 INFO] Step 19200/20000; acc:  89.30; ppl:  1.24; xent: 0.21; lr: 0.00090; 2629/2128 tok/s;   2929 sec
[2020-08-20 04:50:16,984 INFO] Step 19300/20000; acc:  89.66; ppl:  1.22; xent: 0.20; lr: 0.00090; 2630/2143 tok/s;   2944 sec
[2020-08-20 04:50:23,554 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_19344.pt
[2020-08-20 04:50:32,181 INFO] Step 19400/20000; acc:  89.93; ppl:  1.22; xent: 0.20; lr: 0.00090; 2571/2087 tok/s;   2959 sec
[2020-08-20 04:50:47,072 INFO] Step 19500/20000; acc:  89.73; ppl:  1.23; xent: 0.20; lr: 0.00090; 2629/2135 tok/s;   2974 sec
[2020-08-20 04:51:01,934 INFO] Step 19600/20000; acc:  90.04; ppl:  1.22; xent: 0.20; lr: 0.00089; 2637/2143 tok/s;   2989 sec
[2020-08-20 04:51:10,294 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_19656.pt
[2020-08-20 04:51:17,148 INFO] Step 19700/20000; acc:  89.85; ppl:  1.22; xent: 0.20; lr: 0.00089; 2582/2099 tok/s;   3004 sec
[2020-08-20 04:51:32,053 INFO] Step 19800/20000; acc:  89.77; ppl:  1.22; xent: 0.20; lr: 0.00089; 2654/2154 tok/s;   3019 sec
[2020-08-20 04:51:46,934 INFO] Step 19900/20000; acc:  89.82; ppl:  1.22; xent: 0.20; lr: 0.00089; 2651/2148 tok/s;   3034 sec
[2020-08-20 04:51:57,092 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_19968.pt
[2020-08-20 04:52:02,189 INFO] Step 20000/20000; acc:  89.83; ppl:  1.22; xent: 0.20; lr: 0.00088; 2574/2087 tok/s;   3049 sec
[2020-08-20 04:52:02,190 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 04:52:02,213 INFO] number of examples: 620
[2020-08-20 04:52:03,221 INFO] Validation perplexity: 1.25034
[2020-08-20 04:52:03,222 INFO] Validation accuracy: 91.5028
[2020-08-20 04:52:03,223 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv7/toy_model_step_20000.pt
[2020-08-20 04:52:04,724 INFO]  * src vocab size = 20
[2020-08-20 04:52:04,724 INFO]  * tgt vocab size = 20
[2020-08-20 04:52:04,724 INFO] Building model...
[2020-08-20 04:52:06,890 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=256, out_features=20, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-08-20 04:52:06,892 INFO] encoder: 5265920
[2020-08-20 04:52:06,892 INFO] decoder: 6320660
[2020-08-20 04:52:06,892 INFO] * number of parameters: 11586580
[2020-08-20 04:52:06,897 INFO] Starting training on GPU: [0]
[2020-08-20 04:52:06,897 INFO] Start training loop and validate every 10000 steps...
[2020-08-20 04:52:06,897 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:52:06,971 INFO] number of examples: 9920
[2020-08-20 04:52:22,941 INFO] Step 100/20000; acc:  51.48; ppl:  3.53; xent: 1.26; lr: 0.00014; 2468/2007 tok/s;     16 sec
[2020-08-20 04:52:38,621 INFO] Step 200/20000; acc:  73.28; ppl:  1.84; xent: 0.61; lr: 0.00028; 2504/2045 tok/s;     32 sec
[2020-08-20 04:52:54,240 INFO] Step 300/20000; acc:  78.44; ppl:  1.62; xent: 0.49; lr: 0.00042; 2507/2036 tok/s;     47 sec
[2020-08-20 04:52:56,109 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_312.pt
[2020-08-20 04:53:10,174 INFO] Step 400/20000; acc:  81.17; ppl:  1.52; xent: 0.42; lr: 0.00056; 2471/1994 tok/s;     63 sec
[2020-08-20 04:53:25,814 INFO] Step 500/20000; acc:  83.25; ppl:  1.45; xent: 0.37; lr: 0.00070; 2540/2059 tok/s;     79 sec
[2020-08-20 04:53:41,378 INFO] Step 600/20000; acc:  83.92; ppl:  1.43; xent: 0.35; lr: 0.00084; 2515/2049 tok/s;     94 sec
[2020-08-20 04:53:45,112 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_624.pt
[2020-08-20 04:53:57,283 INFO] Step 700/20000; acc:  85.01; ppl:  1.40; xent: 0.33; lr: 0.00098; 2448/1985 tok/s;    110 sec
[2020-08-20 04:54:12,796 INFO] Step 800/20000; acc:  85.68; ppl:  1.36; xent: 0.31; lr: 0.00112; 2523/2041 tok/s;    126 sec
[2020-08-20 04:54:28,115 INFO] Step 900/20000; acc:  85.29; ppl:  1.38; xent: 0.32; lr: 0.00126; 2579/2094 tok/s;    141 sec
[2020-08-20 04:54:33,583 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_936.pt
[2020-08-20 04:54:43,687 INFO] Step 1000/20000; acc:  86.27; ppl:  1.35; xent: 0.30; lr: 0.00140; 2516/2045 tok/s;    157 sec
[2020-08-20 04:54:43,843 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:54:43,932 INFO] number of examples: 9920
[2020-08-20 04:54:59,090 INFO] Step 1100/20000; acc:  85.91; ppl:  1.36; xent: 0.31; lr: 0.00154; 2571/2090 tok/s;    172 sec
[2020-08-20 04:55:14,358 INFO] Step 1200/20000; acc:  86.08; ppl:  1.35; xent: 0.30; lr: 0.00168; 2558/2089 tok/s;    187 sec
[2020-08-20 04:55:21,712 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_1248.pt
[2020-08-20 04:55:30,031 INFO] Step 1300/20000; acc:  86.61; ppl:  1.34; xent: 0.29; lr: 0.00182; 2504/2033 tok/s;    203 sec
[2020-08-20 04:55:45,304 INFO] Step 1400/20000; acc:  85.45; ppl:  1.36; xent: 0.31; lr: 0.00196; 2578/2081 tok/s;    218 sec
[2020-08-20 04:56:00,517 INFO] Step 1500/20000; acc:  85.13; ppl:  1.38; xent: 0.32; lr: 0.00210; 2608/2114 tok/s;    234 sec
[2020-08-20 04:56:09,756 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_1560.pt
[2020-08-20 04:56:16,200 INFO] Step 1600/20000; acc:  85.38; ppl:  1.37; xent: 0.31; lr: 0.00224; 2497/2035 tok/s;    249 sec
[2020-08-20 04:56:31,599 INFO] Step 1700/20000; acc:  85.59; ppl:  1.37; xent: 0.31; lr: 0.00238; 2527/2049 tok/s;    265 sec
[2020-08-20 04:56:46,984 INFO] Step 1800/20000; acc:  84.20; ppl:  1.40; xent: 0.34; lr: 0.00252; 2545/2059 tok/s;    280 sec
[2020-08-20 04:56:58,033 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_1872.pt
[2020-08-20 04:57:02,642 INFO] Step 1900/20000; acc:  84.10; ppl:  1.40; xent: 0.34; lr: 0.00266; 2526/2050 tok/s;    296 sec
[2020-08-20 04:57:18,102 INFO] Step 2000/20000; acc:  85.01; ppl:  1.39; xent: 0.33; lr: 0.00279; 2535/2059 tok/s;    311 sec
[2020-08-20 04:57:18,411 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:57:18,452 INFO] number of examples: 9920
[2020-08-20 04:57:33,683 INFO] Step 2100/20000; acc:  84.28; ppl:  1.41; xent: 0.34; lr: 0.00273; 2541/2065 tok/s;    327 sec
[2020-08-20 04:57:46,554 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_2184.pt
[2020-08-20 04:57:49,459 INFO] Step 2200/20000; acc:  84.45; ppl:  1.40; xent: 0.34; lr: 0.00266; 2473/2021 tok/s;    343 sec
[2020-08-20 04:58:04,823 INFO] Step 2300/20000; acc:  84.15; ppl:  1.40; xent: 0.34; lr: 0.00261; 2556/2076 tok/s;    358 sec
[2020-08-20 04:58:20,086 INFO] Step 2400/20000; acc:  84.17; ppl:  1.40; xent: 0.34; lr: 0.00255; 2579/2080 tok/s;    373 sec
[2020-08-20 04:58:34,700 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_2496.pt
[2020-08-20 04:58:35,580 INFO] Step 2500/20000; acc:  85.65; ppl:  1.35; xent: 0.30; lr: 0.00250; 2561/2077 tok/s;    389 sec
[2020-08-20 04:58:50,840 INFO] Step 2600/20000; acc:  85.03; ppl:  1.37; xent: 0.31; lr: 0.00245; 2562/2087 tok/s;    404 sec
[2020-08-20 04:59:06,074 INFO] Step 2700/20000; acc:  85.21; ppl:  1.37; xent: 0.32; lr: 0.00241; 2556/2072 tok/s;    419 sec
[2020-08-20 04:59:21,317 INFO] Step 2800/20000; acc:  85.94; ppl:  1.34; xent: 0.29; lr: 0.00236; 2572/2082 tok/s;    434 sec
[2020-08-20 04:59:22,530 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_2808.pt
[2020-08-20 04:59:37,899 INFO] Step 2900/20000; acc:  86.58; ppl:  1.32; xent: 0.28; lr: 0.00232; 2379/1930 tok/s;    451 sec
[2020-08-20 04:59:53,234 INFO] Step 3000/20000; acc:  85.40; ppl:  1.37; xent: 0.31; lr: 0.00228; 2559/2080 tok/s;    466 sec
[2020-08-20 04:59:53,695 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 04:59:53,737 INFO] number of examples: 9920
[2020-08-20 05:00:08,682 INFO] Step 3100/20000; acc:  83.37; ppl:  1.43; xent: 0.36; lr: 0.00224; 2561/2081 tok/s;    482 sec
[2020-08-20 05:00:11,755 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_3120.pt
[2020-08-20 05:00:24,324 INFO] Step 3200/20000; acc:  85.37; ppl:  1.36; xent: 0.31; lr: 0.00221; 2497/2040 tok/s;    497 sec
[2020-08-20 05:00:39,687 INFO] Step 3300/20000; acc:  84.58; ppl:  1.38; xent: 0.33; lr: 0.00218; 2555/2076 tok/s;    513 sec
[2020-08-20 05:00:55,029 INFO] Step 3400/20000; acc:  84.33; ppl:  1.39; xent: 0.33; lr: 0.00214; 2567/2071 tok/s;    528 sec
[2020-08-20 05:00:59,946 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_3432.pt
[2020-08-20 05:01:11,043 INFO] Step 3500/20000; acc:  83.86; ppl:  1.40; xent: 0.33; lr: 0.00211; 2478/2009 tok/s;    544 sec
[2020-08-20 05:01:26,310 INFO] Step 3600/20000; acc:  84.94; ppl:  1.37; xent: 0.31; lr: 0.00208; 2562/2088 tok/s;    559 sec
[2020-08-20 05:01:41,563 INFO] Step 3700/20000; acc:  82.97; ppl:  1.45; xent: 0.37; lr: 0.00205; 2549/2068 tok/s;    575 sec
[2020-08-20 05:01:48,299 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_3744.pt
[2020-08-20 05:01:57,222 INFO] Step 3800/20000; acc:  81.07; ppl:  1.50; xent: 0.41; lr: 0.00203; 2504/2025 tok/s;    590 sec
[2020-08-20 05:02:12,549 INFO] Step 3900/20000; acc:  84.38; ppl:  1.38; xent: 0.32; lr: 0.00200; 2574/2088 tok/s;    606 sec
[2020-08-20 05:02:27,855 INFO] Step 4000/20000; acc:  85.63; ppl:  1.33; xent: 0.29; lr: 0.00198; 2562/2081 tok/s;    621 sec
[2020-08-20 05:02:28,473 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:02:28,516 INFO] number of examples: 9920
[2020-08-20 05:02:36,562 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_4056.pt
[2020-08-20 05:02:43,553 INFO] Step 4100/20000; acc:  85.58; ppl:  1.34; xent: 0.29; lr: 0.00195; 2522/2050 tok/s;    637 sec
[2020-08-20 05:02:58,850 INFO] Step 4200/20000; acc:  85.75; ppl:  1.34; xent: 0.29; lr: 0.00193; 2555/2087 tok/s;    652 sec
[2020-08-20 05:03:14,144 INFO] Step 4300/20000; acc:  85.26; ppl:  1.36; xent: 0.31; lr: 0.00191; 2569/2087 tok/s;    667 sec
[2020-08-20 05:03:24,576 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_4368.pt
[2020-08-20 05:03:29,848 INFO] Step 4400/20000; acc:  85.33; ppl:  1.34; xent: 0.30; lr: 0.00188; 2509/2025 tok/s;    683 sec
[2020-08-20 05:03:45,127 INFO] Step 4500/20000; acc:  83.56; ppl:  1.42; xent: 0.35; lr: 0.00186; 2593/2102 tok/s;    698 sec
[2020-08-20 05:04:00,450 INFO] Step 4600/20000; acc:  84.40; ppl:  1.37; xent: 0.31; lr: 0.00184; 2551/2078 tok/s;    714 sec
[2020-08-20 05:04:12,704 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_4680.pt
[2020-08-20 05:04:17,026 INFO] Step 4700/20000; acc:  85.81; ppl:  1.33; xent: 0.29; lr: 0.00182; 2351/1907 tok/s;    730 sec
[2020-08-20 05:04:32,359 INFO] Step 4800/20000; acc:  86.05; ppl:  1.33; xent: 0.28; lr: 0.00180; 2551/2064 tok/s;    745 sec
[2020-08-20 05:04:47,708 INFO] Step 4900/20000; acc:  86.08; ppl:  1.32; xent: 0.28; lr: 0.00179; 2574/2088 tok/s;    761 sec
[2020-08-20 05:05:01,814 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_4992.pt
[2020-08-20 05:05:07,166 INFO] Step 5000/20000; acc:  86.49; ppl:  1.31; xent: 0.27; lr: 0.00177; 2015/1638 tok/s;    780 sec
[2020-08-20 05:05:07,929 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:05:07,972 INFO] number of examples: 9920
[2020-08-20 05:05:22,533 INFO] Step 5100/20000; acc:  86.00; ppl:  1.33; xent: 0.28; lr: 0.00175; 2578/2095 tok/s;    796 sec
[2020-08-20 05:05:37,774 INFO] Step 5200/20000; acc:  85.57; ppl:  1.35; xent: 0.30; lr: 0.00173; 2567/2097 tok/s;    811 sec
[2020-08-20 05:05:53,035 INFO] Step 5300/20000; acc:  84.09; ppl:  1.39; xent: 0.33; lr: 0.00172; 2574/2091 tok/s;    826 sec
[2020-08-20 05:05:53,651 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_5304.pt
[2020-08-20 05:06:08,604 INFO] Step 5400/20000; acc:  85.41; ppl:  1.35; xent: 0.30; lr: 0.00170; 2528/2040 tok/s;    842 sec
[2020-08-20 05:06:23,856 INFO] Step 5500/20000; acc:  86.47; ppl:  1.31; xent: 0.27; lr: 0.00169; 2599/2107 tok/s;    857 sec
[2020-08-20 05:06:39,093 INFO] Step 5600/20000; acc:  86.58; ppl:  1.30; xent: 0.27; lr: 0.00167; 2562/2086 tok/s;    872 sec
[2020-08-20 05:06:41,524 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_5616.pt
[2020-08-20 05:06:54,675 INFO] Step 5700/20000; acc:  86.39; ppl:  1.32; xent: 0.28; lr: 0.00166; 2505/2032 tok/s;    888 sec
[2020-08-20 05:07:09,955 INFO] Step 5800/20000; acc:  86.72; ppl:  1.30; xent: 0.26; lr: 0.00164; 2556/2069 tok/s;    903 sec
[2020-08-20 05:07:25,203 INFO] Step 5900/20000; acc:  86.52; ppl:  1.30; xent: 0.26; lr: 0.00163; 2594/2103 tok/s;    918 sec
[2020-08-20 05:07:29,487 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_5928.pt
[2020-08-20 05:07:40,882 INFO] Step 6000/20000; acc:  86.85; ppl:  1.30; xent: 0.26; lr: 0.00161; 2499/2031 tok/s;    934 sec
[2020-08-20 05:07:41,802 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:07:41,878 INFO] number of examples: 9920
[2020-08-20 05:07:56,364 INFO] Step 6100/20000; acc:  85.79; ppl:  1.34; xent: 0.29; lr: 0.00160; 2556/2078 tok/s;    949 sec
[2020-08-20 05:08:11,669 INFO] Step 6200/20000; acc:  86.12; ppl:  1.33; xent: 0.28; lr: 0.00159; 2562/2092 tok/s;    965 sec
[2020-08-20 05:08:17,807 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_6240.pt
[2020-08-20 05:08:27,502 INFO] Step 6300/20000; acc:  85.51; ppl:  1.34; xent: 0.30; lr: 0.00157; 2476/2012 tok/s;    981 sec
[2020-08-20 05:08:42,770 INFO] Step 6400/20000; acc:  85.08; ppl:  1.36; xent: 0.31; lr: 0.00156; 2581/2083 tok/s;    996 sec
[2020-08-20 05:08:57,971 INFO] Step 6500/20000; acc:  83.25; ppl:  1.44; xent: 0.36; lr: 0.00155; 2605/2111 tok/s;   1011 sec
[2020-08-20 05:09:05,853 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_6552.pt
[2020-08-20 05:09:13,523 INFO] Step 6600/20000; acc:  85.76; ppl:  1.33; xent: 0.28; lr: 0.00154; 2511/2046 tok/s;   1027 sec
[2020-08-20 05:09:28,609 INFO] Step 6700/20000; acc:  86.45; ppl:  1.31; xent: 0.27; lr: 0.00153; 2588/2100 tok/s;   1042 sec
[2020-08-20 05:09:43,748 INFO] Step 6800/20000; acc:  86.87; ppl:  1.29; xent: 0.26; lr: 0.00152; 2579/2086 tok/s;   1057 sec
[2020-08-20 05:09:53,456 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_6864.pt
[2020-08-20 05:09:59,190 INFO] Step 6900/20000; acc:  86.60; ppl:  1.30; xent: 0.26; lr: 0.00150; 2560/2076 tok/s;   1072 sec
[2020-08-20 05:10:14,424 INFO] Step 7000/20000; acc:  86.92; ppl:  1.29; xent: 0.26; lr: 0.00149; 2575/2092 tok/s;   1088 sec
[2020-08-20 05:10:15,475 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:10:15,550 INFO] number of examples: 9920
[2020-08-20 05:10:29,769 INFO] Step 7100/20000; acc:  87.00; ppl:  1.29; xent: 0.26; lr: 0.00148; 2581/2098 tok/s;   1103 sec
[2020-08-20 05:10:41,308 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_7176.pt
[2020-08-20 05:10:45,286 INFO] Step 7200/20000; acc:  86.51; ppl:  1.31; xent: 0.27; lr: 0.00147; 2525/2062 tok/s;   1118 sec
[2020-08-20 05:11:00,429 INFO] Step 7300/20000; acc:  86.75; ppl:  1.30; xent: 0.26; lr: 0.00146; 2590/2104 tok/s;   1134 sec
[2020-08-20 05:11:15,507 INFO] Step 7400/20000; acc:  86.46; ppl:  1.31; xent: 0.27; lr: 0.00145; 2613/2109 tok/s;   1149 sec
[2020-08-20 05:11:28,817 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_7488.pt
[2020-08-20 05:11:31,875 INFO] Step 7500/20000; acc:  85.51; ppl:  1.35; xent: 0.30; lr: 0.00144; 2420/1961 tok/s;   1165 sec
[2020-08-20 05:11:47,034 INFO] Step 7600/20000; acc:  85.10; ppl:  1.35; xent: 0.30; lr: 0.00143; 2577/2100 tok/s;   1180 sec
[2020-08-20 05:12:02,093 INFO] Step 7700/20000; acc:  86.13; ppl:  1.32; xent: 0.28; lr: 0.00142; 2590/2102 tok/s;   1195 sec
[2020-08-20 05:12:17,260 INFO] Step 7800/20000; acc:  86.44; ppl:  1.31; xent: 0.27; lr: 0.00142; 2580/2086 tok/s;   1210 sec
[2020-08-20 05:12:17,262 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_7800.pt
[2020-08-20 05:12:32,769 INFO] Step 7900/20000; acc:  86.58; ppl:  1.31; xent: 0.27; lr: 0.00141; 2549/2068 tok/s;   1226 sec
[2020-08-20 05:12:47,983 INFO] Step 8000/20000; acc:  86.42; ppl:  1.31; xent: 0.27; lr: 0.00140; 2575/2092 tok/s;   1241 sec
[2020-08-20 05:12:49,196 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:12:49,314 INFO] number of examples: 9920
[2020-08-20 05:13:03,264 INFO] Step 8100/20000; acc:  86.59; ppl:  1.30; xent: 0.26; lr: 0.00139; 2592/2106 tok/s;   1256 sec
[2020-08-20 05:13:05,085 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_8112.pt
[2020-08-20 05:13:19,792 INFO] Step 8200/20000; acc:  87.06; ppl:  1.29; xent: 0.26; lr: 0.00138; 2369/1935 tok/s;   1273 sec
[2020-08-20 05:13:34,986 INFO] Step 8300/20000; acc:  87.00; ppl:  1.29; xent: 0.26; lr: 0.00137; 2580/2096 tok/s;   1288 sec
[2020-08-20 05:13:50,200 INFO] Step 8400/20000; acc:  87.27; ppl:  1.28; xent: 0.25; lr: 0.00136; 2593/2093 tok/s;   1303 sec
[2020-08-20 05:13:53,843 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_8424.pt
[2020-08-20 05:14:06,656 INFO] Step 8500/20000; acc:  87.30; ppl:  1.28; xent: 0.25; lr: 0.00136; 2404/1948 tok/s;   1320 sec
[2020-08-20 05:14:21,855 INFO] Step 8600/20000; acc:  87.25; ppl:  1.28; xent: 0.25; lr: 0.00135; 2575/2098 tok/s;   1335 sec
[2020-08-20 05:14:36,971 INFO] Step 8700/20000; acc:  87.43; ppl:  1.27; xent: 0.24; lr: 0.00134; 2575/2090 tok/s;   1350 sec
[2020-08-20 05:14:42,446 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_8736.pt
[2020-08-20 05:14:52,535 INFO] Step 8800/20000; acc:  87.47; ppl:  1.27; xent: 0.24; lr: 0.00133; 2517/2036 tok/s;   1366 sec
[2020-08-20 05:15:07,677 INFO] Step 8900/20000; acc:  87.50; ppl:  1.27; xent: 0.24; lr: 0.00132; 2610/2117 tok/s;   1381 sec
[2020-08-20 05:15:22,798 INFO] Step 9000/20000; acc:  87.57; ppl:  1.27; xent: 0.24; lr: 0.00132; 2590/2105 tok/s;   1396 sec
[2020-08-20 05:15:24,167 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:15:24,247 INFO] number of examples: 9920
[2020-08-20 05:15:30,240 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_9048.pt
[2020-08-20 05:15:38,385 INFO] Step 9100/20000; acc:  87.45; ppl:  1.28; xent: 0.25; lr: 0.00131; 2541/2064 tok/s;   1411 sec
[2020-08-20 05:15:53,541 INFO] Step 9200/20000; acc:  87.01; ppl:  1.29; xent: 0.26; lr: 0.00130; 2580/2106 tok/s;   1427 sec
[2020-08-20 05:16:08,703 INFO] Step 9300/20000; acc:  86.30; ppl:  1.31; xent: 0.27; lr: 0.00130; 2588/2103 tok/s;   1442 sec
[2020-08-20 05:16:17,798 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_9360.pt
[2020-08-20 05:16:24,162 INFO] Step 9400/20000; acc:  86.85; ppl:  1.30; xent: 0.26; lr: 0.00129; 2552/2061 tok/s;   1457 sec
[2020-08-20 05:16:39,230 INFO] Step 9500/20000; acc:  87.11; ppl:  1.29; xent: 0.25; lr: 0.00128; 2621/2124 tok/s;   1472 sec
[2020-08-20 05:16:54,308 INFO] Step 9600/20000; acc:  87.12; ppl:  1.29; xent: 0.25; lr: 0.00128; 2599/2117 tok/s;   1487 sec
[2020-08-20 05:17:05,211 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_9672.pt
[2020-08-20 05:17:11,080 INFO] Step 9700/20000; acc:  85.94; ppl:  1.33; xent: 0.29; lr: 0.00127; 2318/1882 tok/s;   1504 sec
[2020-08-20 05:17:26,172 INFO] Step 9800/20000; acc:  86.68; ppl:  1.31; xent: 0.27; lr: 0.00126; 2599/2102 tok/s;   1519 sec
[2020-08-20 05:17:41,276 INFO] Step 9900/20000; acc:  85.82; ppl:  1.33; xent: 0.28; lr: 0.00126; 2614/2119 tok/s;   1534 sec
[2020-08-20 05:17:54,006 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_9984.pt
[2020-08-20 05:17:59,027 INFO] Step 10000/20000; acc:  85.54; ppl:  1.35; xent: 0.30; lr: 0.00125; 2208/1795 tok/s;   1552 sec
[2020-08-20 05:17:59,028 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 05:17:59,052 INFO] number of examples: 620
[2020-08-20 05:18:00,097 INFO] Validation perplexity: 1.34667
[2020-08-20 05:18:00,098 INFO] Validation accuracy: 87.9072
[2020-08-20 05:18:01,612 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:18:01,689 INFO] number of examples: 9920
[2020-08-20 05:18:15,324 INFO] Step 10100/20000; acc:  85.70; ppl:  1.33; xent: 0.29; lr: 0.00124; 2433/1975 tok/s;   1568 sec
[2020-08-20 05:18:30,393 INFO] Step 10200/20000; acc:  86.31; ppl:  1.33; xent: 0.28; lr: 0.00124; 2593/2117 tok/s;   1583 sec
[2020-08-20 05:18:44,894 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_10296.pt
[2020-08-20 05:18:45,868 INFO] Step 10300/20000; acc:  87.07; ppl:  1.29; xent: 0.26; lr: 0.00123; 2535/2061 tok/s;   1599 sec
[2020-08-20 05:19:01,014 INFO] Step 10400/20000; acc:  86.88; ppl:  1.30; xent: 0.26; lr: 0.00123; 2605/2103 tok/s;   1614 sec
[2020-08-20 05:19:16,396 INFO] Step 10500/20000; acc:  87.41; ppl:  1.28; xent: 0.25; lr: 0.00122; 2628/2129 tok/s;   1629 sec
[2020-08-20 05:19:31,555 INFO] Step 10600/20000; acc:  87.29; ppl:  1.28; xent: 0.25; lr: 0.00121; 2587/2108 tok/s;   1645 sec
[2020-08-20 05:19:32,768 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_10608.pt
[2020-08-20 05:19:47,033 INFO] Step 10700/20000; acc:  87.56; ppl:  1.28; xent: 0.24; lr: 0.00121; 2508/2036 tok/s;   1660 sec
[2020-08-20 05:20:02,177 INFO] Step 10800/20000; acc:  86.97; ppl:  1.29; xent: 0.26; lr: 0.00120; 2590/2096 tok/s;   1675 sec
[2020-08-20 05:20:17,264 INFO] Step 10900/20000; acc:  87.45; ppl:  1.27; xent: 0.24; lr: 0.00120; 2619/2124 tok/s;   1690 sec
[2020-08-20 05:20:20,307 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_10920.pt
[2020-08-20 05:20:32,701 INFO] Step 11000/20000; acc:  87.54; ppl:  1.27; xent: 0.24; lr: 0.00119; 2539/2063 tok/s;   1706 sec
[2020-08-20 05:20:34,361 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:20:34,441 INFO] number of examples: 9920
[2020-08-20 05:20:48,015 INFO] Step 11100/20000; acc:  87.75; ppl:  1.27; xent: 0.24; lr: 0.00119; 2586/2100 tok/s;   1721 sec
[2020-08-20 05:21:03,152 INFO] Step 11200/20000; acc:  87.55; ppl:  1.27; xent: 0.24; lr: 0.00118; 2585/2110 tok/s;   1736 sec
[2020-08-20 05:21:07,996 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_11232.pt
[2020-08-20 05:21:19,454 INFO] Step 11300/20000; acc:  87.64; ppl:  1.27; xent: 0.24; lr: 0.00118; 2408/1958 tok/s;   1753 sec
[2020-08-20 05:21:34,586 INFO] Step 11400/20000; acc:  87.97; ppl:  1.26; xent: 0.23; lr: 0.00117; 2605/2104 tok/s;   1768 sec
[2020-08-20 05:21:49,706 INFO] Step 11500/20000; acc:  87.57; ppl:  1.27; xent: 0.24; lr: 0.00117; 2611/2114 tok/s;   1783 sec
[2020-08-20 05:21:56,367 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_11544.pt
[2020-08-20 05:22:05,124 INFO] Step 11600/20000; acc:  87.48; ppl:  1.27; xent: 0.24; lr: 0.00116; 2546/2074 tok/s;   1798 sec
[2020-08-20 05:22:20,225 INFO] Step 11700/20000; acc:  88.03; ppl:  1.26; xent: 0.23; lr: 0.00116; 2571/2087 tok/s;   1813 sec
[2020-08-20 05:22:35,373 INFO] Step 11800/20000; acc:  87.66; ppl:  1.27; xent: 0.24; lr: 0.00115; 2588/2093 tok/s;   1828 sec
[2020-08-20 05:22:43,839 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_11856.pt
[2020-08-20 05:22:50,736 INFO] Step 11900/20000; acc:  87.77; ppl:  1.27; xent: 0.24; lr: 0.00115; 2569/2083 tok/s;   1844 sec
[2020-08-20 05:23:05,876 INFO] Step 12000/20000; acc:  88.02; ppl:  1.26; xent: 0.23; lr: 0.00114; 2590/2106 tok/s;   1859 sec
[2020-08-20 05:23:07,745 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:23:07,833 INFO] number of examples: 9920
[2020-08-20 05:23:21,203 INFO] Step 12100/20000; acc:  87.76; ppl:  1.27; xent: 0.24; lr: 0.00114; 2593/2106 tok/s;   1874 sec
[2020-08-20 05:23:31,490 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_12168.pt
[2020-08-20 05:23:36,658 INFO] Step 12200/20000; acc:  87.45; ppl:  1.27; xent: 0.24; lr: 0.00113; 2535/2069 tok/s;   1890 sec
[2020-08-20 05:23:51,780 INFO] Step 12300/20000; acc:  86.97; ppl:  1.29; xent: 0.26; lr: 0.00113; 2599/2114 tok/s;   1905 sec
[2020-08-20 05:24:06,894 INFO] Step 12400/20000; acc:  87.29; ppl:  1.28; xent: 0.25; lr: 0.00112; 2608/2106 tok/s;   1920 sec
[2020-08-20 05:24:18,974 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_12480.pt
[2020-08-20 05:24:22,308 INFO] Step 12500/20000; acc:  87.28; ppl:  1.28; xent: 0.25; lr: 0.00112; 2555/2070 tok/s;   1935 sec
[2020-08-20 05:24:37,429 INFO] Step 12600/20000; acc:  87.34; ppl:  1.27; xent: 0.24; lr: 0.00111; 2599/2115 tok/s;   1951 sec
[2020-08-20 05:24:52,532 INFO] Step 12700/20000; acc:  87.31; ppl:  1.28; xent: 0.25; lr: 0.00111; 2570/2087 tok/s;   1966 sec
[2020-08-20 05:25:06,506 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_12792.pt
[2020-08-20 05:25:08,006 INFO] Step 12800/20000; acc:  87.71; ppl:  1.27; xent: 0.24; lr: 0.00110; 2530/2046 tok/s;   1981 sec
[2020-08-20 05:25:23,136 INFO] Step 12900/20000; acc:  87.56; ppl:  1.27; xent: 0.24; lr: 0.00110; 2611/2119 tok/s;   1996 sec
[2020-08-20 05:25:38,294 INFO] Step 13000/20000; acc:  87.87; ppl:  1.26; xent: 0.23; lr: 0.00110; 2588/2105 tok/s;   2011 sec
[2020-08-20 05:25:40,268 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:25:40,357 INFO] number of examples: 9920
[2020-08-20 05:25:53,635 INFO] Step 13100/20000; acc:  86.89; ppl:  1.30; xent: 0.27; lr: 0.00109; 2579/2096 tok/s;   2027 sec
[2020-08-20 05:25:54,242 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_13104.pt
[2020-08-20 05:26:09,046 INFO] Step 13200/20000; acc:  86.75; ppl:  1.30; xent: 0.26; lr: 0.00109; 2545/2075 tok/s;   2042 sec
[2020-08-20 05:26:24,171 INFO] Step 13300/20000; acc:  87.42; ppl:  1.28; xent: 0.24; lr: 0.00108; 2597/2113 tok/s;   2057 sec
[2020-08-20 05:26:39,319 INFO] Step 13400/20000; acc:  87.40; ppl:  1.28; xent: 0.25; lr: 0.00108; 2604/2102 tok/s;   2072 sec
[2020-08-20 05:26:41,745 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_13416.pt
[2020-08-20 05:26:54,760 INFO] Step 13500/20000; acc:  87.74; ppl:  1.27; xent: 0.24; lr: 0.00108; 2554/2068 tok/s;   2088 sec
[2020-08-20 05:27:09,943 INFO] Step 13600/20000; acc:  87.63; ppl:  1.27; xent: 0.24; lr: 0.00107; 2587/2106 tok/s;   2103 sec
[2020-08-20 05:27:25,104 INFO] Step 13700/20000; acc:  87.68; ppl:  1.27; xent: 0.24; lr: 0.00107; 2556/2075 tok/s;   2118 sec
[2020-08-20 05:27:29,327 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_13728.pt
[2020-08-20 05:27:41,304 INFO] Step 13800/20000; acc:  88.20; ppl:  1.26; xent: 0.23; lr: 0.00106; 2416/1954 tok/s;   2134 sec
[2020-08-20 05:27:56,415 INFO] Step 13900/20000; acc:  87.91; ppl:  1.26; xent: 0.23; lr: 0.00106; 2620/2125 tok/s;   2150 sec
[2020-08-20 05:28:11,620 INFO] Step 14000/20000; acc:  87.82; ppl:  1.27; xent: 0.24; lr: 0.00106; 2578/2097 tok/s;   2165 sec
[2020-08-20 05:28:13,752 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:28:13,842 INFO] number of examples: 9920
[2020-08-20 05:28:17,833 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_14040.pt
[2020-08-20 05:28:27,536 INFO] Step 14100/20000; acc:  87.89; ppl:  1.27; xent: 0.24; lr: 0.00105; 2486/2020 tok/s;   2181 sec
[2020-08-20 05:28:42,686 INFO] Step 14200/20000; acc:  87.96; ppl:  1.26; xent: 0.23; lr: 0.00105; 2587/2109 tok/s;   2196 sec
[2020-08-20 05:28:57,860 INFO] Step 14300/20000; acc:  88.24; ppl:  1.26; xent: 0.23; lr: 0.00105; 2590/2107 tok/s;   2211 sec
[2020-08-20 05:29:05,747 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_14352.pt
[2020-08-20 05:29:13,268 INFO] Step 14400/20000; acc:  88.02; ppl:  1.27; xent: 0.24; lr: 0.00104; 2561/2069 tok/s;   2226 sec
[2020-08-20 05:29:28,367 INFO] Step 14500/20000; acc:  88.04; ppl:  1.26; xent: 0.23; lr: 0.00104; 2610/2112 tok/s;   2241 sec
[2020-08-20 05:29:43,473 INFO] Step 14600/20000; acc:  87.74; ppl:  1.26; xent: 0.23; lr: 0.00103; 2598/2116 tok/s;   2257 sec
[2020-08-20 05:29:53,154 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_14664.pt
[2020-08-20 05:29:58,958 INFO] Step 14700/20000; acc:  87.92; ppl:  1.26; xent: 0.23; lr: 0.00103; 2509/2038 tok/s;   2272 sec
[2020-08-20 05:30:14,113 INFO] Step 14800/20000; acc:  88.39; ppl:  1.25; xent: 0.22; lr: 0.00103; 2580/2086 tok/s;   2287 sec
[2020-08-20 05:30:29,209 INFO] Step 14900/20000; acc:  88.07; ppl:  1.26; xent: 0.23; lr: 0.00102; 2621/2126 tok/s;   2302 sec
[2020-08-20 05:30:40,717 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_14976.pt
[2020-08-20 05:30:44,667 INFO] Step 15000/20000; acc:  88.44; ppl:  1.25; xent: 0.22; lr: 0.00102; 2533/2061 tok/s;   2318 sec
[2020-08-20 05:30:46,937 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:30:47,023 INFO] number of examples: 9920
[2020-08-20 05:30:59,942 INFO] Step 15100/20000; acc:  88.34; ppl:  1.26; xent: 0.23; lr: 0.00102; 2592/2105 tok/s;   2333 sec
[2020-08-20 05:31:15,099 INFO] Step 15200/20000; acc:  88.24; ppl:  1.25; xent: 0.23; lr: 0.00101; 2586/2109 tok/s;   2348 sec
[2020-08-20 05:31:28,359 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_15288.pt
[2020-08-20 05:31:30,508 INFO] Step 15300/20000; acc:  88.19; ppl:  1.25; xent: 0.23; lr: 0.00101; 2551/2075 tok/s;   2364 sec
[2020-08-20 05:31:45,664 INFO] Step 15400/20000; acc:  87.98; ppl:  1.26; xent: 0.23; lr: 0.00101; 2600/2101 tok/s;   2379 sec
[2020-08-20 05:32:00,787 INFO] Step 15500/20000; acc:  88.13; ppl:  1.25; xent: 0.23; lr: 0.00100; 2608/2110 tok/s;   2394 sec
[2020-08-20 05:32:15,955 INFO] Step 15600/20000; acc:  87.96; ppl:  1.26; xent: 0.23; lr: 0.00100; 2588/2107 tok/s;   2409 sec
[2020-08-20 05:32:15,961 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_15600.pt
[2020-08-20 05:32:31,375 INFO] Step 15700/20000; acc:  88.02; ppl:  1.26; xent: 0.23; lr: 0.00100; 2519/2047 tok/s;   2424 sec
[2020-08-20 05:32:46,545 INFO] Step 15800/20000; acc:  88.30; ppl:  1.26; xent: 0.23; lr: 0.00099; 2580/2087 tok/s;   2440 sec
[2020-08-20 05:33:01,711 INFO] Step 15900/20000; acc:  88.12; ppl:  1.26; xent: 0.23; lr: 0.00099; 2614/2119 tok/s;   2455 sec
[2020-08-20 05:33:03,546 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_15912.pt
[2020-08-20 05:33:17,263 INFO] Step 16000/20000; acc:  88.43; ppl:  1.25; xent: 0.23; lr: 0.00099; 2522/2051 tok/s;   2470 sec
[2020-08-20 05:33:19,697 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:33:19,783 INFO] number of examples: 9920
[2020-08-20 05:33:32,580 INFO] Step 16100/20000; acc:  88.40; ppl:  1.25; xent: 0.22; lr: 0.00099; 2580/2097 tok/s;   2486 sec
[2020-08-20 05:33:47,698 INFO] Step 16200/20000; acc:  88.28; ppl:  1.25; xent: 0.23; lr: 0.00098; 2596/2117 tok/s;   2501 sec
[2020-08-20 05:33:51,324 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_16224.pt
[2020-08-20 05:34:03,171 INFO] Step 16300/20000; acc:  88.08; ppl:  1.26; xent: 0.23; lr: 0.00098; 2539/2064 tok/s;   2516 sec
[2020-08-20 05:34:18,343 INFO] Step 16400/20000; acc:  87.97; ppl:  1.26; xent: 0.23; lr: 0.00098; 2598/2099 tok/s;   2531 sec
[2020-08-20 05:34:33,432 INFO] Step 16500/20000; acc:  87.66; ppl:  1.27; xent: 0.24; lr: 0.00097; 2614/2115 tok/s;   2547 sec
[2020-08-20 05:34:38,873 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_16536.pt
[2020-08-20 05:34:48,854 INFO] Step 16600/20000; acc:  88.25; ppl:  1.25; xent: 0.22; lr: 0.00097; 2545/2074 tok/s;   2562 sec
[2020-08-20 05:35:04,004 INFO] Step 16700/20000; acc:  87.93; ppl:  1.26; xent: 0.23; lr: 0.00097; 2562/2081 tok/s;   2577 sec
[2020-08-20 05:35:19,144 INFO] Step 16800/20000; acc:  88.17; ppl:  1.26; xent: 0.23; lr: 0.00096; 2589/2094 tok/s;   2592 sec
[2020-08-20 05:35:26,390 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_16848.pt
[2020-08-20 05:35:40,270 INFO] Step 16900/20000; acc:  88.16; ppl:  1.26; xent: 0.23; lr: 0.00096; 1872/1517 tok/s;   2613 sec
[2020-08-20 05:35:55,426 INFO] Step 17000/20000; acc:  88.59; ppl:  1.25; xent: 0.22; lr: 0.00096; 2584/2101 tok/s;   2629 sec
[2020-08-20 05:35:58,000 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:35:58,090 INFO] number of examples: 9920
[2020-08-20 05:36:10,729 INFO] Step 17100/20000; acc:  88.42; ppl:  1.25; xent: 0.22; lr: 0.00096; 2585/2101 tok/s;   2644 sec
[2020-08-20 05:36:19,817 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_17160.pt
[2020-08-20 05:36:26,321 INFO] Step 17200/20000; acc:  88.05; ppl:  1.26; xent: 0.23; lr: 0.00095; 2516/2052 tok/s;   2659 sec
[2020-08-20 05:36:41,464 INFO] Step 17300/20000; acc:  88.28; ppl:  1.25; xent: 0.23; lr: 0.00095; 2591/2106 tok/s;   2675 sec
[2020-08-20 05:36:56,642 INFO] Step 17400/20000; acc:  88.29; ppl:  1.25; xent: 0.22; lr: 0.00095; 2600/2100 tok/s;   2690 sec
[2020-08-20 05:37:07,540 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_17472.pt
[2020-08-20 05:37:12,056 INFO] Step 17500/20000; acc:  87.34; ppl:  1.28; xent: 0.25; lr: 0.00094; 2559/2071 tok/s;   2705 sec
[2020-08-20 05:37:27,216 INFO] Step 17600/20000; acc:  87.51; ppl:  1.27; xent: 0.24; lr: 0.00094; 2587/2109 tok/s;   2720 sec
[2020-08-20 05:37:42,337 INFO] Step 17700/20000; acc:  87.95; ppl:  1.26; xent: 0.23; lr: 0.00094; 2566/2085 tok/s;   2735 sec
[2020-08-20 05:37:55,080 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_17784.pt
[2020-08-20 05:37:57,857 INFO] Step 17800/20000; acc:  88.44; ppl:  1.25; xent: 0.22; lr: 0.00094; 2525/2041 tok/s;   2751 sec
[2020-08-20 05:38:12,953 INFO] Step 17900/20000; acc:  88.23; ppl:  1.25; xent: 0.22; lr: 0.00093; 2624/2127 tok/s;   2766 sec
[2020-08-20 05:38:28,104 INFO] Step 18000/20000; acc:  88.10; ppl:  1.26; xent: 0.23; lr: 0.00093; 2585/2100 tok/s;   2781 sec
[2020-08-20 05:38:30,834 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:38:30,924 INFO] number of examples: 9920
[2020-08-20 05:38:42,801 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_18096.pt
[2020-08-20 05:38:43,811 INFO] Step 18100/20000; acc:  88.36; ppl:  1.25; xent: 0.22; lr: 0.00093; 2516/2046 tok/s;   2797 sec
[2020-08-20 05:38:58,944 INFO] Step 18200/20000; acc:  88.48; ppl:  1.24; xent: 0.22; lr: 0.00093; 2593/2115 tok/s;   2812 sec
[2020-08-20 05:39:14,104 INFO] Step 18300/20000; acc:  88.34; ppl:  1.25; xent: 0.22; lr: 0.00092; 2586/2102 tok/s;   2827 sec
[2020-08-20 05:39:29,220 INFO] Step 18400/20000; acc:  88.51; ppl:  1.25; xent: 0.22; lr: 0.00092; 2612/2110 tok/s;   2842 sec
[2020-08-20 05:39:30,423 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_18408.pt
[2020-08-20 05:39:44,627 INFO] Step 18500/20000; acc:  88.44; ppl:  1.25; xent: 0.22; lr: 0.00092; 2557/2069 tok/s;   2858 sec
[2020-08-20 05:39:59,705 INFO] Step 18600/20000; acc:  88.26; ppl:  1.25; xent: 0.22; lr: 0.00092; 2604/2122 tok/s;   2873 sec
[2020-08-20 05:40:14,889 INFO] Step 18700/20000; acc:  88.12; ppl:  1.25; xent: 0.23; lr: 0.00091; 2554/2076 tok/s;   2888 sec
[2020-08-20 05:40:17,934 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_18720.pt
[2020-08-20 05:40:30,550 INFO] Step 18800/20000; acc:  88.45; ppl:  1.25; xent: 0.22; lr: 0.00091; 2504/2025 tok/s;   2904 sec
[2020-08-20 05:40:45,693 INFO] Step 18900/20000; acc:  88.02; ppl:  1.25; xent: 0.23; lr: 0.00091; 2616/2121 tok/s;   2919 sec
[2020-08-20 05:41:00,887 INFO] Step 19000/20000; acc:  88.65; ppl:  1.25; xent: 0.22; lr: 0.00091; 2574/2092 tok/s;   2934 sec
[2020-08-20 05:41:03,823 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:41:03,867 INFO] number of examples: 9920
[2020-08-20 05:41:05,937 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_19032.pt
[2020-08-20 05:41:16,596 INFO] Step 19100/20000; acc:  88.20; ppl:  1.26; xent: 0.23; lr: 0.00090; 2525/2054 tok/s;   2950 sec
[2020-08-20 05:41:31,757 INFO] Step 19200/20000; acc:  88.52; ppl:  1.25; xent: 0.22; lr: 0.00090; 2590/2112 tok/s;   2965 sec
[2020-08-20 05:41:46,894 INFO] Step 19300/20000; acc:  88.60; ppl:  1.24; xent: 0.22; lr: 0.00090; 2593/2109 tok/s;   2980 sec
[2020-08-20 05:41:53,539 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_19344.pt
[2020-08-20 05:42:02,326 INFO] Step 19400/20000; acc:  88.69; ppl:  1.24; xent: 0.22; lr: 0.00090; 2555/2063 tok/s;   2995 sec
[2020-08-20 05:42:17,496 INFO] Step 19500/20000; acc:  88.76; ppl:  1.24; xent: 0.21; lr: 0.00090; 2596/2101 tok/s;   3011 sec
[2020-08-20 05:42:32,645 INFO] Step 19600/20000; acc:  88.57; ppl:  1.24; xent: 0.21; lr: 0.00089; 2593/2113 tok/s;   3026 sec
[2020-08-20 05:42:41,133 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_19656.pt
[2020-08-20 05:42:48,227 INFO] Step 19700/20000; acc:  88.48; ppl:  1.25; xent: 0.22; lr: 0.00089; 2489/2022 tok/s;   3041 sec
[2020-08-20 05:43:03,361 INFO] Step 19800/20000; acc:  88.74; ppl:  1.24; xent: 0.22; lr: 0.00089; 2593/2096 tok/s;   3056 sec
[2020-08-20 05:43:18,522 INFO] Step 19900/20000; acc:  88.32; ppl:  1.24; xent: 0.22; lr: 0.00089; 2613/2118 tok/s;   3072 sec
[2020-08-20 05:43:28,822 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_19968.pt
[2020-08-20 05:43:34,043 INFO] Step 20000/20000; acc:  88.56; ppl:  1.25; xent: 0.22; lr: 0.00088; 2521/2050 tok/s;   3087 sec
[2020-08-20 05:43:34,044 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 05:43:34,050 INFO] number of examples: 620
[2020-08-20 05:43:35,098 INFO] Validation perplexity: 1.29993
[2020-08-20 05:43:35,098 INFO] Validation accuracy: 89.2688
[2020-08-20 05:43:35,100 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv8/toy_model_step_20000.pt
[2020-08-20 05:43:36,499 INFO]  * src vocab size = 20
[2020-08-20 05:43:36,499 INFO]  * tgt vocab size = 20
[2020-08-20 05:43:36,499 INFO] Building model...
[2020-08-20 05:43:38,640 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=256, out_features=20, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-08-20 05:43:38,642 INFO] encoder: 5265920
[2020-08-20 05:43:38,642 INFO] decoder: 6320660
[2020-08-20 05:43:38,642 INFO] * number of parameters: 11586580
[2020-08-20 05:43:38,647 INFO] Starting training on GPU: [0]
[2020-08-20 05:43:38,647 INFO] Start training loop and validate every 10000 steps...
[2020-08-20 05:43:38,647 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:43:38,721 INFO] number of examples: 9920
[2020-08-20 05:43:54,186 INFO] Step 100/20000; acc:  53.17; ppl:  3.30; xent: 1.19; lr: 0.00014; 2549/2067 tok/s;     16 sec
[2020-08-20 05:44:09,353 INFO] Step 200/20000; acc:  73.76; ppl:  1.83; xent: 0.60; lr: 0.00028; 2610/2122 tok/s;     31 sec
[2020-08-20 05:44:24,583 INFO] Step 300/20000; acc:  78.14; ppl:  1.62; xent: 0.48; lr: 0.00042; 2576/2083 tok/s;     46 sec
[2020-08-20 05:44:26,403 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_312.pt
[2020-08-20 05:44:40,117 INFO] Step 400/20000; acc:  81.22; ppl:  1.52; xent: 0.42; lr: 0.00056; 2526/2055 tok/s;     61 sec
[2020-08-20 05:44:55,321 INFO] Step 500/20000; acc:  83.06; ppl:  1.45; xent: 0.37; lr: 0.00070; 2614/2129 tok/s;     77 sec
[2020-08-20 05:45:10,602 INFO] Step 600/20000; acc:  84.65; ppl:  1.41; xent: 0.34; lr: 0.00084; 2569/2083 tok/s;     92 sec
[2020-08-20 05:45:14,262 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_624.pt
[2020-08-20 05:45:26,114 INFO] Step 700/20000; acc:  85.20; ppl:  1.39; xent: 0.33; lr: 0.00098; 2515/2038 tok/s;    107 sec
[2020-08-20 05:45:41,302 INFO] Step 800/20000; acc:  85.15; ppl:  1.39; xent: 0.33; lr: 0.00112; 2569/2078 tok/s;    123 sec
[2020-08-20 05:45:56,528 INFO] Step 900/20000; acc:  86.09; ppl:  1.36; xent: 0.31; lr: 0.00126; 2559/2085 tok/s;    138 sec
[2020-08-20 05:46:01,982 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_936.pt
[2020-08-20 05:46:12,070 INFO] Step 1000/20000; acc:  85.80; ppl:  1.36; xent: 0.31; lr: 0.00140; 2528/2054 tok/s;    153 sec
[2020-08-20 05:46:12,223 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:46:12,311 INFO] number of examples: 9920
[2020-08-20 05:46:27,419 INFO] Step 1100/20000; acc:  86.30; ppl:  1.34; xent: 0.29; lr: 0.00154; 2579/2092 tok/s;    169 sec
[2020-08-20 05:46:42,639 INFO] Step 1200/20000; acc:  86.64; ppl:  1.33; xent: 0.29; lr: 0.00168; 2599/2113 tok/s;    184 sec
[2020-08-20 05:46:49,966 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_1248.pt
[2020-08-20 05:46:58,154 INFO] Step 1300/20000; acc:  86.45; ppl:  1.33; xent: 0.28; lr: 0.00182; 2530/2045 tok/s;    200 sec
[2020-08-20 05:47:13,368 INFO] Step 1400/20000; acc:  85.95; ppl:  1.36; xent: 0.31; lr: 0.00196; 2576/2096 tok/s;    215 sec
[2020-08-20 05:47:28,560 INFO] Step 1500/20000; acc:  86.32; ppl:  1.34; xent: 0.30; lr: 0.00210; 2620/2133 tok/s;    230 sec
[2020-08-20 05:47:37,732 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_1560.pt
[2020-08-20 05:47:44,102 INFO] Step 1600/20000; acc:  85.77; ppl:  1.36; xent: 0.31; lr: 0.00224; 2527/2048 tok/s;    245 sec
[2020-08-20 05:47:59,299 INFO] Step 1700/20000; acc:  85.58; ppl:  1.37; xent: 0.31; lr: 0.00238; 2567/2080 tok/s;    261 sec
[2020-08-20 05:48:14,535 INFO] Step 1800/20000; acc:  83.67; ppl:  1.43; xent: 0.36; lr: 0.00252; 2557/2069 tok/s;    276 sec
[2020-08-20 05:48:25,430 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_1872.pt
[2020-08-20 05:48:29,991 INFO] Step 1900/20000; acc:  84.29; ppl:  1.39; xent: 0.33; lr: 0.00266; 2525/2057 tok/s;    291 sec
[2020-08-20 05:48:45,190 INFO] Step 2000/20000; acc:  83.97; ppl:  1.40; xent: 0.34; lr: 0.00279; 2582/2099 tok/s;    307 sec
[2020-08-20 05:48:45,555 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:48:45,594 INFO] number of examples: 9920
[2020-08-20 05:49:00,543 INFO] Step 2100/20000; acc:  84.58; ppl:  1.40; xent: 0.34; lr: 0.00273; 2590/2100 tok/s;    322 sec
[2020-08-20 05:49:13,338 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_2184.pt
[2020-08-20 05:49:16,340 INFO] Step 2200/20000; acc:  84.95; ppl:  1.38; xent: 0.32; lr: 0.00266; 2504/2036 tok/s;    338 sec
[2020-08-20 05:49:31,527 INFO] Step 2300/20000; acc:  85.12; ppl:  1.37; xent: 0.32; lr: 0.00261; 2587/2090 tok/s;    353 sec
[2020-08-20 05:49:46,730 INFO] Step 2400/20000; acc:  85.10; ppl:  1.37; xent: 0.32; lr: 0.00255; 2575/2096 tok/s;    368 sec
[2020-08-20 05:50:01,306 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_2496.pt
[2020-08-20 05:50:02,209 INFO] Step 2500/20000; acc:  84.70; ppl:  1.39; xent: 0.33; lr: 0.00250; 2570/2094 tok/s;    384 sec
[2020-08-20 05:50:17,458 INFO] Step 2600/20000; acc:  83.80; ppl:  1.41; xent: 0.35; lr: 0.00245; 2577/2089 tok/s;    399 sec
[2020-08-20 05:50:32,669 INFO] Step 2700/20000; acc:  85.12; ppl:  1.37; xent: 0.32; lr: 0.00241; 2567/2079 tok/s;    414 sec
[2020-08-20 05:50:47,910 INFO] Step 2800/20000; acc:  84.99; ppl:  1.38; xent: 0.32; lr: 0.00236; 2552/2064 tok/s;    429 sec
[2020-08-20 05:50:49,124 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_2808.pt
[2020-08-20 05:51:03,480 INFO] Step 2900/20000; acc:  84.09; ppl:  1.40; xent: 0.34; lr: 0.00232; 2511/2045 tok/s;    445 sec
[2020-08-20 05:51:18,761 INFO] Step 3000/20000; acc:  86.31; ppl:  1.34; xent: 0.29; lr: 0.00228; 2566/2086 tok/s;    460 sec
[2020-08-20 05:51:19,218 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:51:19,260 INFO] number of examples: 9920
[2020-08-20 05:51:34,044 INFO] Step 3100/20000; acc:  86.09; ppl:  1.34; xent: 0.29; lr: 0.00224; 2586/2098 tok/s;    475 sec
[2020-08-20 05:51:37,073 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_3120.pt
[2020-08-20 05:51:49,490 INFO] Step 3200/20000; acc:  86.82; ppl:  1.31; xent: 0.27; lr: 0.00221; 2564/2084 tok/s;    491 sec
[2020-08-20 05:52:04,629 INFO] Step 3300/20000; acc:  86.91; ppl:  1.31; xent: 0.27; lr: 0.00218; 2594/2097 tok/s;    506 sec
[2020-08-20 05:52:19,765 INFO] Step 3400/20000; acc:  87.25; ppl:  1.30; xent: 0.26; lr: 0.00214; 2587/2103 tok/s;    521 sec
[2020-08-20 05:52:24,620 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_3432.pt
[2020-08-20 05:52:35,244 INFO] Step 3500/20000; acc:  87.93; ppl:  1.28; xent: 0.25; lr: 0.00211; 2572/2096 tok/s;    537 sec
[2020-08-20 05:52:50,443 INFO] Step 3600/20000; acc:  86.22; ppl:  1.34; xent: 0.29; lr: 0.00208; 2584/2096 tok/s;    552 sec
[2020-08-20 05:53:05,563 INFO] Step 3700/20000; acc:  85.90; ppl:  1.35; xent: 0.30; lr: 0.00205; 2582/2091 tok/s;    567 sec
[2020-08-20 05:53:12,221 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_3744.pt
[2020-08-20 05:53:21,139 INFO] Step 3800/20000; acc:  85.70; ppl:  1.35; xent: 0.30; lr: 0.00203; 2495/2017 tok/s;    582 sec
[2020-08-20 05:53:36,254 INFO] Step 3900/20000; acc:  84.15; ppl:  1.40; xent: 0.34; lr: 0.00200; 2587/2106 tok/s;    598 sec
[2020-08-20 05:53:51,387 INFO] Step 4000/20000; acc:  84.26; ppl:  1.40; xent: 0.34; lr: 0.00198; 2593/2108 tok/s;    613 sec
[2020-08-20 05:53:51,994 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:53:52,036 INFO] number of examples: 9920
[2020-08-20 05:53:59,964 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_4056.pt
[2020-08-20 05:54:06,901 INFO] Step 4100/20000; acc:  86.47; ppl:  1.33; xent: 0.28; lr: 0.00195; 2547/2068 tok/s;    628 sec
[2020-08-20 05:54:21,923 INFO] Step 4200/20000; acc:  86.51; ppl:  1.32; xent: 0.28; lr: 0.00193; 2633/2140 tok/s;    643 sec
[2020-08-20 05:54:36,922 INFO] Step 4300/20000; acc:  87.36; ppl:  1.30; xent: 0.26; lr: 0.00191; 2619/2119 tok/s;    658 sec
[2020-08-20 05:54:47,131 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_4368.pt
[2020-08-20 05:54:52,269 INFO] Step 4400/20000; acc:  87.59; ppl:  1.29; xent: 0.25; lr: 0.00188; 2552/2074 tok/s;    674 sec
[2020-08-20 05:55:07,239 INFO] Step 4500/20000; acc:  87.49; ppl:  1.29; xent: 0.25; lr: 0.00186; 2658/2166 tok/s;    689 sec
[2020-08-20 05:55:22,249 INFO] Step 4600/20000; acc:  87.52; ppl:  1.29; xent: 0.25; lr: 0.00184; 2615/2122 tok/s;    704 sec
[2020-08-20 05:55:34,217 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_4680.pt
[2020-08-20 05:55:37,573 INFO] Step 4700/20000; acc:  87.81; ppl:  1.28; xent: 0.25; lr: 0.00182; 2551/2066 tok/s;    719 sec
[2020-08-20 05:55:52,481 INFO] Step 4800/20000; acc:  86.16; ppl:  1.35; xent: 0.30; lr: 0.00180; 2603/2104 tok/s;    734 sec
[2020-08-20 05:56:07,468 INFO] Step 4900/20000; acc:  84.20; ppl:  1.40; xent: 0.34; lr: 0.00179; 2611/2126 tok/s;    749 sec
[2020-08-20 05:56:21,277 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_4992.pt
[2020-08-20 05:56:22,770 INFO] Step 5000/20000; acc:  86.14; ppl:  1.34; xent: 0.30; lr: 0.00177; 2567/2088 tok/s;    764 sec
[2020-08-20 05:56:23,520 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:56:23,562 INFO] number of examples: 9920
[2020-08-20 05:56:37,844 INFO] Step 5100/20000; acc:  87.22; ppl:  1.30; xent: 0.26; lr: 0.00175; 2619/2127 tok/s;    779 sec
[2020-08-20 05:56:52,798 INFO] Step 5200/20000; acc:  86.39; ppl:  1.32; xent: 0.28; lr: 0.00173; 2647/2150 tok/s;    794 sec
[2020-08-20 05:57:07,812 INFO] Step 5300/20000; acc:  87.30; ppl:  1.29; xent: 0.26; lr: 0.00172; 2615/2116 tok/s;    809 sec
[2020-08-20 05:57:08,411 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_5304.pt
[2020-08-20 05:57:23,123 INFO] Step 5400/20000; acc:  87.94; ppl:  1.28; xent: 0.25; lr: 0.00170; 2556/2077 tok/s;    824 sec
[2020-08-20 05:57:38,096 INFO] Step 5500/20000; acc:  87.94; ppl:  1.28; xent: 0.24; lr: 0.00169; 2660/2168 tok/s;    839 sec
[2020-08-20 05:57:53,006 INFO] Step 5600/20000; acc:  87.53; ppl:  1.29; xent: 0.25; lr: 0.00167; 2633/2136 tok/s;    854 sec
[2020-08-20 05:57:55,407 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_5616.pt
[2020-08-20 05:58:10,039 INFO] Step 5700/20000; acc:  87.58; ppl:  1.28; xent: 0.25; lr: 0.00166; 2295/1859 tok/s;    871 sec
[2020-08-20 05:58:25,167 INFO] Step 5800/20000; acc:  87.07; ppl:  1.31; xent: 0.27; lr: 0.00164; 2572/2079 tok/s;    887 sec
[2020-08-20 05:58:40,131 INFO] Step 5900/20000; acc:  87.54; ppl:  1.29; xent: 0.26; lr: 0.00163; 2610/2125 tok/s;    901 sec
[2020-08-20 05:58:44,312 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_5928.pt
[2020-08-20 05:58:55,439 INFO] Step 6000/20000; acc:  87.58; ppl:  1.29; xent: 0.25; lr: 0.00161; 2567/2088 tok/s;    917 sec
[2020-08-20 05:58:56,336 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 05:58:56,407 INFO] number of examples: 9920
[2020-08-20 05:59:10,545 INFO] Step 6100/20000; acc:  87.94; ppl:  1.28; xent: 0.24; lr: 0.00160; 2613/2121 tok/s;    932 sec
[2020-08-20 05:59:25,508 INFO] Step 6200/20000; acc:  87.73; ppl:  1.28; xent: 0.25; lr: 0.00159; 2643/2147 tok/s;    947 sec
[2020-08-20 05:59:31,515 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_6240.pt
[2020-08-20 05:59:40,785 INFO] Step 6300/20000; acc:  87.39; ppl:  1.29; xent: 0.26; lr: 0.00157; 2570/2079 tok/s;    962 sec
[2020-08-20 05:59:55,753 INFO] Step 6400/20000; acc:  88.21; ppl:  1.26; xent: 0.23; lr: 0.00156; 2616/2126 tok/s;    977 sec
[2020-08-20 06:00:10,708 INFO] Step 6500/20000; acc:  87.94; ppl:  1.27; xent: 0.24; lr: 0.00155; 2665/2173 tok/s;    992 sec
[2020-08-20 06:00:18,525 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_6552.pt
[2020-08-20 06:00:31,081 INFO] Step 6600/20000; acc:  87.76; ppl:  1.28; xent: 0.25; lr: 0.00154; 1926/1563 tok/s;   1012 sec
[2020-08-20 06:00:46,062 INFO] Step 6700/20000; acc:  88.20; ppl:  1.27; xent: 0.24; lr: 0.00153; 2610/2114 tok/s;   1027 sec
[2020-08-20 06:01:01,026 INFO] Step 6800/20000; acc:  88.14; ppl:  1.27; xent: 0.24; lr: 0.00152; 2599/2101 tok/s;   1042 sec
[2020-08-20 06:01:10,642 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_6864.pt
[2020-08-20 06:01:16,338 INFO] Step 6900/20000; acc:  87.91; ppl:  1.27; xent: 0.24; lr: 0.00150; 2552/2077 tok/s;   1058 sec
[2020-08-20 06:01:31,333 INFO] Step 7000/20000; acc:  87.68; ppl:  1.28; xent: 0.25; lr: 0.00149; 2621/2133 tok/s;   1073 sec
[2020-08-20 06:01:32,393 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:01:32,468 INFO] number of examples: 9920
[2020-08-20 06:01:46,521 INFO] Step 7100/20000; acc:  87.76; ppl:  1.28; xent: 0.25; lr: 0.00148; 2595/2106 tok/s;   1088 sec
[2020-08-20 06:01:57,919 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_7176.pt
[2020-08-20 06:02:01,866 INFO] Step 7200/20000; acc:  88.27; ppl:  1.26; xent: 0.23; lr: 0.00147; 2578/2094 tok/s;   1103 sec
[2020-08-20 06:02:16,849 INFO] Step 7300/20000; acc:  88.11; ppl:  1.27; xent: 0.24; lr: 0.00146; 2617/2117 tok/s;   1118 sec
[2020-08-20 06:02:31,863 INFO] Step 7400/20000; acc:  88.56; ppl:  1.26; xent: 0.23; lr: 0.00145; 2616/2126 tok/s;   1133 sec
[2020-08-20 06:02:45,082 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_7488.pt
[2020-08-20 06:02:47,195 INFO] Step 7500/20000; acc:  88.43; ppl:  1.26; xent: 0.23; lr: 0.00144; 2594/2115 tok/s;   1149 sec
[2020-08-20 06:03:02,168 INFO] Step 7600/20000; acc:  87.07; ppl:  1.30; xent: 0.26; lr: 0.00143; 2625/2129 tok/s;   1164 sec
[2020-08-20 06:03:17,153 INFO] Step 7700/20000; acc:  85.90; ppl:  1.35; xent: 0.30; lr: 0.00142; 2610/2114 tok/s;   1179 sec
[2020-08-20 06:03:32,140 INFO] Step 7800/20000; acc:  86.43; ppl:  1.32; xent: 0.28; lr: 0.00142; 2595/2098 tok/s;   1193 sec
[2020-08-20 06:03:32,141 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_7800.pt
[2020-08-20 06:03:47,423 INFO] Step 7900/20000; acc:  87.54; ppl:  1.29; xent: 0.25; lr: 0.00141; 2558/2082 tok/s;   1209 sec
[2020-08-20 06:04:02,375 INFO] Step 8000/20000; acc:  87.97; ppl:  1.27; xent: 0.24; lr: 0.00140; 2626/2137 tok/s;   1224 sec
[2020-08-20 06:04:03,581 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:04:03,658 INFO] number of examples: 9920
[2020-08-20 06:04:17,482 INFO] Step 8100/20000; acc:  87.84; ppl:  1.27; xent: 0.24; lr: 0.00139; 2607/2116 tok/s;   1239 sec
[2020-08-20 06:04:19,270 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_8112.pt
[2020-08-20 06:04:32,831 INFO] Step 8200/20000; acc:  88.20; ppl:  1.26; xent: 0.23; lr: 0.00138; 2577/2094 tok/s;   1254 sec
[2020-08-20 06:04:47,777 INFO] Step 8300/20000; acc:  87.60; ppl:  1.28; xent: 0.25; lr: 0.00137; 2625/2122 tok/s;   1269 sec
[2020-08-20 06:05:02,728 INFO] Step 8400/20000; acc:  87.24; ppl:  1.30; xent: 0.26; lr: 0.00136; 2627/2135 tok/s;   1284 sec
[2020-08-20 06:05:06,325 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_8424.pt
[2020-08-20 06:05:17,962 INFO] Step 8500/20000; acc:  87.35; ppl:  1.29; xent: 0.25; lr: 0.00136; 2609/2127 tok/s;   1299 sec
[2020-08-20 06:05:32,926 INFO] Step 8600/20000; acc:  87.88; ppl:  1.27; xent: 0.24; lr: 0.00135; 2629/2133 tok/s;   1314 sec
[2020-08-20 06:05:47,778 INFO] Step 8700/20000; acc:  87.69; ppl:  1.27; xent: 0.24; lr: 0.00134; 2633/2131 tok/s;   1329 sec
[2020-08-20 06:05:53,088 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_8736.pt
[2020-08-20 06:06:02,903 INFO] Step 8800/20000; acc:  88.02; ppl:  1.27; xent: 0.24; lr: 0.00133; 2573/2080 tok/s;   1344 sec
[2020-08-20 06:06:17,688 INFO] Step 8900/20000; acc:  87.58; ppl:  1.29; xent: 0.26; lr: 0.00132; 2641/2150 tok/s;   1359 sec
[2020-08-20 06:06:32,417 INFO] Step 9000/20000; acc:  87.17; ppl:  1.30; xent: 0.26; lr: 0.00132; 2667/2170 tok/s;   1374 sec
[2020-08-20 06:06:33,756 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:06:33,836 INFO] number of examples: 9920
[2020-08-20 06:06:39,678 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_9048.pt
[2020-08-20 06:06:47,691 INFO] Step 9100/20000; acc:  87.17; ppl:  1.30; xent: 0.26; lr: 0.00131; 2579/2093 tok/s;   1389 sec
[2020-08-20 06:07:02,504 INFO] Step 9200/20000; acc:  86.54; ppl:  1.32; xent: 0.28; lr: 0.00130; 2669/2168 tok/s;   1404 sec
[2020-08-20 06:07:17,282 INFO] Step 9300/20000; acc:  86.97; ppl:  1.30; xent: 0.26; lr: 0.00130; 2657/2149 tok/s;   1419 sec
[2020-08-20 06:07:26,160 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_9360.pt
[2020-08-20 06:07:32,383 INFO] Step 9400/20000; acc:  88.09; ppl:  1.28; xent: 0.25; lr: 0.00129; 2596/2110 tok/s;   1434 sec
[2020-08-20 06:07:47,158 INFO] Step 9500/20000; acc:  87.72; ppl:  1.28; xent: 0.25; lr: 0.00128; 2689/2192 tok/s;   1449 sec
[2020-08-20 06:08:01,945 INFO] Step 9600/20000; acc:  87.89; ppl:  1.28; xent: 0.25; lr: 0.00128; 2662/2160 tok/s;   1463 sec
[2020-08-20 06:08:12,599 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_9672.pt
[2020-08-20 06:08:17,020 INFO] Step 9700/20000; acc:  87.75; ppl:  1.27; xent: 0.24; lr: 0.00127; 2596/2103 tok/s;   1478 sec
[2020-08-20 06:08:31,826 INFO] Step 9800/20000; acc:  88.41; ppl:  1.26; xent: 0.23; lr: 0.00126; 2628/2125 tok/s;   1493 sec
[2020-08-20 06:08:46,583 INFO] Step 9900/20000; acc:  88.57; ppl:  1.25; xent: 0.23; lr: 0.00126; 2645/2152 tok/s;   1508 sec
[2020-08-20 06:08:58,980 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_9984.pt
[2020-08-20 06:09:01,609 INFO] Step 10000/20000; acc:  88.29; ppl:  1.26; xent: 0.23; lr: 0.00125; 2617/2130 tok/s;   1523 sec
[2020-08-20 06:09:01,610 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 06:09:01,614 INFO] number of examples: 620
[2020-08-20 06:09:02,640 INFO] Validation perplexity: 1.29392
[2020-08-20 06:09:02,640 INFO] Validation accuracy: 89.8487
[2020-08-20 06:09:04,121 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:09:04,201 INFO] number of examples: 9920
[2020-08-20 06:09:17,611 INFO] Step 10100/20000; acc:  88.39; ppl:  1.26; xent: 0.23; lr: 0.00124; 2461/1998 tok/s;   1539 sec
[2020-08-20 06:09:32,391 INFO] Step 10200/20000; acc:  88.65; ppl:  1.25; xent: 0.22; lr: 0.00124; 2670/2169 tok/s;   1554 sec
[2020-08-20 06:09:46,581 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_10296.pt
[2020-08-20 06:09:47,615 INFO] Step 10300/20000; acc:  88.52; ppl:  1.26; xent: 0.23; lr: 0.00123; 2582/2087 tok/s;   1569 sec
[2020-08-20 06:10:02,420 INFO] Step 10400/20000; acc:  88.49; ppl:  1.26; xent: 0.23; lr: 0.00123; 2652/2156 tok/s;   1584 sec
[2020-08-20 06:10:17,260 INFO] Step 10500/20000; acc:  88.37; ppl:  1.26; xent: 0.23; lr: 0.00122; 2672/2177 tok/s;   1599 sec
[2020-08-20 06:10:32,033 INFO] Step 10600/20000; acc:  88.13; ppl:  1.27; xent: 0.24; lr: 0.00121; 2668/2165 tok/s;   1613 sec
[2020-08-20 06:10:33,208 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_10608.pt
[2020-08-20 06:10:47,259 INFO] Step 10700/20000; acc:  87.68; ppl:  1.28; xent: 0.24; lr: 0.00121; 2571/2084 tok/s;   1629 sec
[2020-08-20 06:11:02,076 INFO] Step 10800/20000; acc:  87.24; ppl:  1.30; xent: 0.26; lr: 0.00120; 2626/2123 tok/s;   1643 sec
[2020-08-20 06:11:16,914 INFO] Step 10900/20000; acc:  87.95; ppl:  1.28; xent: 0.25; lr: 0.00120; 2631/2140 tok/s;   1658 sec
[2020-08-20 06:11:19,873 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_10920.pt
[2020-08-20 06:11:32,018 INFO] Step 11000/20000; acc:  87.16; ppl:  1.30; xent: 0.26; lr: 0.00119; 2599/2115 tok/s;   1673 sec
[2020-08-20 06:11:33,645 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:11:33,727 INFO] number of examples: 9920
[2020-08-20 06:11:47,010 INFO] Step 11100/20000; acc:  88.16; ppl:  1.27; xent: 0.24; lr: 0.00119; 2633/2138 tok/s;   1688 sec
[2020-08-20 06:12:01,818 INFO] Step 11200/20000; acc:  86.32; ppl:  1.32; xent: 0.28; lr: 0.00118; 2661/2162 tok/s;   1703 sec
[2020-08-20 06:12:06,566 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_11232.pt
[2020-08-20 06:12:17,400 INFO] Step 11300/20000; acc:  87.90; ppl:  1.28; xent: 0.25; lr: 0.00118; 2522/2038 tok/s;   1719 sec
[2020-08-20 06:12:32,195 INFO] Step 11400/20000; acc:  88.44; ppl:  1.26; xent: 0.23; lr: 0.00117; 2656/2160 tok/s;   1734 sec
[2020-08-20 06:12:47,013 INFO] Step 11500/20000; acc:  88.48; ppl:  1.26; xent: 0.23; lr: 0.00117; 2671/2176 tok/s;   1748 sec
[2020-08-20 06:12:53,544 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_11544.pt
[2020-08-20 06:13:02,133 INFO] Step 11600/20000; acc:  88.43; ppl:  1.26; xent: 0.23; lr: 0.00116; 2610/2117 tok/s;   1763 sec
[2020-08-20 06:13:16,966 INFO] Step 11700/20000; acc:  88.81; ppl:  1.25; xent: 0.22; lr: 0.00116; 2639/2139 tok/s;   1778 sec
[2020-08-20 06:13:31,795 INFO] Step 11800/20000; acc:  89.09; ppl:  1.25; xent: 0.22; lr: 0.00115; 2624/2122 tok/s;   1793 sec
[2020-08-20 06:13:40,129 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_11856.pt
[2020-08-20 06:13:46,967 INFO] Step 11900/20000; acc:  88.25; ppl:  1.27; xent: 0.24; lr: 0.00115; 2573/2092 tok/s;   1808 sec
[2020-08-20 06:14:01,787 INFO] Step 12000/20000; acc:  88.41; ppl:  1.26; xent: 0.23; lr: 0.00114; 2653/2159 tok/s;   1823 sec
[2020-08-20 06:14:03,578 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:14:04,016 INFO] number of examples: 9920
[2020-08-20 06:14:17,131 INFO] Step 12100/20000; acc:  85.85; ppl:  1.34; xent: 0.29; lr: 0.00114; 2571/2088 tok/s;   1838 sec
[2020-08-20 06:14:27,188 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_12168.pt
[2020-08-20 06:14:32,288 INFO] Step 12200/20000; acc:  87.52; ppl:  1.29; xent: 0.25; lr: 0.00113; 2594/2106 tok/s;   1854 sec
[2020-08-20 06:14:47,075 INFO] Step 12300/20000; acc:  87.76; ppl:  1.28; xent: 0.24; lr: 0.00113; 2661/2153 tok/s;   1868 sec
[2020-08-20 06:15:01,950 INFO] Step 12400/20000; acc:  88.43; ppl:  1.26; xent: 0.23; lr: 0.00112; 2645/2150 tok/s;   1883 sec
[2020-08-20 06:15:13,791 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_12480.pt
[2020-08-20 06:15:17,071 INFO] Step 12500/20000; acc:  88.65; ppl:  1.25; xent: 0.22; lr: 0.00112; 2610/2127 tok/s;   1898 sec
[2020-08-20 06:15:31,893 INFO] Step 12600/20000; acc:  88.81; ppl:  1.26; xent: 0.23; lr: 0.00111; 2663/2159 tok/s;   1913 sec
[2020-08-20 06:15:46,683 INFO] Step 12700/20000; acc:  88.74; ppl:  1.25; xent: 0.23; lr: 0.00111; 2651/2151 tok/s;   1928 sec
[2020-08-20 06:16:00,338 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_12792.pt
[2020-08-20 06:16:01,892 INFO] Step 12800/20000; acc:  88.43; ppl:  1.27; xent: 0.24; lr: 0.00110; 2560/2069 tok/s;   1943 sec
[2020-08-20 06:16:16,701 INFO] Step 12900/20000; acc:  88.57; ppl:  1.26; xent: 0.23; lr: 0.00110; 2635/2142 tok/s;   1958 sec
[2020-08-20 06:16:31,505 INFO] Step 13000/20000; acc:  88.80; ppl:  1.25; xent: 0.22; lr: 0.00110; 2657/2161 tok/s;   1973 sec
[2020-08-20 06:16:33,428 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:16:33,512 INFO] number of examples: 9920
[2020-08-20 06:16:46,434 INFO] Step 13100/20000; acc:  88.88; ppl:  1.25; xent: 0.22; lr: 0.00109; 2641/2145 tok/s;   1988 sec
[2020-08-20 06:16:47,031 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_13104.pt
[2020-08-20 06:17:01,533 INFO] Step 13200/20000; acc:  89.06; ppl:  1.24; xent: 0.22; lr: 0.00109; 2601/2111 tok/s;   2003 sec
[2020-08-20 06:17:16,280 INFO] Step 13300/20000; acc:  89.03; ppl:  1.24; xent: 0.22; lr: 0.00108; 2672/2161 tok/s;   2018 sec
[2020-08-20 06:17:31,033 INFO] Step 13400/20000; acc:  89.29; ppl:  1.24; xent: 0.21; lr: 0.00108; 2668/2170 tok/s;   2032 sec
[2020-08-20 06:17:33,412 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_13416.pt
[2020-08-20 06:17:46,165 INFO] Step 13500/20000; acc:  89.09; ppl:  1.24; xent: 0.21; lr: 0.00108; 2607/2125 tok/s;   2048 sec
[2020-08-20 06:18:00,909 INFO] Step 13600/20000; acc:  89.24; ppl:  1.24; xent: 0.21; lr: 0.00107; 2675/2169 tok/s;   2062 sec
[2020-08-20 06:18:15,700 INFO] Step 13700/20000; acc:  89.04; ppl:  1.24; xent: 0.21; lr: 0.00107; 2653/2153 tok/s;   2077 sec
[2020-08-20 06:18:19,833 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_13728.pt
[2020-08-20 06:18:30,927 INFO] Step 13800/20000; acc:  87.83; ppl:  1.28; xent: 0.25; lr: 0.00106; 2558/2068 tok/s;   2092 sec
[2020-08-20 06:18:45,708 INFO] Step 13900/20000; acc:  88.05; ppl:  1.27; xent: 0.24; lr: 0.00106; 2643/2148 tok/s;   2107 sec
[2020-08-20 06:19:00,485 INFO] Step 14000/20000; acc:  88.47; ppl:  1.26; xent: 0.23; lr: 0.00106; 2655/2162 tok/s;   2122 sec
[2020-08-20 06:19:02,562 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:19:02,647 INFO] number of examples: 9920
[2020-08-20 06:19:06,562 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_14040.pt
[2020-08-20 06:19:15,722 INFO] Step 14100/20000; acc:  88.90; ppl:  1.25; xent: 0.22; lr: 0.00105; 2593/2105 tok/s;   2137 sec
[2020-08-20 06:19:30,511 INFO] Step 14200/20000; acc:  89.08; ppl:  1.24; xent: 0.21; lr: 0.00105; 2653/2153 tok/s;   2152 sec
[2020-08-20 06:19:45,277 INFO] Step 14300/20000; acc:  89.13; ppl:  1.24; xent: 0.22; lr: 0.00105; 2664/2155 tok/s;   2167 sec
[2020-08-20 06:19:52,947 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_14352.pt
[2020-08-20 06:20:00,305 INFO] Step 14400/20000; acc:  89.21; ppl:  1.23; xent: 0.21; lr: 0.00104; 2622/2132 tok/s;   2182 sec
[2020-08-20 06:20:15,144 INFO] Step 14500/20000; acc:  89.26; ppl:  1.23; xent: 0.21; lr: 0.00104; 2660/2167 tok/s;   2196 sec
[2020-08-20 06:20:29,919 INFO] Step 14600/20000; acc:  89.13; ppl:  1.24; xent: 0.21; lr: 0.00103; 2668/2164 tok/s;   2211 sec
[2020-08-20 06:20:39,360 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_14664.pt
[2020-08-20 06:20:45,000 INFO] Step 14700/20000; acc:  89.51; ppl:  1.23; xent: 0.21; lr: 0.00103; 2600/2111 tok/s;   2226 sec
[2020-08-20 06:20:59,793 INFO] Step 14800/20000; acc:  89.42; ppl:  1.23; xent: 0.21; lr: 0.00103; 2633/2129 tok/s;   2241 sec
[2020-08-20 06:21:14,586 INFO] Step 14900/20000; acc:  89.44; ppl:  1.23; xent: 0.20; lr: 0.00102; 2646/2150 tok/s;   2256 sec
[2020-08-20 06:21:25,843 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_14976.pt
[2020-08-20 06:21:29,678 INFO] Step 15000/20000; acc:  89.22; ppl:  1.23; xent: 0.21; lr: 0.00102; 2601/2118 tok/s;   2271 sec
[2020-08-20 06:21:31,891 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:21:31,981 INFO] number of examples: 9920
[2020-08-20 06:21:44,634 INFO] Step 15100/20000; acc:  88.97; ppl:  1.24; xent: 0.22; lr: 0.00102; 2642/2143 tok/s;   2286 sec
[2020-08-20 06:21:59,440 INFO] Step 15200/20000; acc:  86.59; ppl:  1.32; xent: 0.28; lr: 0.00101; 2649/2151 tok/s;   2301 sec
[2020-08-20 06:22:12,455 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_15288.pt
[2020-08-20 06:22:14,585 INFO] Step 15300/20000; acc:  88.04; ppl:  1.27; xent: 0.24; lr: 0.00101; 2596/2100 tok/s;   2316 sec
[2020-08-20 06:22:29,410 INFO] Step 15400/20000; acc:  89.00; ppl:  1.24; xent: 0.22; lr: 0.00101; 2656/2162 tok/s;   2331 sec
[2020-08-20 06:22:44,171 INFO] Step 15500/20000; acc:  88.98; ppl:  1.24; xent: 0.22; lr: 0.00100; 2673/2177 tok/s;   2346 sec
[2020-08-20 06:22:59,774 INFO] Step 15600/20000; acc:  88.44; ppl:  1.26; xent: 0.23; lr: 0.00100; 2674/2168 tok/s;   2361 sec
[2020-08-20 06:22:59,776 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_15600.pt
[2020-08-20 06:23:15,067 INFO] Step 15700/20000; acc:  88.76; ppl:  1.25; xent: 0.22; lr: 0.00100; 2562/2079 tok/s;   2376 sec
[2020-08-20 06:23:29,909 INFO] Step 15800/20000; acc:  89.18; ppl:  1.24; xent: 0.21; lr: 0.00099; 2626/2125 tok/s;   2391 sec
[2020-08-20 06:23:44,746 INFO] Step 15900/20000; acc:  89.49; ppl:  1.23; xent: 0.21; lr: 0.00099; 2633/2137 tok/s;   2406 sec
[2020-08-20 06:23:46,528 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_15912.pt
[2020-08-20 06:23:59,782 INFO] Step 16000/20000; acc:  89.14; ppl:  1.24; xent: 0.21; lr: 0.00099; 2614/2130 tok/s;   2421 sec
[2020-08-20 06:24:02,149 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:24:02,236 INFO] number of examples: 9920
[2020-08-20 06:24:14,705 INFO] Step 16100/20000; acc:  89.19; ppl:  1.24; xent: 0.22; lr: 0.00099; 2645/2145 tok/s;   2436 sec
[2020-08-20 06:24:29,517 INFO] Step 16200/20000; acc:  89.37; ppl:  1.23; xent: 0.21; lr: 0.00098; 2647/2150 tok/s;   2451 sec
[2020-08-20 06:24:33,075 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_16224.pt
[2020-08-20 06:24:45,687 INFO] Step 16300/20000; acc:  89.41; ppl:  1.23; xent: 0.21; lr: 0.00098; 2433/1968 tok/s;   2467 sec
[2020-08-20 06:25:00,488 INFO] Step 16400/20000; acc:  89.60; ppl:  1.23; xent: 0.20; lr: 0.00098; 2659/2163 tok/s;   2482 sec
[2020-08-20 06:25:15,336 INFO] Step 16500/20000; acc:  89.40; ppl:  1.23; xent: 0.21; lr: 0.00097; 2663/2168 tok/s;   2497 sec
[2020-08-20 06:25:20,688 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_16536.pt
[2020-08-20 06:25:32,459 INFO] Step 16600/20000; acc:  89.21; ppl:  1.24; xent: 0.22; lr: 0.00097; 2304/1869 tok/s;   2514 sec
[2020-08-20 06:25:47,275 INFO] Step 16700/20000; acc:  89.34; ppl:  1.23; xent: 0.21; lr: 0.00097; 2643/2146 tok/s;   2529 sec
[2020-08-20 06:26:01,951 INFO] Step 16800/20000; acc:  89.37; ppl:  1.24; xent: 0.21; lr: 0.00096; 2656/2149 tok/s;   2543 sec
[2020-08-20 06:26:09,037 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_16848.pt
[2020-08-20 06:26:18,619 INFO] Step 16900/20000; acc:  89.60; ppl:  1.22; xent: 0.20; lr: 0.00096; 2344/1902 tok/s;   2560 sec
[2020-08-20 06:26:33,407 INFO] Step 17000/20000; acc:  89.14; ppl:  1.24; xent: 0.21; lr: 0.00096; 2659/2166 tok/s;   2575 sec
[2020-08-20 06:26:35,961 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:26:36,063 INFO] number of examples: 9920
[2020-08-20 06:26:48,390 INFO] Step 17100/20000; acc:  89.32; ppl:  1.24; xent: 0.21; lr: 0.00096; 2631/2134 tok/s;   2590 sec
[2020-08-20 06:26:57,186 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_17160.pt
[2020-08-20 06:27:03,467 INFO] Step 17200/20000; acc:  89.39; ppl:  1.23; xent: 0.21; lr: 0.00095; 2603/2113 tok/s;   2605 sec
[2020-08-20 06:27:18,287 INFO] Step 17300/20000; acc:  89.07; ppl:  1.23; xent: 0.21; lr: 0.00095; 2658/2151 tok/s;   2620 sec
[2020-08-20 06:27:33,000 INFO] Step 17400/20000; acc:  89.39; ppl:  1.23; xent: 0.21; lr: 0.00095; 2670/2172 tok/s;   2634 sec
[2020-08-20 06:27:43,630 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_17472.pt
[2020-08-20 06:27:48,173 INFO] Step 17500/20000; acc:  89.31; ppl:  1.23; xent: 0.21; lr: 0.00094; 2604/2120 tok/s;   2650 sec
[2020-08-20 06:28:02,993 INFO] Step 17600/20000; acc:  89.64; ppl:  1.23; xent: 0.21; lr: 0.00094; 2666/2163 tok/s;   2664 sec
[2020-08-20 06:28:17,779 INFO] Step 17700/20000; acc:  89.46; ppl:  1.23; xent: 0.20; lr: 0.00094; 2651/2152 tok/s;   2679 sec
[2020-08-20 06:28:30,214 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_17784.pt
[2020-08-20 06:28:32,846 INFO] Step 17800/20000; acc:  89.65; ppl:  1.23; xent: 0.21; lr: 0.00094; 2587/2093 tok/s;   2694 sec
[2020-08-20 06:28:47,640 INFO] Step 17900/20000; acc:  89.84; ppl:  1.22; xent: 0.20; lr: 0.00093; 2639/2142 tok/s;   2709 sec
[2020-08-20 06:29:02,385 INFO] Step 18000/20000; acc:  89.14; ppl:  1.24; xent: 0.21; lr: 0.00093; 2667/2172 tok/s;   2724 sec
[2020-08-20 06:29:05,085 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:29:05,239 INFO] number of examples: 9920
[2020-08-20 06:29:16,867 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_18096.pt
[2020-08-20 06:29:17,914 INFO] Step 18100/20000; acc:  89.52; ppl:  1.23; xent: 0.21; lr: 0.00093; 2539/2060 tok/s;   2739 sec
[2020-08-20 06:29:32,751 INFO] Step 18200/20000; acc:  89.60; ppl:  1.22; xent: 0.20; lr: 0.00093; 2644/2146 tok/s;   2754 sec
[2020-08-20 06:29:47,542 INFO] Step 18300/20000; acc:  89.36; ppl:  1.23; xent: 0.20; lr: 0.00092; 2662/2155 tok/s;   2769 sec
[2020-08-20 06:30:02,410 INFO] Step 18400/20000; acc:  89.40; ppl:  1.23; xent: 0.21; lr: 0.00092; 2638/2145 tok/s;   2784 sec
[2020-08-20 06:30:03,601 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_18408.pt
[2020-08-20 06:30:17,646 INFO] Step 18500/20000; acc:  89.53; ppl:  1.23; xent: 0.20; lr: 0.00092; 2599/2115 tok/s;   2799 sec
[2020-08-20 06:30:32,434 INFO] Step 18600/20000; acc:  89.61; ppl:  1.23; xent: 0.21; lr: 0.00092; 2673/2169 tok/s;   2814 sec
[2020-08-20 06:30:47,235 INFO] Step 18700/20000; acc:  88.88; ppl:  1.24; xent: 0.22; lr: 0.00091; 2649/2150 tok/s;   2829 sec
[2020-08-20 06:30:50,209 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_18720.pt
[2020-08-20 06:31:02,340 INFO] Step 18800/20000; acc:  89.67; ppl:  1.23; xent: 0.21; lr: 0.00091; 2578/2086 tok/s;   2844 sec
[2020-08-20 06:31:17,170 INFO] Step 18900/20000; acc:  89.20; ppl:  1.24; xent: 0.21; lr: 0.00091; 2634/2136 tok/s;   2859 sec
[2020-08-20 06:31:31,929 INFO] Step 19000/20000; acc:  89.47; ppl:  1.23; xent: 0.20; lr: 0.00091; 2660/2167 tok/s;   2873 sec
[2020-08-20 06:31:34,767 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:31:34,810 INFO] number of examples: 9920
[2020-08-20 06:31:36,844 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_19032.pt
[2020-08-20 06:31:47,416 INFO] Step 19100/20000; acc:  89.48; ppl:  1.23; xent: 0.20; lr: 0.00090; 2545/2064 tok/s;   2889 sec
[2020-08-20 06:32:02,254 INFO] Step 19200/20000; acc:  89.50; ppl:  1.23; xent: 0.21; lr: 0.00090; 2646/2149 tok/s;   2904 sec
[2020-08-20 06:32:17,032 INFO] Step 19300/20000; acc:  89.17; ppl:  1.24; xent: 0.21; lr: 0.00090; 2664/2155 tok/s;   2918 sec
[2020-08-20 06:32:23,557 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_19344.pt
[2020-08-20 06:32:32,186 INFO] Step 19400/20000; acc:  89.31; ppl:  1.23; xent: 0.21; lr: 0.00090; 2589/2106 tok/s;   2934 sec
[2020-08-20 06:32:47,022 INFO] Step 19500/20000; acc:  89.62; ppl:  1.22; xent: 0.20; lr: 0.00090; 2669/2171 tok/s;   2948 sec
[2020-08-20 06:33:01,775 INFO] Step 19600/20000; acc:  89.66; ppl:  1.22; xent: 0.20; lr: 0.00089; 2679/2176 tok/s;   2963 sec
[2020-08-20 06:33:10,061 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_19656.pt
[2020-08-20 06:33:16,938 INFO] Step 19700/20000; acc:  89.45; ppl:  1.23; xent: 0.21; lr: 0.00089; 2587/2098 tok/s;   2978 sec
[2020-08-20 06:33:31,795 INFO] Step 19800/20000; acc:  89.56; ppl:  1.23; xent: 0.20; lr: 0.00089; 2621/2122 tok/s;   2993 sec
[2020-08-20 06:33:46,620 INFO] Step 19900/20000; acc:  89.78; ppl:  1.22; xent: 0.20; lr: 0.00089; 2633/2136 tok/s;   3008 sec
[2020-08-20 06:33:56,668 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_19968.pt
[2020-08-20 06:34:01,729 INFO] Step 20000/20000; acc:  89.93; ppl:  1.22; xent: 0.20; lr: 0.00088; 2598/2117 tok/s;   3023 sec
[2020-08-20 06:34:01,730 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 06:34:01,752 INFO] number of examples: 620
[2020-08-20 06:34:02,782 INFO] Validation perplexity: 1.23701
[2020-08-20 06:34:02,786 INFO] Validation accuracy: 91.8457
[2020-08-20 06:34:02,788 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv9/toy_model_step_20000.pt
[2020-08-20 06:34:04,398 INFO]  * src vocab size = 20
[2020-08-20 06:34:04,398 INFO]  * tgt vocab size = 20
[2020-08-20 06:34:04,398 INFO] Building model...
[2020-08-20 06:34:06,547 INFO] NMTModel(
  (encoder): TransformerEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (decoder): TransformerDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(20, 256, padding_idx=1)
        )
        (pe): PositionalEncoding(
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (transformer_layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (context_attn): MultiHeadedAttention(
          (linear_keys): Linear(in_features=256, out_features=256, bias=True)
          (linear_values): Linear(in_features=256, out_features=256, bias=True)
          (linear_query): Linear(in_features=256, out_features=256, bias=True)
          (softmax): Softmax(dim=-1)
          (dropout): Dropout(p=0.1, inplace=False)
          (final_linear): Linear(in_features=256, out_features=256, bias=True)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=256, out_features=2048, bias=True)
          (w_2): Linear(in_features=2048, out_features=256, bias=True)
          (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
          (dropout_1): Dropout(p=0.1, inplace=False)
          (relu): ReLU()
          (dropout_2): Dropout(p=0.1, inplace=False)
        )
        (layer_norm_1): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (layer_norm_2): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
        (drop): Dropout(p=0.1, inplace=False)
      )
    )
    (layer_norm): LayerNorm((256,), eps=1e-06, elementwise_affine=True)
  )
  (generator): Sequential(
    (0): Linear(in_features=256, out_features=20, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2020-08-20 06:34:06,550 INFO] encoder: 5265920
[2020-08-20 06:34:06,550 INFO] decoder: 6320660
[2020-08-20 06:34:06,551 INFO] * number of parameters: 11586580
[2020-08-20 06:34:06,563 INFO] Starting training on GPU: [0]
[2020-08-20 06:34:06,563 INFO] Start training loop and validate every 10000 steps...
[2020-08-20 06:34:06,563 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:34:06,635 INFO] number of examples: 9920
[2020-08-20 06:34:21,860 INFO] Step 100/20000; acc:  51.28; ppl:  3.62; xent: 1.29; lr: 0.00014; 2588/2103 tok/s;     15 sec
[2020-08-20 06:34:36,832 INFO] Step 200/20000; acc:  73.78; ppl:  1.83; xent: 0.60; lr: 0.00028; 2620/2122 tok/s;     30 sec
[2020-08-20 06:34:51,798 INFO] Step 300/20000; acc:  78.34; ppl:  1.62; xent: 0.48; lr: 0.00042; 2630/2130 tok/s;     45 sec
[2020-08-20 06:34:53,596 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_312.pt
[2020-08-20 06:35:07,100 INFO] Step 400/20000; acc:  81.23; ppl:  1.51; xent: 0.41; lr: 0.00056; 2564/2083 tok/s;     61 sec
[2020-08-20 06:35:22,139 INFO] Step 500/20000; acc:  83.59; ppl:  1.45; xent: 0.37; lr: 0.00070; 2597/2115 tok/s;     76 sec
[2020-08-20 06:35:37,052 INFO] Step 600/20000; acc:  84.26; ppl:  1.42; xent: 0.35; lr: 0.00084; 2639/2140 tok/s;     90 sec
[2020-08-20 06:35:40,610 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_624.pt
[2020-08-20 06:35:52,382 INFO] Step 700/20000; acc:  84.99; ppl:  1.39; xent: 0.33; lr: 0.00098; 2554/2071 tok/s;    106 sec
[2020-08-20 06:36:07,258 INFO] Step 800/20000; acc:  85.29; ppl:  1.37; xent: 0.32; lr: 0.00112; 2620/2128 tok/s;    121 sec
[2020-08-20 06:36:22,115 INFO] Step 900/20000; acc:  85.78; ppl:  1.36; xent: 0.31; lr: 0.00126; 2637/2145 tok/s;    136 sec
[2020-08-20 06:36:27,481 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_936.pt
[2020-08-20 06:36:37,332 INFO] Step 1000/20000; acc:  86.31; ppl:  1.35; xent: 0.30; lr: 0.00140; 2611/2119 tok/s;    151 sec
[2020-08-20 06:36:37,481 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:36:37,569 INFO] number of examples: 9920
[2020-08-20 06:36:52,295 INFO] Step 1100/20000; acc:  86.19; ppl:  1.34; xent: 0.29; lr: 0.00154; 2643/2148 tok/s;    166 sec
[2020-08-20 06:37:07,136 INFO] Step 1200/20000; acc:  86.48; ppl:  1.34; xent: 0.29; lr: 0.00168; 2648/2144 tok/s;    181 sec
[2020-08-20 06:37:14,280 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_1248.pt
[2020-08-20 06:37:23,825 INFO] Step 1300/20000; acc:  86.23; ppl:  1.35; xent: 0.30; lr: 0.00182; 2357/1908 tok/s;    197 sec
[2020-08-20 06:37:38,664 INFO] Step 1400/20000; acc:  85.50; ppl:  1.37; xent: 0.31; lr: 0.00196; 2646/2149 tok/s;    212 sec
[2020-08-20 06:37:53,566 INFO] Step 1500/20000; acc:  85.41; ppl:  1.37; xent: 0.32; lr: 0.00210; 2619/2132 tok/s;    227 sec
[2020-08-20 06:38:02,512 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_1560.pt
[2020-08-20 06:38:08,746 INFO] Step 1600/20000; acc:  85.84; ppl:  1.35; xent: 0.30; lr: 0.00224; 2592/2103 tok/s;    242 sec
[2020-08-20 06:38:23,560 INFO] Step 1700/20000; acc:  83.92; ppl:  1.42; xent: 0.35; lr: 0.00238; 2643/2143 tok/s;    257 sec
[2020-08-20 06:38:38,423 INFO] Step 1800/20000; acc:  82.63; ppl:  1.45; xent: 0.37; lr: 0.00252; 2623/2131 tok/s;    272 sec
[2020-08-20 06:38:49,074 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_1872.pt
[2020-08-20 06:38:53,583 INFO] Step 1900/20000; acc:  83.68; ppl:  1.43; xent: 0.36; lr: 0.00266; 2585/2104 tok/s;    287 sec
[2020-08-20 06:39:08,336 INFO] Step 2000/20000; acc:  83.17; ppl:  1.43; xent: 0.36; lr: 0.00279; 2692/2185 tok/s;    302 sec
[2020-08-20 06:39:08,630 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:39:08,670 INFO] number of examples: 9920
[2020-08-20 06:39:23,220 INFO] Step 2100/20000; acc:  81.87; ppl:  1.48; xent: 0.39; lr: 0.00273; 2657/2158 tok/s;    317 sec
[2020-08-20 06:39:35,634 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_2184.pt
[2020-08-20 06:39:44,388 INFO] Step 2200/20000; acc:  83.30; ppl:  1.43; xent: 0.36; lr: 0.00266; 1856/1503 tok/s;    338 sec
[2020-08-20 06:39:59,181 INFO] Step 2300/20000; acc:  84.15; ppl:  1.40; xent: 0.34; lr: 0.00261; 2659/2153 tok/s;    353 sec
[2020-08-20 06:40:13,979 INFO] Step 2400/20000; acc:  82.04; ppl:  1.47; xent: 0.39; lr: 0.00255; 2655/2157 tok/s;    367 sec
[2020-08-20 06:40:28,240 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_2496.pt
[2020-08-20 06:40:29,133 INFO] Step 2500/20000; acc:  79.70; ppl:  1.55; xent: 0.44; lr: 0.00250; 2573/2094 tok/s;    383 sec
[2020-08-20 06:40:43,945 INFO] Step 2600/20000; acc:  81.83; ppl:  1.47; xent: 0.38; lr: 0.00245; 2657/2156 tok/s;    397 sec
[2020-08-20 06:40:58,755 INFO] Step 2700/20000; acc:  82.74; ppl:  1.45; xent: 0.37; lr: 0.00241; 2642/2140 tok/s;    412 sec
[2020-08-20 06:41:13,609 INFO] Step 2800/20000; acc:  82.25; ppl:  1.47; xent: 0.38; lr: 0.00236; 2626/2133 tok/s;    427 sec
[2020-08-20 06:41:14,791 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_2808.pt
[2020-08-20 06:41:28,751 INFO] Step 2900/20000; acc:  82.60; ppl:  1.44; xent: 0.37; lr: 0.00232; 2587/2106 tok/s;    442 sec
[2020-08-20 06:41:43,589 INFO] Step 3000/20000; acc:  82.03; ppl:  1.47; xent: 0.38; lr: 0.00228; 2683/2178 tok/s;    457 sec
[2020-08-20 06:41:44,033 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:41:44,078 INFO] number of examples: 9920
[2020-08-20 06:41:58,532 INFO] Step 3100/20000; acc:  81.29; ppl:  1.49; xent: 0.40; lr: 0.00224; 2645/2148 tok/s;    472 sec
[2020-08-20 06:42:01,515 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_3120.pt
[2020-08-20 06:42:13,707 INFO] Step 3200/20000; acc:  82.12; ppl:  1.47; xent: 0.38; lr: 0.00221; 2586/2094 tok/s;    487 sec
[2020-08-20 06:42:28,520 INFO] Step 3300/20000; acc:  84.00; ppl:  1.41; xent: 0.34; lr: 0.00218; 2657/2151 tok/s;    502 sec
[2020-08-20 06:42:43,317 INFO] Step 3400/20000; acc:  77.96; ppl:  1.63; xent: 0.49; lr: 0.00214; 2656/2159 tok/s;    517 sec
[2020-08-20 06:42:48,083 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_3432.pt
[2020-08-20 06:43:00,712 INFO] Step 3500/20000; acc:  75.93; ppl:  1.71; xent: 0.54; lr: 0.00211; 2242/1825 tok/s;    534 sec
[2020-08-20 06:43:15,539 INFO] Step 3600/20000; acc:  77.96; ppl:  1.61; xent: 0.48; lr: 0.00208; 2652/2152 tok/s;    549 sec
[2020-08-20 06:43:30,348 INFO] Step 3700/20000; acc:  79.50; ppl:  1.56; xent: 0.44; lr: 0.00205; 2643/2140 tok/s;    564 sec
[2020-08-20 06:43:36,864 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_3744.pt
[2020-08-20 06:43:45,478 INFO] Step 3800/20000; acc:  81.58; ppl:  1.48; xent: 0.39; lr: 0.00203; 2574/2091 tok/s;    579 sec
[2020-08-20 06:44:00,295 INFO] Step 3900/20000; acc:  81.88; ppl:  1.47; xent: 0.38; lr: 0.00200; 2649/2157 tok/s;    594 sec
[2020-08-20 06:44:15,125 INFO] Step 4000/20000; acc:  81.27; ppl:  1.50; xent: 0.40; lr: 0.00198; 2685/2180 tok/s;    609 sec
[2020-08-20 06:44:15,719 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:44:15,762 INFO] number of examples: 9920
[2020-08-20 06:44:23,562 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_4056.pt
[2020-08-20 06:44:31,284 INFO] Step 4100/20000; acc:  76.97; ppl:  1.65; xent: 0.50; lr: 0.00195; 2444/1985 tok/s;    625 sec
[2020-08-20 06:44:46,077 INFO] Step 4200/20000; acc:  79.88; ppl:  1.54; xent: 0.43; lr: 0.00193; 2655/2148 tok/s;    640 sec
[2020-08-20 06:45:00,863 INFO] Step 4300/20000; acc:  79.07; ppl:  1.57; xent: 0.45; lr: 0.00191; 2661/2154 tok/s;    654 sec
[2020-08-20 06:45:10,896 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_4368.pt
[2020-08-20 06:45:16,702 INFO] Step 4400/20000; acc:  80.50; ppl:  1.51; xent: 0.41; lr: 0.00188; 2480/2017 tok/s;    670 sec
[2020-08-20 06:45:31,536 INFO] Step 4500/20000; acc:  81.38; ppl:  1.49; xent: 0.40; lr: 0.00186; 2633/2143 tok/s;    685 sec
[2020-08-20 06:45:46,319 INFO] Step 4600/20000; acc:  81.89; ppl:  1.45; xent: 0.37; lr: 0.00184; 2656/2156 tok/s;    700 sec
[2020-08-20 06:45:58,152 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_4680.pt
[2020-08-20 06:46:01,455 INFO] Step 4700/20000; acc:  82.68; ppl:  1.45; xent: 0.37; lr: 0.00182; 2585/2093 tok/s;    715 sec
[2020-08-20 06:46:16,254 INFO] Step 4800/20000; acc:  83.08; ppl:  1.43; xent: 0.36; lr: 0.00180; 2636/2142 tok/s;    730 sec
[2020-08-20 06:46:31,062 INFO] Step 4900/20000; acc:  82.87; ppl:  1.44; xent: 0.36; lr: 0.00179; 2648/2155 tok/s;    744 sec
[2020-08-20 06:46:44,649 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_4992.pt
[2020-08-20 06:46:46,132 INFO] Step 5000/20000; acc:  81.51; ppl:  1.49; xent: 0.40; lr: 0.00177; 2641/2146 tok/s;    760 sec
[2020-08-20 06:46:46,867 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:46:46,909 INFO] number of examples: 9920
[2020-08-20 06:47:00,921 INFO] Step 5100/20000; acc:  72.99; ppl:  1.79; xent: 0.58; lr: 0.00175; 2672/2169 tok/s;    774 sec
[2020-08-20 06:47:15,576 INFO] Step 5200/20000; acc:  76.56; ppl:  1.64; xent: 0.50; lr: 0.00173; 2676/2166 tok/s;    789 sec
[2020-08-20 06:47:30,263 INFO] Step 5300/20000; acc:  78.58; ppl:  1.56; xent: 0.45; lr: 0.00172; 2682/2171 tok/s;    804 sec
[2020-08-20 06:47:30,853 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_5304.pt
[2020-08-20 06:47:45,217 INFO] Step 5400/20000; acc:  80.48; ppl:  1.50; xent: 0.40; lr: 0.00170; 2627/2136 tok/s;    819 sec
[2020-08-20 06:47:59,918 INFO] Step 5500/20000; acc:  81.18; ppl:  1.49; xent: 0.40; lr: 0.00169; 2655/2162 tok/s;    833 sec
[2020-08-20 06:48:14,662 INFO] Step 5600/20000; acc:  80.65; ppl:  1.49; xent: 0.40; lr: 0.00167; 2663/2161 tok/s;    848 sec
[2020-08-20 06:48:17,018 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_5616.pt
[2020-08-20 06:48:29,653 INFO] Step 5700/20000; acc:  80.79; ppl:  1.50; xent: 0.41; lr: 0.00166; 2613/2117 tok/s;    863 sec
[2020-08-20 06:48:44,247 INFO] Step 5800/20000; acc:  82.26; ppl:  1.45; xent: 0.37; lr: 0.00164; 2670/2169 tok/s;    878 sec
[2020-08-20 06:48:58,905 INFO] Step 5900/20000; acc:  82.59; ppl:  1.45; xent: 0.37; lr: 0.00163; 2675/2177 tok/s;    892 sec
[2020-08-20 06:49:03,027 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_5928.pt
[2020-08-20 06:49:13,924 INFO] Step 6000/20000; acc:  78.35; ppl:  1.60; xent: 0.47; lr: 0.00161; 2648/2151 tok/s;    907 sec
[2020-08-20 06:49:14,807 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:49:14,882 INFO] number of examples: 9920
[2020-08-20 06:49:28,736 INFO] Step 6100/20000; acc:  77.21; ppl:  1.63; xent: 0.49; lr: 0.00160; 2672/2170 tok/s;    922 sec
[2020-08-20 06:49:43,444 INFO] Step 6200/20000; acc:  80.21; ppl:  1.51; xent: 0.41; lr: 0.00159; 2667/2159 tok/s;    937 sec
[2020-08-20 06:49:49,330 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_6240.pt
[2020-08-20 06:49:58,477 INFO] Step 6300/20000; acc:  81.47; ppl:  1.47; xent: 0.39; lr: 0.00157; 2621/2121 tok/s;    952 sec
[2020-08-20 06:50:13,093 INFO] Step 6400/20000; acc:  81.53; ppl:  1.48; xent: 0.39; lr: 0.00156; 2685/2185 tok/s;    967 sec
[2020-08-20 06:50:27,736 INFO] Step 6500/20000; acc:  82.44; ppl:  1.45; xent: 0.37; lr: 0.00155; 2665/2169 tok/s;    981 sec
[2020-08-20 06:50:35,331 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_6552.pt
[2020-08-20 06:50:44,049 INFO] Step 6600/20000; acc:  83.90; ppl:  1.40; xent: 0.34; lr: 0.00154; 2410/1956 tok/s;    997 sec
[2020-08-20 06:50:58,753 INFO] Step 6700/20000; acc:  83.55; ppl:  1.42; xent: 0.35; lr: 0.00153; 2659/2154 tok/s;   1012 sec
[2020-08-20 06:51:13,454 INFO] Step 6800/20000; acc:  81.35; ppl:  1.49; xent: 0.40; lr: 0.00152; 2653/2155 tok/s;   1027 sec
[2020-08-20 06:51:22,863 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_6864.pt
[2020-08-20 06:51:28,440 INFO] Step 6900/20000; acc:  81.67; ppl:  1.49; xent: 0.40; lr: 0.00150; 2616/2130 tok/s;   1042 sec
[2020-08-20 06:51:43,075 INFO] Step 7000/20000; acc:  82.82; ppl:  1.44; xent: 0.36; lr: 0.00149; 2716/2206 tok/s;   1057 sec
[2020-08-20 06:51:44,095 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:51:44,175 INFO] number of examples: 9920
[2020-08-20 06:51:57,882 INFO] Step 7100/20000; acc:  81.75; ppl:  1.47; xent: 0.39; lr: 0.00148; 2671/2169 tok/s;   1071 sec
[2020-08-20 06:52:08,991 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_7176.pt
[2020-08-20 06:52:12,836 INFO] Step 7200/20000; acc:  82.25; ppl:  1.47; xent: 0.38; lr: 0.00147; 2623/2123 tok/s;   1086 sec
[2020-08-20 06:52:27,504 INFO] Step 7300/20000; acc:  80.75; ppl:  1.51; xent: 0.41; lr: 0.00146; 2688/2177 tok/s;   1101 sec
[2020-08-20 06:52:42,200 INFO] Step 7400/20000; acc:  83.08; ppl:  1.43; xent: 0.36; lr: 0.00145; 2671/2173 tok/s;   1116 sec
[2020-08-20 06:52:55,066 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_7488.pt
[2020-08-20 06:52:57,183 INFO] Step 7500/20000; acc:  83.02; ppl:  1.43; xent: 0.36; lr: 0.00144; 2603/2119 tok/s;   1131 sec
[2020-08-20 06:53:11,855 INFO] Step 7600/20000; acc:  81.88; ppl:  1.47; xent: 0.39; lr: 0.00143; 2679/2175 tok/s;   1145 sec
[2020-08-20 06:53:26,532 INFO] Step 7700/20000; acc:  81.31; ppl:  1.49; xent: 0.40; lr: 0.00142; 2666/2159 tok/s;   1160 sec
[2020-08-20 06:53:41,173 INFO] Step 7800/20000; acc:  82.09; ppl:  1.46; xent: 0.38; lr: 0.00142; 2662/2162 tok/s;   1175 sec
[2020-08-20 06:53:41,174 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_7800.pt
[2020-08-20 06:53:56,134 INFO] Step 7900/20000; acc:  82.66; ppl:  1.44; xent: 0.36; lr: 0.00141; 2620/2133 tok/s;   1190 sec
[2020-08-20 06:54:10,812 INFO] Step 8000/20000; acc:  83.35; ppl:  1.42; xent: 0.35; lr: 0.00140; 2707/2197 tok/s;   1204 sec
[2020-08-20 06:54:11,996 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:54:12,077 INFO] number of examples: 9920
[2020-08-20 06:54:25,622 INFO] Step 8100/20000; acc:  84.18; ppl:  1.39; xent: 0.33; lr: 0.00139; 2677/2176 tok/s;   1219 sec
[2020-08-20 06:54:27,391 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_8112.pt
[2020-08-20 06:54:40,721 INFO] Step 8200/20000; acc:  84.99; ppl:  1.36; xent: 0.31; lr: 0.00138; 2595/2100 tok/s;   1234 sec
[2020-08-20 06:54:55,386 INFO] Step 8300/20000; acc:  81.65; ppl:  1.48; xent: 0.39; lr: 0.00137; 2690/2177 tok/s;   1249 sec
[2020-08-20 06:55:10,096 INFO] Step 8400/20000; acc:  83.13; ppl:  1.43; xent: 0.36; lr: 0.00136; 2666/2169 tok/s;   1264 sec
[2020-08-20 06:55:13,623 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_8424.pt
[2020-08-20 06:55:25,872 INFO] Step 8500/20000; acc:  84.25; ppl:  1.40; xent: 0.34; lr: 0.00136; 2473/2011 tok/s;   1279 sec
[2020-08-20 06:55:40,551 INFO] Step 8600/20000; acc:  81.63; ppl:  1.47; xent: 0.39; lr: 0.00135; 2680/2176 tok/s;   1294 sec
[2020-08-20 06:55:55,232 INFO] Step 8700/20000; acc:  82.49; ppl:  1.44; xent: 0.37; lr: 0.00134; 2662/2155 tok/s;   1309 sec
[2020-08-20 06:56:00,538 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_8736.pt
[2020-08-20 06:56:10,336 INFO] Step 8800/20000; acc:  83.66; ppl:  1.40; xent: 0.34; lr: 0.00133; 2582/2098 tok/s;   1324 sec
[2020-08-20 06:56:25,046 INFO] Step 8900/20000; acc:  84.46; ppl:  1.38; xent: 0.32; lr: 0.00132; 2666/2169 tok/s;   1338 sec
[2020-08-20 06:56:39,723 INFO] Step 9000/20000; acc:  83.89; ppl:  1.39; xent: 0.33; lr: 0.00132; 2708/2197 tok/s;   1353 sec
[2020-08-20 06:56:41,047 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:56:41,127 INFO] number of examples: 9920
[2020-08-20 06:56:46,913 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_9048.pt
[2020-08-20 06:56:54,816 INFO] Step 9100/20000; acc:  84.17; ppl:  1.38; xent: 0.33; lr: 0.00131; 2625/2134 tok/s;   1368 sec
[2020-08-20 06:57:09,458 INFO] Step 9200/20000; acc:  84.95; ppl:  1.36; xent: 0.31; lr: 0.00130; 2679/2169 tok/s;   1383 sec
[2020-08-20 06:57:24,131 INFO] Step 9300/20000; acc:  85.27; ppl:  1.36; xent: 0.30; lr: 0.00130; 2684/2172 tok/s;   1398 sec
[2020-08-20 06:57:32,935 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_9360.pt
[2020-08-20 06:57:39,148 INFO] Step 9400/20000; acc:  85.29; ppl:  1.36; xent: 0.30; lr: 0.00129; 2614/2125 tok/s;   1413 sec
[2020-08-20 06:57:53,827 INFO] Step 9500/20000; acc:  85.41; ppl:  1.35; xent: 0.30; lr: 0.00128; 2661/2165 tok/s;   1427 sec
[2020-08-20 06:58:08,531 INFO] Step 9600/20000; acc:  85.62; ppl:  1.34; xent: 0.29; lr: 0.00128; 2674/2170 tok/s;   1442 sec
[2020-08-20 06:58:19,104 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_9672.pt
[2020-08-20 06:58:23,588 INFO] Step 9700/20000; acc:  85.29; ppl:  1.35; xent: 0.30; lr: 0.00127; 2595/2101 tok/s;   1457 sec
[2020-08-20 06:58:38,296 INFO] Step 9800/20000; acc:  85.63; ppl:  1.33; xent: 0.29; lr: 0.00126; 2650/2154 tok/s;   1472 sec
[2020-08-20 06:58:52,979 INFO] Step 9900/20000; acc:  84.70; ppl:  1.37; xent: 0.32; lr: 0.00126; 2673/2175 tok/s;   1486 sec
[2020-08-20 06:59:05,283 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_9984.pt
[2020-08-20 06:59:07,932 INFO] Step 10000/20000; acc:  80.97; ppl:  1.50; xent: 0.40; lr: 0.00125; 2655/2155 tok/s;   1501 sec
[2020-08-20 06:59:07,933 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 06:59:07,936 INFO] number of examples: 620
[2020-08-20 06:59:08,955 INFO] Validation perplexity: 1.58371
[2020-08-20 06:59:08,955 INFO] Validation accuracy: 82.2844
[2020-08-20 06:59:10,420 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 06:59:10,501 INFO] number of examples: 9920
[2020-08-20 06:59:23,761 INFO] Step 10100/20000; acc:  81.43; ppl:  1.49; xent: 0.40; lr: 0.00124; 2506/2038 tok/s;   1517 sec
[2020-08-20 06:59:38,448 INFO] Step 10200/20000; acc:  83.97; ppl:  1.39; xent: 0.33; lr: 0.00124; 2673/2162 tok/s;   1532 sec
[2020-08-20 06:59:52,521 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_10296.pt
[2020-08-20 06:59:53,428 INFO] Step 10300/20000; acc:  84.52; ppl:  1.38; xent: 0.32; lr: 0.00123; 2625/2127 tok/s;   1547 sec
[2020-08-20 07:00:08,118 INFO] Step 10400/20000; acc:  85.45; ppl:  1.35; xent: 0.30; lr: 0.00123; 2672/2172 tok/s;   1562 sec
[2020-08-20 07:00:22,835 INFO] Step 10500/20000; acc:  85.61; ppl:  1.35; xent: 0.30; lr: 0.00122; 2659/2163 tok/s;   1576 sec
[2020-08-20 07:00:37,537 INFO] Step 10600/20000; acc:  85.46; ppl:  1.35; xent: 0.30; lr: 0.00121; 2671/2168 tok/s;   1591 sec
[2020-08-20 07:00:38,719 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_10608.pt
[2020-08-20 07:00:52,526 INFO] Step 10700/20000; acc:  85.36; ppl:  1.35; xent: 0.30; lr: 0.00121; 2606/2112 tok/s;   1606 sec
[2020-08-20 07:01:07,243 INFO] Step 10800/20000; acc:  83.57; ppl:  1.41; xent: 0.34; lr: 0.00120; 2649/2152 tok/s;   1621 sec
[2020-08-20 07:01:21,998 INFO] Step 10900/20000; acc:  83.86; ppl:  1.40; xent: 0.34; lr: 0.00120; 2661/2164 tok/s;   1635 sec
[2020-08-20 07:01:24,927 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_10920.pt
[2020-08-20 07:01:37,013 INFO] Step 11000/20000; acc:  84.20; ppl:  1.39; xent: 0.33; lr: 0.00119; 2640/2143 tok/s;   1650 sec
[2020-08-20 07:01:38,636 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 07:01:38,719 INFO] number of examples: 9920
[2020-08-20 07:01:51,877 INFO] Step 11100/20000; acc:  84.95; ppl:  1.36; xent: 0.31; lr: 0.00119; 2667/2170 tok/s;   1665 sec
[2020-08-20 07:02:06,601 INFO] Step 11200/20000; acc:  84.68; ppl:  1.37; xent: 0.31; lr: 0.00118; 2671/2160 tok/s;   1680 sec
[2020-08-20 07:02:11,303 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_11232.pt
[2020-08-20 07:02:21,716 INFO] Step 11300/20000; acc:  83.47; ppl:  1.42; xent: 0.35; lr: 0.00118; 2600/2108 tok/s;   1695 sec
[2020-08-20 07:02:36,416 INFO] Step 11400/20000; acc:  84.96; ppl:  1.36; xent: 0.31; lr: 0.00117; 2670/2170 tok/s;   1710 sec
[2020-08-20 07:02:51,115 INFO] Step 11500/20000; acc:  85.31; ppl:  1.36; xent: 0.30; lr: 0.00117; 2660/2164 tok/s;   1725 sec
[2020-08-20 07:02:57,574 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_11544.pt
[2020-08-20 07:03:06,087 INFO] Step 11600/20000; acc:  85.68; ppl:  1.34; xent: 0.29; lr: 0.00116; 2628/2133 tok/s;   1740 sec
[2020-08-20 07:03:20,803 INFO] Step 11700/20000; acc:  85.45; ppl:  1.35; xent: 0.30; lr: 0.00116; 2651/2148 tok/s;   1754 sec
[2020-08-20 07:03:35,535 INFO] Step 11800/20000; acc:  84.98; ppl:  1.36; xent: 0.30; lr: 0.00115; 2646/2150 tok/s;   1769 sec
[2020-08-20 07:03:43,782 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_11856.pt
[2020-08-20 07:03:50,574 INFO] Step 11900/20000; acc:  85.70; ppl:  1.34; xent: 0.29; lr: 0.00115; 2611/2123 tok/s;   1784 sec
[2020-08-20 07:04:05,229 INFO] Step 12000/20000; acc:  84.98; ppl:  1.36; xent: 0.31; lr: 0.00114; 2706/2197 tok/s;   1799 sec
[2020-08-20 07:04:06,993 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 07:04:07,077 INFO] number of examples: 9920
[2020-08-20 07:04:20,090 INFO] Step 12100/20000; acc:  85.71; ppl:  1.33; xent: 0.29; lr: 0.00114; 2668/2169 tok/s;   1814 sec
[2020-08-20 07:04:30,104 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_12168.pt
[2020-08-20 07:04:35,267 INFO] Step 12200/20000; acc:  85.77; ppl:  1.33; xent: 0.29; lr: 0.00113; 2596/2099 tok/s;   1829 sec
[2020-08-20 07:04:49,908 INFO] Step 12300/20000; acc:  85.69; ppl:  1.33; xent: 0.29; lr: 0.00113; 2681/2174 tok/s;   1843 sec
[2020-08-20 07:05:04,569 INFO] Step 12400/20000; acc:  85.78; ppl:  1.34; xent: 0.29; lr: 0.00112; 2677/2175 tok/s;   1858 sec
[2020-08-20 07:05:16,333 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_12480.pt
[2020-08-20 07:05:19,583 INFO] Step 12500/20000; acc:  85.25; ppl:  1.35; xent: 0.30; lr: 0.00112; 2602/2117 tok/s;   1873 sec
[2020-08-20 07:05:34,208 INFO] Step 12600/20000; acc:  85.54; ppl:  1.34; xent: 0.29; lr: 0.00111; 2697/2189 tok/s;   1888 sec
[2020-08-20 07:05:48,921 INFO] Step 12700/20000; acc:  85.95; ppl:  1.33; xent: 0.28; lr: 0.00111; 2646/2142 tok/s;   1902 sec
[2020-08-20 07:06:02,557 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_12792.pt
[2020-08-20 07:06:03,981 INFO] Step 12800/20000; acc:  85.08; ppl:  1.36; xent: 0.30; lr: 0.00110; 2590/2105 tok/s;   1917 sec
[2020-08-20 07:06:18,844 INFO] Step 12900/20000; acc:  85.13; ppl:  1.35; xent: 0.30; lr: 0.00110; 2641/2149 tok/s;   1932 sec
[2020-08-20 07:06:33,679 INFO] Step 13000/20000; acc:  85.50; ppl:  1.34; xent: 0.29; lr: 0.00110; 2670/2166 tok/s;   1947 sec
[2020-08-20 07:06:35,617 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 07:06:35,707 INFO] number of examples: 9920
[2020-08-20 07:06:48,667 INFO] Step 13100/20000; acc:  85.16; ppl:  1.36; xent: 0.31; lr: 0.00109; 2645/2153 tok/s;   1962 sec
[2020-08-20 07:06:49,274 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_13104.pt
[2020-08-20 07:07:03,849 INFO] Step 13200/20000; acc:  84.96; ppl:  1.36; xent: 0.31; lr: 0.00109; 2598/2100 tok/s;   1977 sec
[2020-08-20 07:07:18,680 INFO] Step 13300/20000; acc:  83.21; ppl:  1.42; xent: 0.35; lr: 0.00108; 2649/2147 tok/s;   1992 sec
[2020-08-20 07:07:33,504 INFO] Step 13400/20000; acc:  84.57; ppl:  1.37; xent: 0.32; lr: 0.00108; 2644/2150 tok/s;   2007 sec
[2020-08-20 07:07:35,878 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_13416.pt
[2020-08-20 07:07:48,701 INFO] Step 13500/20000; acc:  85.83; ppl:  1.34; xent: 0.29; lr: 0.00108; 2568/2088 tok/s;   2022 sec
[2020-08-20 07:08:03,555 INFO] Step 13600/20000; acc:  85.35; ppl:  1.34; xent: 0.29; lr: 0.00107; 2657/2158 tok/s;   2037 sec
[2020-08-20 07:08:18,416 INFO] Step 13700/20000; acc:  84.80; ppl:  1.36; xent: 0.31; lr: 0.00107; 2619/2121 tok/s;   2052 sec
[2020-08-20 07:08:22,565 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_13728.pt
[2020-08-20 07:08:33,726 INFO] Step 13800/20000; acc:  85.81; ppl:  1.33; xent: 0.28; lr: 0.00106; 2550/2072 tok/s;   2067 sec
[2020-08-20 07:08:48,550 INFO] Step 13900/20000; acc:  85.93; ppl:  1.33; xent: 0.28; lr: 0.00106; 2648/2155 tok/s;   2082 sec
[2020-08-20 07:09:03,358 INFO] Step 14000/20000; acc:  86.02; ppl:  1.32; xent: 0.28; lr: 0.00106; 2677/2174 tok/s;   2097 sec
[2020-08-20 07:09:05,451 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 07:09:05,546 INFO] number of examples: 9920
[2020-08-20 07:09:09,462 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_14040.pt
[2020-08-20 07:09:18,658 INFO] Step 14100/20000; acc:  86.17; ppl:  1.32; xent: 0.28; lr: 0.00105; 2590/2106 tok/s;   2112 sec
[2020-08-20 07:09:33,415 INFO] Step 14200/20000; acc:  85.80; ppl:  1.33; xent: 0.28; lr: 0.00105; 2670/2159 tok/s;   2127 sec
[2020-08-20 07:09:48,171 INFO] Step 14300/20000; acc:  85.43; ppl:  1.35; xent: 0.30; lr: 0.00105; 2666/2160 tok/s;   2142 sec
[2020-08-20 07:09:55,881 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_14352.pt
[2020-08-20 07:10:03,312 INFO] Step 14400/20000; acc:  85.58; ppl:  1.35; xent: 0.30; lr: 0.00104; 2586/2103 tok/s;   2157 sec
[2020-08-20 07:10:18,179 INFO] Step 14500/20000; acc:  85.50; ppl:  1.35; xent: 0.30; lr: 0.00104; 2629/2137 tok/s;   2172 sec
[2020-08-20 07:10:33,053 INFO] Step 14600/20000; acc:  85.40; ppl:  1.34; xent: 0.29; lr: 0.00103; 2650/2153 tok/s;   2186 sec
[2020-08-20 07:10:42,553 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_14664.pt
[2020-08-20 07:10:48,270 INFO] Step 14700/20000; acc:  85.08; ppl:  1.35; xent: 0.30; lr: 0.00103; 2558/2070 tok/s;   2202 sec
[2020-08-20 07:11:03,063 INFO] Step 14800/20000; acc:  85.79; ppl:  1.33; xent: 0.29; lr: 0.00103; 2642/2146 tok/s;   2217 sec
[2020-08-20 07:11:17,909 INFO] Step 14900/20000; acc:  85.24; ppl:  1.35; xent: 0.30; lr: 0.00102; 2641/2149 tok/s;   2231 sec
[2020-08-20 07:11:29,161 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_14976.pt
[2020-08-20 07:11:33,037 INFO] Step 15000/20000; acc:  84.49; ppl:  1.37; xent: 0.32; lr: 0.00102; 2619/2126 tok/s;   2246 sec
[2020-08-20 07:11:35,262 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 07:11:35,352 INFO] number of examples: 9920
[2020-08-20 07:11:48,001 INFO] Step 15100/20000; acc:  85.58; ppl:  1.34; xent: 0.29; lr: 0.00102; 2645/2152 tok/s;   2261 sec
[2020-08-20 07:12:02,759 INFO] Step 15200/20000; acc:  85.79; ppl:  1.33; xent: 0.28; lr: 0.00101; 2673/2161 tok/s;   2276 sec
[2020-08-20 07:12:15,802 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_15288.pt
[2020-08-20 07:12:17,939 INFO] Step 15300/20000; acc:  86.16; ppl:  1.33; xent: 0.28; lr: 0.00101; 2594/2101 tok/s;   2291 sec
[2020-08-20 07:12:32,860 INFO] Step 15400/20000; acc:  85.98; ppl:  1.33; xent: 0.28; lr: 0.00101; 2621/2132 tok/s;   2306 sec
[2020-08-20 07:12:47,799 INFO] Step 15500/20000; acc:  84.88; ppl:  1.37; xent: 0.31; lr: 0.00100; 2619/2130 tok/s;   2321 sec
[2020-08-20 07:13:02,637 INFO] Step 15600/20000; acc:  85.28; ppl:  1.35; xent: 0.30; lr: 0.00100; 2650/2152 tok/s;   2336 sec
[2020-08-20 07:13:02,639 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_15600.pt
[2020-08-20 07:13:18,723 INFO] Step 15700/20000; acc:  85.36; ppl:  1.34; xent: 0.30; lr: 0.00100; 2423/1961 tok/s;   2352 sec
[2020-08-20 07:13:33,570 INFO] Step 15800/20000; acc:  85.58; ppl:  1.34; xent: 0.29; lr: 0.00099; 2633/2138 tok/s;   2367 sec
[2020-08-20 07:13:48,379 INFO] Step 15900/20000; acc:  85.21; ppl:  1.35; xent: 0.30; lr: 0.00099; 2650/2157 tok/s;   2382 sec
[2020-08-20 07:13:50,159 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_15912.pt
[2020-08-20 07:14:04,261 INFO] Step 16000/20000; acc:  83.95; ppl:  1.40; xent: 0.33; lr: 0.00099; 2493/2025 tok/s;   2398 sec
[2020-08-20 07:14:06,637 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 07:14:06,730 INFO] number of examples: 9920
[2020-08-20 07:14:19,264 INFO] Step 16100/20000; acc:  85.18; ppl:  1.35; xent: 0.30; lr: 0.00099; 2638/2145 tok/s;   2413 sec
[2020-08-20 07:14:34,124 INFO] Step 16200/20000; acc:  85.74; ppl:  1.33; xent: 0.28; lr: 0.00098; 2652/2144 tok/s;   2428 sec
[2020-08-20 07:14:37,685 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_16224.pt
[2020-08-20 07:14:49,225 INFO] Step 16300/20000; acc:  85.67; ppl:  1.34; xent: 0.29; lr: 0.00098; 2612/2117 tok/s;   2443 sec
[2020-08-20 07:15:04,007 INFO] Step 16400/20000; acc:  85.48; ppl:  1.35; xent: 0.30; lr: 0.00098; 2646/2151 tok/s;   2457 sec
[2020-08-20 07:15:18,825 INFO] Step 16500/20000; acc:  85.79; ppl:  1.34; xent: 0.29; lr: 0.00097; 2643/2151 tok/s;   2472 sec
[2020-08-20 07:15:24,175 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_16536.pt
[2020-08-20 07:15:34,002 INFO] Step 16600/20000; acc:  85.82; ppl:  1.34; xent: 0.29; lr: 0.00097; 2587/2101 tok/s;   2487 sec
[2020-08-20 07:15:48,804 INFO] Step 16700/20000; acc:  83.97; ppl:  1.40; xent: 0.34; lr: 0.00097; 2631/2129 tok/s;   2502 sec
[2020-08-20 07:16:03,674 INFO] Step 16800/20000; acc:  85.47; ppl:  1.35; xent: 0.30; lr: 0.00096; 2631/2136 tok/s;   2517 sec
[2020-08-20 07:16:10,848 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_16848.pt
[2020-08-20 07:16:18,786 INFO] Step 16900/20000; acc:  85.43; ppl:  1.35; xent: 0.30; lr: 0.00096; 2596/2114 tok/s;   2532 sec
[2020-08-20 07:16:33,523 INFO] Step 17000/20000; acc:  85.64; ppl:  1.34; xent: 0.29; lr: 0.00096; 2684/2181 tok/s;   2547 sec
[2020-08-20 07:16:35,994 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 07:16:36,999 INFO] number of examples: 9920
[2020-08-20 07:16:49,311 INFO] Step 17100/20000; acc:  85.80; ppl:  1.34; xent: 0.29; lr: 0.00096; 2511/2042 tok/s;   2563 sec
[2020-08-20 07:16:58,135 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_17160.pt
[2020-08-20 07:17:04,393 INFO] Step 17200/20000; acc:  86.17; ppl:  1.32; xent: 0.28; lr: 0.00095; 2614/2112 tok/s;   2578 sec
[2020-08-20 07:17:19,200 INFO] Step 17300/20000; acc:  86.39; ppl:  1.31; xent: 0.27; lr: 0.00095; 2659/2154 tok/s;   2593 sec
[2020-08-20 07:17:33,962 INFO] Step 17400/20000; acc:  86.09; ppl:  1.33; xent: 0.28; lr: 0.00095; 2653/2156 tok/s;   2607 sec
[2020-08-20 07:17:44,593 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_17472.pt
[2020-08-20 07:17:49,038 INFO] Step 17500/20000; acc:  86.64; ppl:  1.31; xent: 0.27; lr: 0.00094; 2594/2112 tok/s;   2622 sec
[2020-08-20 07:18:03,804 INFO] Step 17600/20000; acc:  86.19; ppl:  1.32; xent: 0.28; lr: 0.00094; 2660/2159 tok/s;   2637 sec
[2020-08-20 07:18:18,577 INFO] Step 17700/20000; acc:  85.70; ppl:  1.34; xent: 0.29; lr: 0.00094; 2639/2135 tok/s;   2652 sec
[2020-08-20 07:18:31,004 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_17784.pt
[2020-08-20 07:18:33,700 INFO] Step 17800/20000; acc:  85.79; ppl:  1.33; xent: 0.29; lr: 0.00094; 2585/2098 tok/s;   2667 sec
[2020-08-20 07:18:48,527 INFO] Step 17900/20000; acc:  86.19; ppl:  1.32; xent: 0.28; lr: 0.00093; 2648/2157 tok/s;   2682 sec
[2020-08-20 07:19:03,375 INFO] Step 18000/20000; acc:  86.27; ppl:  1.32; xent: 0.28; lr: 0.00093; 2662/2163 tok/s;   2697 sec
[2020-08-20 07:19:06,027 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 07:19:06,123 INFO] number of examples: 9920
[2020-08-20 07:19:17,770 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_18096.pt
[2020-08-20 07:19:18,664 INFO] Step 18100/20000; acc:  86.48; ppl:  1.31; xent: 0.27; lr: 0.00093; 2597/2111 tok/s;   2712 sec
[2020-08-20 07:19:33,476 INFO] Step 18200/20000; acc:  86.32; ppl:  1.30; xent: 0.26; lr: 0.00093; 2657/2148 tok/s;   2727 sec
[2020-08-20 07:19:48,284 INFO] Step 18300/20000; acc:  86.85; ppl:  1.30; xent: 0.26; lr: 0.00092; 2661/2158 tok/s;   2742 sec
[2020-08-20 07:20:03,114 INFO] Step 18400/20000; acc:  86.10; ppl:  1.32; xent: 0.28; lr: 0.00092; 2643/2147 tok/s;   2757 sec
[2020-08-20 07:20:04,306 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_18408.pt
[2020-08-20 07:20:18,182 INFO] Step 18500/20000; acc:  86.66; ppl:  1.31; xent: 0.27; lr: 0.00092; 2593/2110 tok/s;   2772 sec
[2020-08-20 07:20:33,051 INFO] Step 18600/20000; acc:  86.26; ppl:  1.31; xent: 0.27; lr: 0.00092; 2642/2145 tok/s;   2786 sec
[2020-08-20 07:20:47,892 INFO] Step 18700/20000; acc:  86.69; ppl:  1.31; xent: 0.27; lr: 0.00091; 2628/2126 tok/s;   2801 sec
[2020-08-20 07:20:50,853 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_18720.pt
[2020-08-20 07:21:03,009 INFO] Step 18800/20000; acc:  86.85; ppl:  1.29; xent: 0.26; lr: 0.00091; 2582/2095 tok/s;   2816 sec
[2020-08-20 07:21:17,834 INFO] Step 18900/20000; acc:  86.56; ppl:  1.30; xent: 0.26; lr: 0.00091; 2649/2158 tok/s;   2831 sec
[2020-08-20 07:21:32,686 INFO] Step 19000/20000; acc:  86.75; ppl:  1.30; xent: 0.26; lr: 0.00091; 2663/2165 tok/s;   2846 sec
[2020-08-20 07:21:35,494 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.train.0.pt
[2020-08-20 07:21:35,538 INFO] number of examples: 9920
[2020-08-20 07:21:37,589 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_19032.pt
[2020-08-20 07:21:47,974 INFO] Step 19100/20000; acc:  86.75; ppl:  1.30; xent: 0.26; lr: 0.00090; 2595/2108 tok/s;   2861 sec
[2020-08-20 07:22:02,808 INFO] Step 19200/20000; acc:  86.54; ppl:  1.30; xent: 0.26; lr: 0.00090; 2654/2147 tok/s;   2876 sec
[2020-08-20 07:22:17,638 INFO] Step 19300/20000; acc:  87.23; ppl:  1.29; xent: 0.26; lr: 0.00090; 2656/2153 tok/s;   2891 sec
[2020-08-20 07:22:24,157 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_19344.pt
[2020-08-20 07:22:32,819 INFO] Step 19400/20000; acc:  86.94; ppl:  1.30; xent: 0.26; lr: 0.00090; 2583/2098 tok/s;   2906 sec
[2020-08-20 07:22:47,654 INFO] Step 19500/20000; acc:  86.43; ppl:  1.32; xent: 0.28; lr: 0.00090; 2632/2141 tok/s;   2921 sec
[2020-08-20 07:23:02,583 INFO] Step 19600/20000; acc:  86.68; ppl:  1.31; xent: 0.27; lr: 0.00089; 2635/2141 tok/s;   2936 sec
[2020-08-20 07:23:10,903 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_19656.pt
[2020-08-20 07:23:17,746 INFO] Step 19700/20000; acc:  86.48; ppl:  1.31; xent: 0.27; lr: 0.00089; 2570/2078 tok/s;   2951 sec
[2020-08-20 07:23:32,642 INFO] Step 19800/20000; acc:  86.84; ppl:  1.30; xent: 0.26; lr: 0.00089; 2622/2130 tok/s;   2966 sec
[2020-08-20 07:23:47,526 INFO] Step 19900/20000; acc:  86.89; ppl:  1.30; xent: 0.26; lr: 0.00089; 2638/2149 tok/s;   2981 sec
[2020-08-20 07:23:57,672 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_19968.pt
[2020-08-20 07:24:03,594 INFO] Step 20000/20000; acc:  86.50; ppl:  1.31; xent: 0.27; lr: 0.00088; 2463/2002 tok/s;   2997 sec
[2020-08-20 07:24:03,595 INFO] Loading dataset from /home/dpk25/rds/hpc-work/toy_model/data_sear_small/.valid.0.pt
[2020-08-20 07:24:03,666 INFO] number of examples: 620
[2020-08-20 07:24:04,715 INFO] Validation perplexity: 1.32944
[2020-08-20 07:24:04,715 INFO] Validation accuracy: 88.5426
[2020-08-20 07:24:04,717 INFO] Saving checkpoint /home/dpk25/rds/hpc-work/toy_model/sear_models_small_conv10/toy_model_step_20000.pt
